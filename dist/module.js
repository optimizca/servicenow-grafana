/*! For license information please see module.js.LICENSE.txt */
define(["@grafana/data","@grafana/runtime","@grafana/ui","lodash","react","rxjs"],(e,t,r,n,a,o)=>(()=>{var i=[e=>{"use strict";e.exports=a},e=>{"use strict";e.exports=r},e=>{"use strict";e.exports=n},t=>{"use strict";t.exports=e},e=>{"use strict";e.exports=t},e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},(e,t,r)=>{var n=r(11),a=r(29),o=r(30),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?a(e):o(e)}},(e,t,r)=>{var n=r(12),a="object"==typeof self&&self&&self.Object===Object&&self,o=n||a||Function("return this")();e.exports=o},e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},e=>{e.exports=function(e){return e}},(e,t,r)=>{var n=r(6),a=r(5);e.exports=function(e){if(!a(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},(e,t,r)=>{var n=r(7).Symbol;e.exports=n},(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},(e,t,r)=>{var n=r(10),a=r(15);e.exports=function(e){return null!=e&&a(e.length)&&!n(e)}},e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},(e,t,r)=>{e=r.nmd(e);var n=r(7),a=r(43),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,u=i&&i.exports===o?n.Buffer:void 0,l=(u?u.isBuffer:void 0)||a;e.exports=l},(e,t,r)=>{e=r.nmd(e);var n=r(12),a=t&&!t.nodeType&&t,o=a&&e&&!e.nodeType&&e,i=o&&o.exports===a&&n.process,u=function(){try{var e=o&&o.require&&o.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=u},(e,t,r)=>{var n=r(20),a=r(13),o=r(36),i=r(37),u=Object.prototype,l=u.hasOwnProperty,c=n((function(e,t){e=Object(e);var r=-1,n=t.length,c=n>2?t[2]:void 0;for(c&&o(t[0],t[1],c)&&(n=1);++r<n;)for(var s=t[r],f=i(s),p=-1,h=f.length;++p<h;){var d=f[p],y=e[d];(void 0===y||a(y,u[d])&&!l.call(e,d))&&(e[d]=s[d])}return e}));e.exports=c},(e,t,r)=>{var n=r(9),a=r(21),o=r(23);e.exports=function(e,t){return o(a(e,t,n),e+"")}},(e,t,r)=>{var n=r(22),a=Math.max;e.exports=function(e,t,r){return t=a(void 0===t?e.length-1:t,0),function(){for(var o=arguments,i=-1,u=a(o.length-t,0),l=Array(u);++i<u;)l[i]=o[t+i];i=-1;for(var c=Array(t+1);++i<t;)c[i]=o[i];return c[t]=r(l),n(e,this,c)}}},e=>{e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},(e,t,r)=>{var n=r(24),a=r(35)(n);e.exports=a},(e,t,r)=>{var n=r(25),a=r(26),o=r(9),i=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:o;e.exports=i},e=>{e.exports=function(e){return function(){return e}}},(e,t,r)=>{var n=r(27),a=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=a},(e,t,r)=>{var n=r(28),a=r(34);e.exports=function(e,t){var r=a(e,t);return n(r)?r:void 0}},(e,t,r)=>{var n=r(10),a=r(31),o=r(5),i=r(33),u=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,s=l.toString,f=c.hasOwnProperty,p=RegExp("^"+s.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||a(e))&&(n(e)?p:u).test(i(e))}},(e,t,r)=>{var n=r(11),a=Object.prototype,o=a.hasOwnProperty,i=a.toString,u=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,u),r=e[u];try{e[u]=void 0;var n=!0}catch(e){}var a=i.call(e);return n&&(t?e[u]=r:delete e[u]),a}},e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},(e,t,r)=>{var n,a=r(32),o=(n=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!o&&o in e}},(e,t,r)=>{var n=r(7)["__core-js_shared__"];e.exports=n},e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},e=>{var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var a=t(),o=16-(a-n);if(n=a,o>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},(e,t,r)=>{var n=r(13),a=r(14),o=r(16),i=r(5);e.exports=function(e,t,r){if(!i(r))return!1;var u=typeof t;return!!("number"==u?a(r)&&o(t,r.length):"string"==u&&t in r)&&n(r[t],e)}},(e,t,r)=>{var n=r(38),a=r(47),o=r(14);e.exports=function(e){return o(e)?n(e,!0):a(e)}},(e,t,r)=>{var n=r(39),a=r(40),o=r(42),i=r(17),u=r(16),l=r(44),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=o(e),s=!r&&a(e),f=!r&&!s&&i(e),p=!r&&!s&&!f&&l(e),h=r||s||f||p,d=h?n(e.length,String):[],y=d.length;for(var v in e)!t&&!c.call(e,v)||h&&("length"==v||f&&("offset"==v||"parent"==v)||p&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||u(v,y))||d.push(v);return d}},e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},(e,t,r)=>{var n=r(41),a=r(8),o=Object.prototype,i=o.hasOwnProperty,u=o.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(e){return a(e)&&i.call(e,"callee")&&!u.call(e,"callee")};e.exports=l},(e,t,r)=>{var n=r(6),a=r(8);e.exports=function(e){return a(e)&&"[object Arguments]"==n(e)}},e=>{var t=Array.isArray;e.exports=t},e=>{e.exports=function(){return!1}},(e,t,r)=>{var n=r(45),a=r(46),o=r(18),i=o&&o.isTypedArray,u=i?a(i):n;e.exports=u},(e,t,r)=>{var n=r(6),a=r(15),o=r(8),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&a(e.length)&&!!i[n(e)]}},e=>{e.exports=function(e){return function(t){return e(t)}}},(e,t,r)=>{var n=r(5),a=r(48),o=r(49),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=a(e),r=[];for(var u in e)("constructor"!=u||!t&&i.call(e,u))&&r.push(u);return r}},e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},e=>{"use strict";function t(){var e=Object.create(null),t=0,r=0,n=0,a=!1;function o(t){n--,delete e[t]}this.put=function(t,r,a,i){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==i&&"function"!=typeof i)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):n++;var l={value:r,expire:a+Date.now()};return isNaN(l.expire)||(l.timeout=setTimeout(function(){o(t),i&&i(t,r)}.bind(this),a)),e[t]=l,r},this.del=function(t){var r=!0,n=e[t];return n?(clearTimeout(n.timeout),!isNaN(n.expire)&&n.expire<Date.now()&&(r=!1)):r=!1,r&&o(t),r},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);n=0,e=Object.create(null),a&&(t=0,r=0)},this.get=function(o){var i=e[o];if(void 0!==i){if(isNaN(i.expire)||i.expire>=Date.now())return a&&t++,i.value;a&&r++,n--,delete e[o]}else a&&r++;return null},this.size=function(){return n},this.memsize=function(){var t,r=0;for(t in e)r++;return r},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return r},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var r in e){var n=e[r];t[r]={value:n.value,expire:n.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,r){var n=JSON.parse(t),a=Date.now(),o=r&&r.skipDuplicates;for(var i in n)if(n.hasOwnProperty(i)){if(o)if(e[i])continue;var u=n[i],l=u.expire-a;if(l<=0){this.del(i);continue}l=l>0?l:void 0,this.put(i,u.value,l)}return this.size()}}e.exports=new t,e.exports.Cache=t},,e=>{"use strict";e.exports=o}],u={};function l(e){var t=u[e];if(void 0!==t)return t.exports;var r=u[e]={id:e,loaded:!1,exports:{}};return i[e](r,r.exports,l),r.loaded=!0,r.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var c={};return(()=>{"use strict";l.r(c),l.d(c,{plugin:()=>Rt});var e=l(3),t=l(19),r=l.n(t),n=l(4),a=l(2),o=l.n(a),i={selectedQueryCategory:{label:"Metrics",value:"Metrics",description:"Get Timeseries metrics."},basic_sysparam:[{1:null,2:null,3:null,4:null}],getAlertCount:{label:"No",value:"false"},cacheOverride:"",compressLogs:!1,grafanaTimerange:!1,sortDirection:"ASC",page:0,rowLimit:"2000"},u=l(50),s=l.n(u),f=l(52),p=["sys_created_on","created_on","last_event_time","sys_updated_on","time","start_time","end_time","Updated"];function h(e,t){var r=(0,n.getTemplateSrv)().replace(e,t,"csv"),a=r.indexOf(",");if(a>=0){for(;a>=0;)a=(r=r.replace(",","|")).indexOf(",");r="("+r+")"}return r.startsWith("(")&&r.endsWith(")")?"/"+r+"/":r}function d(e,t){return(0,n.getTemplateSrv)().replace(e,t,"csv")}function y(t,r,n,a,o){var i,u={name:e.TIME_SERIES_TIME_FIELD_NAME,type:e.FieldType.time,config:{custom:{}},values:new e.ArrayVector(t.map((function(e){return e[1]})))};i=(e.FieldType.string,new e.ArrayVector(t.map((function(e){return e[0]}))));var l=[u,{name:e.TIME_SERIES_VALUE_FIELD_NAME,type:null!=o?o:e.FieldType.number,labels:{},config:{displayName:r,custom:{}},values:i}];return{name:r,refId:n.refId,fields:l,length:t.length}}function v(e){1}function m(e){return")"===e.charAt(e.length-2)&&"("===e.charAt(1)&&(e=e.charAt(0)+e.slice(2,-2)+e.charAt(e.length-1)),e}function g(e){var t="";if(1===e.length)return e[0];if("string"==typeof e)return e;for(var r=0;r<e.length;r++)t+="|"+e[r];return"|"===t.charAt(0)&&(t="/"+(t=t.substring(1,t.length))+"/"),t}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function E(){E=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new T(a||[]);return n(i,"_invoke",{value:S(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(C([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==b(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function S(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return A()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=O(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function O(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:A}}function A(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},w(x.prototype),l(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new x(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;_(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var T,C=l(2),A=(T=C)&&T.__esModule?T:{default:T};var j=function(){function t(e,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_(this,"requestOptions",void 0),_(this,"cache",void 0),_(this,"lastCacheDuration",void 0),_(this,"cacheTimeout",void 0),this.requestOptions={headers:e,withCredentials:r,url:n},this.cacheTimeout=a,this.cache=new(s().Cache)}var r,a,i,u,l;return r=t,(a=[{key:"cachedGet",value:(u=E().mark((function e(t,r,a,o,i,u,l){var c,s,f,p,h,d,y,v,m,g,b,w,S,O,L,_,T;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=60,c=void 0!==o&&o?o:this.cacheTimeout,s=this.requestOptions.url+r,f=s+="/body/"+u,a&&Object.keys(a).length>0&&(s=s+(s.search(/\?/)>=0?"&":"?")+a.map((function(e){var t=x(e,2),r=t[0],n=t[1];return"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(n))})).join("&")),this.lastCacheDuration!==c&&this.cache.del(s),this.lastCacheDuration=c,(p=this.cache.get(s))||!s.includes("?")){e.next=36;break}h=this.cache.keys(),d=0;case 15:if(!(d<h.length)){e.next=36;break}if(!(y=h[d]).includes(f)||!y.includes("?")){e.next=33;break}if(v=(v=y.substring(y.indexOf("?")+1,y.length)).split("&"),m=v[0].substring(v[0].indexOf("=")+1,v[0].length),g=v[1].substring(v[1].indexOf("=")+1,v[1].length),b=(b=s.substring(s.indexOf("?")+1,s.length)).split("&"),w=b[0].substring(b[0].indexOf("=")+1,b[0].length),S=b[1].substring(b[1].indexOf("=")+1,b[1].length),L=S-g,!((O=w-m)>=0)){e.next=33;break}if(!(O<=1e3*c&&L<=1e3*c)){e.next=33;break}return p=this.cache.get(y),e.abrupt("break",36);case 33:d++,e.next=15;break;case 36:if(!p){e.next=39;break}return e.abrupt("return",Promise.resolve(p));case 39:return _="",a.length>0&&(_="?"+a.map((function(e){var t=x(e,2),r=t[0],n=t[1];return"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(n))})).join("&")),T="","GET"===t?T=(0,n.getBackendSrv)().get(this.requestOptions.url+r,_):"POST"===t&&(T=(0,n.getBackendSrv)().post(this.requestOptions.url+r+_,u)),this.cache.put(s,T,1e3*c),e.abrupt("return",T);case 45:case"end":return e.stop()}}),e,this)})),l=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=u.apply(e,t);function o(e){O(a,r,n,o,i,"next",e)}function i(e){O(a,r,n,o,i,"throw",e)}o(void 0)}))},function(e,t,r,n,a,o,i){return l.apply(this,arguments)})},{key:"request",value:function(e){e.withCredentials=this.requestOptions.withCredentials,e.headers=this.requestOptions.headers;var t=e.url;e.url=this.requestOptions.url+t;var r=(0,n.getBackendSrv)().fetch(w({},e));return(0,f.lastValueFrom)(r)}},{key:"mapAlertTags",value:function(e){var t=[];return e.map((function(e){if(void 0!==e.additional_info)try{var r=JSON.parse(e.additional_info);Object.keys(r).filter((function(e){return e.includes("tbac-")})).map((function(e){t.push({key:e,value:r[e]})}))}catch(e){}})),t=t.filter((function(e,t,r){return t===r.findIndex((function(t){return t.value===e.value&&t.key===e.key}))}))}},{key:"mapResponseToVariable",value:function(e){return A.default.map(e,(function(e,t){if(void 0!==e.name&&void 0!==e.id)return""!==e.name&&null!==e.name||(e.name="NULL"),""!==e.id&&null!==e.id||(e.id="NULL"),{text:e.name,value:e.id};var r=Object.keys(e);return""!==e[r[0]]&&null!==e[r[0]]||(e[r[0]]="NULL"),!r[1]||""!==e[r[1]]&&null!==e[r[1]]||(e[r[1]]="NULL"),{text:e[r[0]],value:r[1]?e[r[1]]:e[r[0]]}}))}},{key:"mapChecksToValue",value:function(e){return A.default.map(e,(function(e,t){if(void 0!==e.name&&void 0!==e.id)return""!==e.name&&null!==e.name||(e.name="NULL"),""!==e.id&&null!==e.id||(e.id="NULL"),{label:e.name,value:e.id};var r=Object.keys(e);return""!==e[r[0]]&&null!==e[r[0]]||(e[r[0]]="NULL"),!r[1]||""!==e[r[1]]&&null!==e[r[1]]||(e[r[1]]="NULL"),{label:e[r[0]],value:r[1]?e[r[1]]:e[r[0]]}}))}},{key:"mapChecksToValuePlusSuffix",value:function(e){return A.default.map(e,(function(e,t){var r=Object.keys(e);return{label:e[r[0]],value:r[1]?e[r[1]]:e[r[0]],suffix:e[r[2]]}}))}},{key:"mapValueSuffixToColumns",value:function(e){var t=A.default.map(e,(function(e,t){return{label:e.label+":display",value:e.value+":d"}})),r=A.default.map(e,(function(e,t){return{label:e.label+":value",value:e.value+":v"}})),n=t.concat(r);return n=o().orderBy(n,["label"],["asc"])}},{key:"mapValueAsSuffix",value:function(e,t){var r=A.default.map(e,(function(e){var r={label:t?e.label+" ("+e.type+")":e.label,value:e.value,description:e.value};return void 0!==e.options&&(r.options=A.default.map(e.options,(function(e){return{label:t?e.label+" ("+e.type+")":e.label,value:e.value,description:e.value}}))),r}));return r=o().orderBy(r,["label"],["asc"])}},{key:"mapSuffixToLabel",value:function(e){return A.default.map(e,(function(e){return{label:e.label+" ("+e.suffix+")",value:e.value}}))}},{key:"appendInstanceNameToResponse",value:function(e,t){return e=A.default.map(e,(function(e,r){return e.instanceName=t,e}))}},{key:"mapToTextValue",value:function(e){return A.default.map(e,(function(e,t){return e&&e.text&&e.value?{text:e.text,value:e.value}:A.default.isObject(e)?{text:e,value:t}:{text:e,value:e}}))}},{key:"mapOutageResponseToFrame",value:function(t,r){return t.map((function(t){var n=t.ci;return y(t.datapoints,n,r,0,e.FieldType.string)}))}},{key:"mapTrendResponseToFrame",value:function(t,r){return Object.keys(t[0]).map((function(n){return y(t[0][n].datapoints,n,r,0,e.FieldType.number)}))}},{key:"mapMetricsResponseToFrame",value:function(t,r){return t.map((function(t){var n=t.source+":"+t.metricName;return t.type.length>0&&(n+=":"+t.type),y(t.datapoints,n,r,0,e.FieldType.number)}))}},{key:"mapAnamMetricsResponseToFrame",value:function(t,r){var n=t.map((function(t){var n=t.ci_name,a=t.metric_name;return t.data.series.map((function(t){var o=n+":"+a+":"+t.type;return function(t,r,n,a,o){var i,u={name:e.TIME_SERIES_TIME_FIELD_NAME,type:e.FieldType.time,config:{custom:{}},values:new e.ArrayVector(t.map((function(e){return e.time})))};e.FieldType.string,i=new e.ArrayVector(t.map((function(e){return e.value})));var l=[u,{name:e.TIME_SERIES_VALUE_FIELD_NAME,type:null!=o?o:e.FieldType.number,labels:{},config:{displayName:r,custom:{}},values:i}];return{name:r,refId:n.refId,fields:l,length:t.length}}(t.data,o,r,0,e.FieldType.number)}))}));return n=[].concat.apply([],n)}},{key:"mapTextResponseToFrame",value:function(t,r){var n=this,a=new e.MutableDataFrame({fields:[],refId:r});if(v(),!(t.length>0))return[];t=t.map((function(e){if(e.additional_info){var t=JSON.parse(e.additional_info),r=Object.keys(t).filter((function(e){return e.includes("tbac-")}));e.tbac_data={};for(var n=0;n<r.length;n++)e.tbac_data[r[n]]=t[r[n]];return e.tbac_data=JSON.stringify(e.tbac_data),e}return e}));for(var o=Object.keys(t[0]),i=function(r){var i=t.map((function(e){return e[o[r]]}));"new"!==o[r]&&"value:display"!==o[r]||(i=n.sanitizeValues(i));var u,l,c=e.FieldType.string;i.length>=0&&(u=i[0],l=o[r],c=p.includes(l)?e.FieldType.time:"number"==typeof u?e.FieldType.number:e.FieldType.string),a.addField({name:o[r],type:c,values:i})},u=0;u<o.length;u++)i(u);return v(),a}},{key:"createTopologyFrame",value:function(e,t){return[{columns:[{text:"type"},{type:"time",text:"Time"},{text:"app"},{text:"target_app"},{text:"req_rate"},{text:"error_rate"}],rows:e.rows,refId:t||void 0,meta:void 0}]}},{key:"sanitizeValues",value:function(e){var t=[];return e.map((function(e){for(;-1!==e.indexOf("[code]");){var r=e.substring(0,e.indexOf("[code]")),n=e.substring(e.indexOf("[/code]")+7,e.length);if(-1!==e.indexOf("<a")){var a=e.substring(e.indexOf("<a"),e.indexOf("</a>",e.indexOf("<a"))),o=a.substring(a.indexOf(">")+1,a.length);-1!==o.indexOf("<")&&(o=o.substring(0,o.indexOf("<"))),e=r+o+n}else e=r+n}t.push(e)})),t}}])&&L(r.prototype,a),i&&L(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),k(this,"apiClient",void 0),k(this,"apiPath",void 0);var r=t.basicAuth,n=t.withCredentials,a=t.url,o=t.apiPath,i=t.cacheTimeout;this.apiPath=o;var u={"Content-Type":"application/json"};"string"==typeof r&&r.length>0&&(u.Authorization=r),this.apiClient=new j(u,n,a,i)}var t,r,n;return t=e,(r=[{key:"getTopology",value:function(e,t,r){var n=this,a="";e.selectedServiceList&&e.selectedServiceList.value&&(a=d(e.selectedServiceList.value,t.scopedVars));var o="";e.topology_child_depth&&(o=h(e.topology_child_depth,t.scopedVars));var i="";e.topology_parent_depth&&(i=h(e.topology_parent_depth,t.scopedVars));var u="";e.sysparam_query&&(u=d(e.sysparam_query,t.scopedVars)),u=this.removeFiltersWithAll(u);var l='{"targets":[{"target":"'.concat(a,'","child_depth":"').concat(o,'","parent_depth":"').concat(i,'","sysparm_query":"').concat(u,'"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/topology",data:l,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return v(),v(),v(),n.apiClient.createTopologyFrame(t.data,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getMetrics",value:function(e,t,r,n,a){var o=this,i=!1,u="",l=[],c="",s=[],f="",p="";if(e.selectedSourceList){var y=[];e.selectedSourceList.map((function(e){y.push(h(e.value,n.scopedVars))})),u=g(y)}e.selectedMetricTypeList&&(e.selectedMetricTypeList.map((function(e){l.push(h(e.value,n.scopedVars))})),c=g(l)),e.selectedMetricNameList&&(e.selectedMetricNameList.map((function(e){s.push(h(e.value,n.scopedVars))})),f=g(s)),e.selectedMetricAnomalyList&&e.selectedMetricAnomalyList.value&&"true"===h(e.selectedMetricAnomalyList.value,n.scopedVars)&&(i=!0),e.sysparam_query&&(p=d(e.sysparam_query,n.scopedVars)),p=this.removeFiltersWithAll(p),f=m(f),u=m(u);var v='{"targets":[{"target":"'.concat(u,'","resourceName":"').concat(c,'","metricName":"').concat(f,'","sysparm_query":"').concat(p,'"}]}'),b=this.apiPath+"/v1/query/single_metric?startTime="+t+"&endTime="+r;return"*"===f&&(b=this.apiPath+"/v1/query/all_metrics?startTime="+t+"&endTime="+r),!0===i&&(b=this.apiPath+"/v1/query/anomaly_metrics?startTime="+t+"&endTime="+r),this.apiClient.request({url:b,data:v,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return!0===i?o.apiClient.mapAnamMetricsResponseToFrame(t.data,e):o.apiClient.mapMetricsResponseToFrame(t.data,e)})).catch((function(e){throw new Error(e)}))}},{key:"getAlerts",value:function(e,t,r,n,a,o){var i=this,u="";e.selectedServiceList&&e.selectedServiceList.value&&(u=d(e.selectedServiceList.value,n.scopedVars));var l="";if(e.selectedSourceList){var c=[];e.selectedSourceList.map((function(e){c.push(h(e.value,n.scopedVars))})),l=g(c)}var s=u,f="All",p="none",y="";e.selectedAlertStateList&&e.selectedAlertStateList.value&&(f=e.selectedAlertStateList.value),e.selectedAlertTypeList&&("CI"===e.selectedAlertTypeList.value?(p="ci",s=l):"OS"===e.selectedAlertTypeList.value?(p="os",-1!==(s=l).indexOf("(")&&(s=s.substring(s.indexOf("(")+1,s.indexOf(")")))):"None"===e.selectedAlertTypeList.value&&(p="none")),e.sysparam_query&&(y=d(e.sysparam_query,n.scopedVars)),y=this.removeFiltersWithAll(y);var m="";if(e.tagKeys&&e.tagValues)for(var b=0;b<e.tagKeys.length;b++)"$"===e.tagKeys[b].value.charAt(0)?d(e.tagKeys[b].value,n.scopedVars).split(",").map((function(t){for(var r=0;r<e.tagValues.length;r++)if("$"===e.tagValues[r].value.charAt(0))d(e.tagValues[r].value,n.scopedVars).split(",").map((function(e){""!==t&&""!==e&&(m+=t+"="+e+",")}));else{var a=e.tagValues[r].value;""!==t&&""!==a&&(m+=t+"="+a+",")}})):function(){for(var t=e.tagKeys[b].value,r=0;r<e.tagValues.length;r++)if("$"===e.tagValues[r].value.charAt(0))d(e.tagValues[r].value,n.scopedVars).split(",").map((function(e){""!==t&&""!==e&&(m+=t+"="+e+",")}));else{var a=e.tagValues[r].value;""!==t&&""!==a&&(m+=t+"="+a+",")}}();","===m.charAt(m.length-1)&&(m=m.substring(0,m.length-1));var w="",E="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(w=d(e.sortBy.value,n.scopedVars),E=e.sortDirection);var x=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(x=e.rowLimit);var S=0;e.page&&e.page>=0&&(S=e.page);var O="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(O=d(e.grafanaTimerangeColumn.value,n.scopedVars));var L='{"targets":[{"target":"'.concat(s,'","sysparm_query":"').concat(y,'","alertType":"').concat(p,'","alertState":"').concat(f,'","sortBy":"').concat(w,'","sortDirection":"').concat(E,'","limit":').concat(x,',"page":').concat(S,',"tagFilters":"').concat(m,'"}]}'),_=this.apiPath+"/v1/query/alerts";return e.grafanaTimerange&&(_+="?startTime="+t+"&endTime="+r+"&timerangeColumn="+O),this.apiClient.request({url:_,data:L,method:"POST",cacheOverride:""===o?null:o}).then((function(t){return v(),v(),t=i.apiClient.appendInstanceNameToResponse(t.data,a),v(),i.apiClient.mapTextResponseToFrame(t,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"queryTable",value:function(e,t,r,n,a){var o=this,i="";e.tableName&&e.tableName.value&&(i=h(e.tableName.value,n.scopedVars));var u="";e.selectedtableColumns&&(e.selectedtableColumns.map((function(e){u+=h(e.value,n.scopedVars)+","})),","===u.charAt(u.length-1)&&(u=u.substring(0,u.length-1)));var l="";-1!==e.basic_sysparam.constructor.toString().indexOf("Array")&&(l=this.parseBasicSysparm(e.basic_sysparam,n)),l=this.removeFiltersWithAll(l);var c=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(c=e.rowLimit);var s=0;e.page&&e.page>=0&&(s=e.page);var f="",p="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(f=d(e.sortBy.value,n.scopedVars),p=e.sortDirection);var y="false";e.getAlertCount&&(y=e.getAlertCount.value);var m="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(m=d(e.grafanaTimerangeColumn.value,n.scopedVars));var g='{"targets":[{"target":"'.concat(i,'","columns":"').concat(u,'","sysparm":"').concat(l,'","limit":').concat(c,',"page":').concat(s,',"sortBy":"').concat(f,'","sortDirection":"').concat(p,'","getAlertCount":').concat(y,"}]}"),b=this.apiPath+"/v1/query/table";return e.grafanaTimerange&&(b+="?startTime="+t+"&endTime="+r+"&timerangeColumn="+m),this.apiClient.request({url:b,data:g,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return v(),v(),o.apiClient.mapTextResponseToFrame(t.data,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getRowCount",value:function(e,t,r,n,a){var o=this,i="";e.tableName&&e.tableName.value&&(i=h(e.tableName.value,n.scopedVars));var u="";e.sysparam_query&&(u=d(e.sysparam_query,n.scopedVars)),u=this.removeFiltersWithAll(u);var l="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(l=d(e.grafanaTimerangeColumn.value,n.scopedVars));var c='{"targets":[{"target":"'.concat(i,'","sysparm":"').concat(u,'"}]}'),s=this.apiPath+"/v1/query/row_count";return e.grafanaTimerange&&(s+="?startTime="+t+"&endTime="+r+"&timerangeColumn="+l),this.apiClient.request({url:s,data:c,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return v(),v(),o.apiClient.mapTextResponseToFrame(t.data,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getAggregateQuery",value:function(e,t,r,n,a){var o=this,i="",u="",l="",c="",s="";e.tableName&&e.tableName.value&&(i=h(e.tableName.value,n.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(u=d(e.groupBy,n.scopedVars)):e.groupBy&&e.groupBy.value&&(u=d(e.groupBy.value,n.scopedVars)),e.selectedAggregateType&&e.selectedAggregateType.value&&(l=e.selectedAggregateType.value),e.aggregateColumn&&e.aggregateColumn.value&&(c=d(e.aggregateColumn.value,n.scopedVars)),e.sysparam_query&&(s=d(e.sysparam_query,n.scopedVars),s=this.removeFiltersWithAll(s));var f=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(f=e.rowLimit);var p="sys_updated_on";e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.value&&(p=d(e.grafanaTimerangeColumn.value,n.scopedVars));var y='{"targets":[{"target":"'.concat(i,'","type":"').concat(l,'","column":"').concat(c,'","groupBy":"').concat(u,'","sysparm":"').concat(s,'","limit":').concat(f,"}]}"),m=this.apiPath+"/v1/query/aggregate";return e.grafanaTimerange&&(m+="?startTime="+t+"&endTime="+r+"&timerangeColumn="+p),this.apiClient.request({url:m,data:y,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return v(),v(),o.apiClient.mapTextResponseToFrame(t.data,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getGeohashMap",value:function(e,t,r){var n=this,a="",o="",i="";e.tableName&&e.tableName.value&&(a=h(e.tableName.value,t.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(o=d(e.groupBy,t.scopedVars)):"object"===I(e.groupBy)&&null!==e.groupBy&&""!==e.groupBy.value&&(o=d(e.groupBy.value,t.scopedVars)),e.sysparam_query&&(i=d(e.sysparam_query,t.scopedVars)),i=this.removeFiltersWithAll(i);var u='{"targets":[{"target":"'.concat(a,'","column":"').concat(o,'","sysparm":"').concat(i,'"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/geohash_map",data:u,method:"POST",cacheOverride:""===r?null:r}).then((function(t){return v(),v(),n.apiClient.mapTextResponseToFrame(t.data,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"queryLogData",value:function(e,t,r,n,a){var o=this,i=e.compressLogs,u="";-1!==e.basic_sysparam.constructor.toString().indexOf("Array")&&(u=this.parseBasicSysparm(e.basic_sysparam,n)),u=this.removeFiltersWithAll(u);var l=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(l=e.rowLimit);var c=0;e.page&&e.page>=0&&(c=e.page);var s="",f="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(s=d(e.sortBy.value,n.scopedVars),f=e.sortDirection);var p="";e.elasticSearch&&(p=d(e.elasticSearch,n.scopedVars));var h='{"targets":[{"sysparm":"'.concat(u,'","limit":').concat(l,',"page":').concat(c,',"sortBy":"').concat(s,'","sortDirection":"').concat(f,'","esSearch":"').concat(p,'","startTime":').concat(t,',"endTime":').concat(r,',"compressLog":').concat(i,"}]}");return this.apiClient.request({url:this.apiPath+"/v1/query/logs",data:h,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return v(),v(),o.apiClient.mapTextResponseToFrame(t.data,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getTrendData",value:function(e,t,r,n,a){var o=this,i="",u="",l="",c="",s="",f="",p=1;e.tableName&&e.tableName.value&&(i=h(e.tableName.value,n.scopedVars)),-1!==e.basic_sysparam.constructor.toString().indexOf("Array")&&(u=this.parseBasicSysparm(e.basic_sysparam,n)),u=this.removeFiltersWithAll(u),e.elasticSearch&&(l=d(e.elasticSearch,n.scopedVars)),"string"==typeof e.groupBy?""!==e.groupBy&&(c=d(e.groupBy,n.scopedVars)):"object"===I(e.groupBy)&&null!==e.groupBy&&""!==e.groupBy.value&&(c=d(e.groupBy.value,n.scopedVars)),e.selectedTrendColumn&&e.selectedTrendColumn.value&&(s=d(e.selectedTrendColumn.value,n.scopedVars)),e.selectedTrendBy&&e.selectedTrendBy.value&&(f=d(e.selectedTrendBy.value,n.scopedVars)),e.trendPeriod&&e.trendPeriod>0&&(p=e.trendPeriod);var y='{"targets":[{"target":"'.concat(i,'","sysparm":"').concat(u,'","esSearch":"').concat(l,'","trendColumn":"').concat(s,'","trendBy":"').concat(f,'","period":').concat(p,',"groupBy":"').concat(c,'"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/trend?startTime="+t+"&endTime="+r,data:y,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return v(),v(),o.apiClient.mapTrendResponseToFrame(t.data,e)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getOutageStatus",value:function(e,t,r,n,a){var o=this,i="";e.selectedServiceList&&e.selectedServiceList.value&&(i=d(e.selectedServiceList.value,n.scopedVars));var u=!1;"boolean"==typeof e.showPercent&&(u=e.showPercent);var l="";e.sysparam_query&&(l=d(e.sysparam_query,n.scopedVars)),l=this.removeFiltersWithAll(l);var c=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(c=e.rowLimit);var s=0;e.page&&e.page>=0&&(s=e.page);var f='{"targets":[{"target":"'.concat(i,'","showPercent":').concat(u,',"sysparm":"').concat(l,'","limit":').concat(c,',"page":').concat(s,"}]}");return this.apiClient.request({url:this.apiPath+"/v1/query/outage",data:f,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return v(),v(),u?o.apiClient.mapTextResponseToFrame(t.data,e.refId):o.apiClient.mapOutageResponseToFrame(t.data,e)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getAnomaly",value:function(e,t,r,n,a){var o=this,i="";e.selectedtableColumns&&e.selectedtableColumns.length>0&&(e.selectedtableColumns.map((function(e){i+=h(e.value,n.scopedVars)+","})),","===i.charAt(i.length-1)&&(i=i.substring(0,i.length-1)));var u="";-1!==e.basic_sysparam.constructor.toString().indexOf("Array")&&(u=this.parseBasicSysparm(e.basic_sysparam,n)),u=this.removeFiltersWithAll(u);var l=9999;e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(l=e.rowLimit);var c=0;e.page&&e.page>=0&&(c=e.page);var s="",f="";e.sortBy&&e.sortDirection&&e.sortBy.value&&(s=d(e.sortBy.value,n.scopedVars),f=e.sortDirection);var p='{"targets":[{"columns":"'.concat(i,'","sysparm":"').concat(u,'","limit":').concat(l,',"page":').concat(c,',"sortBy":"').concat(s,'","sortDirection":"').concat(f,'"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/anomaly",data:p,method:"POST",cacheOverride:""===a?null:a}).then((function(t){return v(),v(),o.apiClient.mapTextResponseToFrame(t.data,e.refId)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getGenericVariable",value:function(e,t,r,n,a){var o=this,i='{"targets":[{"tableName":"'.concat(e,'","nameColumn":"').concat(t,'","idColumn":"').concat(r,'","sysparm":"').concat(n,'","limit":').concat(a,"}]}");return this.apiClient.request({url:this.apiPath+"/v1/variable/generic",data:i,method:"POST"}).then((function(e){return v(),o.apiClient.mapResponseToVariable(e.data)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getMetricNamesInCIs",value:function(e,t){var r=this,n=g(t),a='{"targets":[{"target":"'+(n=m(n))+'","metricType":"'+e+'"}]}',o=this.apiPath+"/v1/variable/metrics";return this.apiClient.request({url:o,data:a,method:"POST"}).then((function(e){return v(),r.apiClient.mapResponseToVariable(e.data)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getNestedCIS",value:function(e){var t=this,r='{"targets":[{"ci": "'.concat(e.ci,'",\n      "parentDepth":"').concat(e.parentDepth,'",\n      "childDepth":"').concat(e.childDepth,'",\n      "sysparm":"').concat(e.sysparam,'",\n      "type":"ci"}]}');return this.apiClient.request({url:this.apiPath+"/v1/variable/nested_value",data:r,method:"POST"}).then((function(e){return v(),t.apiClient.mapResponseToVariable(e.data)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getNestedClasses",value:function(e){var t=this,r='{"targets":[{"ci": "'.concat(e.ci,'",\n      "parentDepth":"').concat(e.parentDepth,'",\n      "childDepth":"').concat(e.childDepth,'",\n      "sysparm":"').concat(e.sysparam,'",\n      "type":"class"}]}');return this.apiClient.request({url:this.apiPath+"/v1/variable/nested_value",data:r,method:"POST"}).then((function(e){return v(),t.apiClient.mapResponseToVariable(e.data)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getMetricAnomalyOptions",value:function(){return[{label:"true",value:"true"},{label:"false",value:"false"}]}},{key:"getAlertTypeOptions",value:function(){return[{label:"CI",value:"CI",description:"Get Alerts at the CI level"},{label:"Service",value:"Service",description:"Get Alerts at the Service level"},{label:"None",value:"None",description:"Ignore CI selection and use sysparam_query"}]}},{key:"getAlertStateOptions",value:function(){return[{label:"Active",value:"Active",description:"Get Open and Reopen Alerts"},{label:"All",value:"All",description:"Get All alerts Open,Reopen, and Closed"}]}},{key:"getAggregateTypeOptions",value:function(){return[{label:"AVG",value:"AVG"},{label:"COUNT",value:"COUNT"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"STDDEV",value:"STDDEV"},{label:"SUM",value:"SUM"}]}},{key:"getSysparamTypeOptions",value:function(){return[{label:"is",value:"=",description:"="},{label:"is not",value:"!=",description:"!="},{label:"starts with",value:"STARTSWITH",description:"STARTSWITH"},{label:"ends with",value:"ENDSWITH",description:"ENDSWITH"},{label:"contains",value:"LIKE",description:"LIKE"},{label:"does not contain",value:"NOT LIKE",description:"NOT LIKE"},{label:"is empty",value:"ISEMPTY",description:"ISEMPTY"},{label:"is not empty",value:"ISNOTEMPTY",description:"ISNOTEMPTY"},{label:"is anything",value:"ANYTHING",description:"ANYTHING"},{label:"is one of",value:"IN",description:"IN"},{label:"is not one of",value:"NOT IN",description:"NOT IN"},{label:"is empty string",value:"EMPTYSTRING",description:"EMPTYSTRING"},{label:"less than or is",value:"<=",description:"<="},{label:"greater than or is",value:">=",description:">="},{label:"between",value:"BETWEEN",description:"BETWEEN"},{label:"instance of",value:"INSTANCEOF",description:"INSTANCEOF"}]}},{key:"getTrendByOptions",value:function(){return[{label:"Minute",value:"minute"},{label:"Week",value:"week"}]}},{key:"loadServiceOptions",value:function(e){var t=this,r='{"targets":[{"target":"cmdb_ci_service","columns":"name:d,sys_id:v","sysparm":"operational_status=1^name!=All^nameLIKE'.concat(e||"",'","limit":100,"sortBy":"name","sortDirection":"ASC"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){return v(),v(),t.apiClient.mapChecksToValue(e.data)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"loadCIOptions",value:function(e,t){var r=this,n=t||"",a="";return a=e?'{"targets":[{"target":"em_impact_graph","columns":"child_name:d,child_id:v,child_id:d","sysparm":"business_service='.concat(e,"^child_nameLIKE").concat(n,'","limit":100,"sortBy":"ci_name","sortDirection":"ASC"}]}'):'{"targets":[{"target":"cmdb_ci","columns":"name:d,sys_id:v,sys_class_name:d","sysparm":"nameLIKE'.concat(n,'^name!=NULL","limit":100,"sortBy":"cmdb_ci.name","sortDirection":"ASC"}]}'),this.apiClient.request({url:this.apiPath+"/v1/query/table",data:a,method:"POST"}).then((function(e){v(),v();var t=r.apiClient.mapChecksToValuePlusSuffix(e.data);return v(),r.apiClient.mapSuffixToLabel(t)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"loadResourceOptions",value:function(e,t){var r=this,n="",a=t||"";if(e){var o=e.map((function(e){return e.value}));n='{"targets":[{"target":"sa_metric_map","columns":"resource_id:d,resource_id:v","sysparm":"cmdb_ciIN'.concat(o,"^resource_idLIKE").concat(a,'^resource_id!=NULL","limit":100,"sortBy":"resource_id","sortDirection":"ASC"}]}')}return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){v(),v();var t=[{label:"*",value:"*"}].concat(r.apiClient.mapChecksToValue(e.data));return t=t.filter((function(e,t,r){return t===r.findIndex((function(t){return t.value===e.value}))}))})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"loadMetricOptions",value:function(e,t){var r=this,n="",a=t||"";if(void 0!==e){var o=e.map((function(e){return e.value}));n='{"targets":[{"target":"sa_metric_map","columns":"metric_type_id.metric_type_tiny_name:d,metric_type_id:v","sysparm":"cmdb_ciIN'.concat(o,"^metric_type_id.metric_type_tiny_nameLIKE").concat(a,'","limit":100,"sortBy":"","sortDirection":"ASC"}]}')}return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){v(),v();var t=[{label:"*",value:"*"}].concat(r.apiClient.mapChecksToValue(e.data));return t=t.filter((function(e,t,r){return t===r.findIndex((function(t){return t.value===e.value}))}))})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"loadColumnChoices",value:function(e,t,r){var n=this,a='{"targets":[{"target":"sys_choice","columns":"label,value","sysparm":"name='.concat(e,"^element!=NULL^elementLIKE").concat(t,"^labelLIKE").concat(r,'^language=en","limit":100,"sortBy":"label","sortDirection":"ASC"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:a,method:"POST"}).then((function(e){return v(),v(),n.apiClient.mapChecksToValue(e.data)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getTableColumnOptions",value:function(e){var t=this;if(void 0!==e){var r='{"targets":[{"table":"'.concat(e,'"}]}');return this.apiClient.request({url:this.apiPath+"/v1/select/table_columns",data:r,method:"POST"}).then((function(e){return v(),v(),t.apiClient.mapValueAsSuffix(e.data,!0)})).catch((function(e){throw new Error(e.data.error.message)}))}}},{key:"loadTableOptions",value:function(e){var t=this,r='{"targets":[{"target":"sys_db_object","columns":"label,name","sysparm":"nameLIKE'.concat(e,"^ORlabelLIKE").concat(e,'","limit":100}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){v(),v();var r=t.apiClient.mapChecksToValue(e.data);return v(),t.apiClient.mapValueAsSuffix(r,!1)})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"getTopologyCISummary",value:function(e){var t='{"targets":[{"target":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/ci_summary",data:t,method:"POST"}).then((function(e){return v(),v(),e.data}))}},{key:"getAlertTags",value:function(e,t,r){var n=this;r||(r=9999),"Active"===e&&(t+="state!=Closed");var a='{"targets":[{"target":"em_alert","columns":"additional_info","sysparm":"'.concat(t,'","limit":').concat(r,',"sortBy":"","sortDirection":"ASC"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:a,method:"POST"}).then((function(e){v(),v();var t=n.apiClient.mapAlertTags(e.data);return v(),t})).catch((function(e){throw new Error(e.data.error.message)}))}},{key:"removeFiltersWithAll",value:function(e){for(var t=e.indexOf("*");-1!==t;){var r=e.substring(t+1),n=e.substring(0,t+1),a=n.lastIndexOf("^");-1===a&&(a=0),t=(e=(n=n.substring(0,a))+r).indexOf("*")}return e}},{key:"parseBasicSysparm",value:function(e,t){for(var r="",n=0;n<e.length;n++){var a=e[n],o="";a[1]&&(o=d(a[1].value,t.scopedVars));var i="";a[2]&&(i=a[2].value);var u="";a[3]&&(u=d(a[3].value,t.scopedVars));var l="";a[4]&&(l=a[4].value),r+=l+o+i+u}return r}}])&&F(t.prototype,r),n&&F(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(){N=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==V(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function q(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function M(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){q(o,n,a,i,u,"next",e)}function u(e){q(o,n,a,i,u,"throw",e)}i(void 0)}))}}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=W(e);if(t){var a=W(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return B(this,r)}}function B(e,t){if(t&&("object"===V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return D(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var H,K=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(p,t);var a,u,l,c,s,f=Q(p);function p(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),U(D(t=f.call(this,e)),"snowConnection",void 0),U(D(t),"annotations",void 0),U(D(t),"instanceName",void 0),U(D(t),"globalImage",void 0),U(D(t),"apiPath",void 0);var r={type:e.type,url:e.url,name:e.name,basicAuth:e.basicAuth,withCredentials:e.withCredentials,apiPath:e.jsonData.apiPath,cacheTimeout:e.jsonData.cacheTimeout};return t.globalImage=e.jsonData.imageURL,t.instanceName=e.jsonData.instanceName,t.apiPath=r.apiPath,t.snowConnection=new P(r),t.annotations={},t}return a=p,(u=[{key:"metricFindQuery",value:(s=M(N().mark((function e(t,r){var a,o,i,u,l,c,s,f,p,h,d,y,v,m,g,b,w,E,x,S,O,L,_,T,C,A,j,I,F,k;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("global_image"!==t.namespace){e.next=3;break}return e.abrupt("return",[{label:this.globalImage,value:this.globalImage}]);case 3:if("global_instance_name"!==t.namespace){e.next=5;break}return e.abrupt("return",[{label:this.instanceName,value:this.instanceName}]);case 5:if("generic"!==t.namespace){e.next=18;break}if(void 0===t.rawQuery){e.next=17;break}return a=t.rawQuery.split("||"),o=void 0===a[0]?"":(0,n.getTemplateSrv)().replace(a[0],r.scopedVars,"csv"),i=void 0===a[1]?"":(0,n.getTemplateSrv)().replace(a[1],r.scopedVars,"csv"),u=void 0===a[2]?"":(0,n.getTemplateSrv)().replace(a[2],r.scopedVars,"csv"),l=void 0===a[3]?"":(0,n.getTemplateSrv)().replace(a[3],r.scopedVars,"csv"),c=void 0===a[4]?"9999":(0,n.getTemplateSrv)().replace(a[4],r.scopedVars,"csv"),e.abrupt("return",this.snowConnection.getGenericVariable(o,i,u,l,c));case 17:return e.abrupt("return",[]);case 18:if("metric_names"!==t.namespace){e.next=25;break}return s=(0,n.getTemplateSrv)().replace(t.rawQuery,r.scopedVars,"csv"),f=s.split(","),e.abrupt("return",this.snowConnection.getMetricNamesInCIs("",f));case 25:if("golden_metric_names"!==t.namespace){e.next=32;break}return p=(0,n.getTemplateSrv)().replace(t.rawQuery,r.scopedVars,"csv"),h=p.split(","),e.abrupt("return",this.snowConnection.getMetricNamesInCIs("GOLDEN",h));case 32:if("custom_kpis"!==t.namespace){e.next=39;break}return d=(0,n.getTemplateSrv)().replace(t.rawQuery,r.scopedVars,"csv"),y=d.split(","),e.abrupt("return",this.snowConnection.getMetricNamesInCIs("CUSTOM_KPIS",y));case 39:if("nested_cis"!==t.namespace){e.next=48;break}return(v=t.rawQuery.split("||")).map((function(e,t){v[t]=(0,n.getTemplateSrv)().replace(e,r.scopedVars,"csv"),0===v[t].indexOf("$")&&(v=v.splice(t))})),m={ci:void 0===v[0]?"":v[0],parentDepth:void 0===v[1]?"":v[1],childDepth:void 0===v[2]?"":v[2],sysparam:void 0===v[3]?"":v[3]},g=this.snowConnection.getNestedCIS(m),e.abrupt("return",g);case 48:if("nested_classes"!==t.namespace){e.next=55;break}return(b=t.rawQuery.split("||")).map((function(e,t){b[t]=(0,n.getTemplateSrv)().replace(e,r.scopedVars,"csv"),0===b[t].indexOf("$")&&(b=b.splice(t))})),w={ci:void 0===b[0]?"":b[0],parentDepth:void 0===b[1]?"":b[1],childDepth:void 0===b[2]?"":b[2],sysparam:void 0===b[3]?"":b[3]},e.abrupt("return",this.snowConnection.getNestedClasses(w));case 55:if("tagKeys"!==t.namespace){e.next=71;break}if(void 0===t.rawQuery){e.next=70;break}return(E=t.rawQuery.split("||")).map((function(e,t){E[t]=(0,n.getTemplateSrv)().replace(e,r.scopedVars,"csv"),0===E[t].indexOf("$")&&(E=E.splice(t))})),x=void 0===E[0]?"All":E[0],S=void 0===E[1]?"":E[1],O=void 0===E[2]?"9999":E[2],e.next=65,this.snowConnection.getAlertTags(x,S,O);case 65:return L=e.sent,(_=L.map((function(e){return{text:e.key,value:e.key}}))).unshift({text:"None",value:""}),e.abrupt("return",_);case 70:return e.abrupt("return",[]);case 71:if("tagValues"!==t.namespace){e.next=89;break}if(void 0===t.rawQuery){e.next=88;break}return(T=t.rawQuery.split("||")).map((function(e,t){T[t]=(0,n.getTemplateSrv)().replace(e,r.scopedVars,"csv"),0===T[t].indexOf("$")&&(T=T.splice(t))})),C=void 0===T[0]?"":T[0],A=void 0===T[1]?"All":T[1],j=void 0===T[2]?"":T[2],I=void 0===T[3]?"9999":T[3],e.next=82,this.snowConnection.getAlertTags(A,j,I);case 82:return F=(F=e.sent).filter((function(e){if(C.includes(e.key))return e})),(k=F.map((function(e){return{text:e.value,value:e.value}}))).unshift({text:"None",value:""}),e.abrupt("return",k);case 88:return e.abrupt("return",[]);case 89:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"query",value:(c=M(N().mark((function t(n){var a,u,l,c,s=this;return N().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.range,u=a.from.valueOf(),l=a.to.valueOf(),c=o().map(n.targets,(function(e){if(e.hide)return[];var t=o().cloneDeep(e),a=r()(t,i),c=a.selectedQueryCategory.value,f=a.cacheOverride;switch(c){case"Topology":return s.snowConnection.getTopology(t,n,f);case"Metrics":return s.snowConnection.getMetrics(t,u,l,n,f);case"Alerts":return s.snowConnection.getAlerts(t,u,l,n,s.instanceName,f);case"Table":return s.snowConnection.queryTable(t,u,l,n,f);case"Row_Count":return s.snowConnection.getRowCount(t,u,l,n,f);case"Aggregate":return s.snowConnection.getAggregateQuery(t,u,l,n,f);case"Geohash_Map":return s.snowConnection.getGeohashMap(t,n,f);case"Log_Data":return s.snowConnection.queryLogData(t,u,l,n,f);case"Trend_Data":return s.snowConnection.getTrendData(t,u,l,n,f);case"Outage_Status":return s.snowConnection.getOutageStatus(t,u,l,n,f);case"Anomaly":return s.snowConnection.getAnomaly(t,u,l,n,f);default:return[]}})),t.abrupt("return",Promise.all(o().flatten(c)).then(o().flatten).then((function(t){return{data:t,state:e.LoadingState.Done,key:n.requestId}})));case 5:case"end":return t.stop()}}),t)}))),function(e){return c.apply(this,arguments)})},{key:"testDatasource",value:function(){return this.snowConnection.apiClient.request({url:this.apiPath,method:"GET"}).then((function(){return{status:"success",message:"Data source connection is successful",title:"Success"}})).catch((function(e){return{status:"error",message:"Data source connection failed: ".concat(e.statusText),title:"Error"}}))}}])&&G(a.prototype,u),l&&G(a,l),Object.defineProperty(a,"prototype",{writable:!1}),p}(e.DataSourceApi),$=l(0),Y=l.n($),z=l(1);function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X(){return(X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e){return function(e){if(Array.isArray(e))return ie(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||oe(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(){te=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==Z(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function re(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function ne(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){re(o,n,a,i,u,"next",e)}function u(e){re(o,n,a,i,u,"throw",e)}i(void 0)}))}}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||oe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){if(e){if("string"==typeof e)return ie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ie(e,t):void 0}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ue=function(e){var t=e.query,r=e.updateQuery,n=e.datasource,o=e.replaceMultipleVariables,i=ae((0,$.useState)([{label:"Loading...",value:""}]),2),u=i[0],l=i[1],c=ae((0,$.useState)([{label:"Loading...",value:""}]),2),s=c[0],f=c[1];(0,$.useEffect)((function(){var e=[],i=[],u=[];function c(){return(c=ne(te().mark((function c(){var s,p,h,d,y,v;return te().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return s=t.selectedAlertStateList,p=t.sysparam_query,h=t.rowLimit,p=o(p),c.next=5,n.snowConnection.getAlertTags(s,p,h);case 5:for(u=c.sent,d=function(r){e.push({label:u[r].key,value:u[r].key}),void 0!==t.tagKeys&&void 0!==t.tagKeys[0]&&"$"!==t.tagKeys[0].value.charAt(0)&&t.tagKeys.map((function(e){u[r].key===e.value&&i.push({label:u[r].value,value:u[r].value})}))},y=0;y<u.length;y++)d(y);e=e.filter((function(e,t,r){return t===r.findIndex((function(t){return t.value===e.value}))})),i=i.filter((function(e,t,r){return t===r.findIndex((function(t){return t.value===e.value}))})),t.tagValues&&t.tagValues[0]&&"$"!==t.tagValues[0].value.charAt(0)&&(v=t.tagValues,t.tagValues.map((function(e,t){if(!e.custom){var r=!1;i.map((function(t){e.value!==t.value||e.custom||(r=!0)})),r||v.splice(t,1)}})),(0,a.isEqual)(v,t.tagValues)||r("tagValues",v)),l(e),f(i);case 14:case"end":return c.stop()}}),c)})))).apply(this,arguments)}!function(){c.apply(this,arguments)}()}),[n.snowConnection,t,r,o]);var p=u;void 0!==t.tagKeys&&(p=[].concat(ee(u),[t.tagKeys]),p=[].concat.apply([],p));var h=s;return void 0!==t.tagValues&&(h=[].concat(ee(s),[t.tagValues]),h=[].concat.apply([],h)),Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Tag Keys",labelWidth:20,tooltip:"Filter by tags located in additional info"},Y().createElement(z.Select,{className:"min-width-10 max-width-20",options:p,value:t.tagKeys,defaultValue:t.tagKeys,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return r("tagKeys",e)},onCreateOption:function(e){var n={label:e,value:e},a=[];t.tagKeys?(a=ee(t.tagKeys)).push(n):a=[n],r("tagKeys",a)},maxMenuHeight:200})),Y().createElement(z.InlineField,{label:"Tag Values",labelWidth:20},Y().createElement(z.Select,{className:"min-width-10 max-width-20",options:h,value:t.tagValues,defaultValue:t.tagValues,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return r("tagValues",e)},onCreateOption:function(e){var n={label:e,value:e,custom:!0},a=[];t.tagValues?(a=ee(t.tagValues)).push(n):a=[n],r("tagValues",a)},maxMenuHeight:200}))))},le=function(e){var t=e.value,r=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Query Alert Count",labelWidth:20,tooltip:"Extra query per row to get the number of alerts on a ci. Adds extra processing, use wisely!"},Y().createElement(z.RadioButtonGroup,{value:t.value,options:[{label:"No",value:"false"},{label:"Yes",value:"true"}],onChange:function(e){return r("getAlertCount",{label:e,value:e})}}))))},ce=function(e){var t=e.updateQuery,r=e.defaultValue;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Elastic Search Query",labelWidth:20},Y().createElement(z.Input,{name:"elasticSearch",width:60,defaultValue:r,onBlur:function(e){return t("elasticSearch",e.target.value)}}))))};function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(){fe=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==se(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function pe(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function he(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){pe(o,n,a,i,u,"next",e)}function u(e){pe(o,n,a,i,u,"throw",e)}i(void 0)}))}}function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ve=function(e){var t=e.query,r=e.updateQuery,n=e.datasource,a=de((0,$.useState)(t.groupBy),2),o=a[0],i=a[1],u=de((0,$.useState)([{label:"Loading ...",value:""}]),2),l=u[0],c=u[1];return(0,$.useEffect)((function(){var e=[],r=!1;function a(){return(a=he(fe().mark((function a(){var o;return fe().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.snowConnection.getTableColumnOptions(null===(o=t.tableName)||void 0===o?void 0:o.value);case 2:e=a.sent,r||e.length>0&&c(e);case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return function(){a.apply(this,arguments)}(),function(){r=!0}}),[n.snowConnection,t.tableName]),Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{labelWidth:20,label:"Group By",tooltip:"Select a column which will be used to group the results by."},Y().createElement(z.Select,{width:40,isMulti:!1,options:l,isClearable:!0,value:o,isSearchable:!0,menuPlacement:"top",maxMenuHeight:200,allowCustomValue:!0,defaultValue:o,backspaceRemovesValue:!0,onChange:function(e){i(e),r("groupBy",e)},onCreateOption:function(e){i({label:e,value:e}),r("groupBy",{label:e,value:e})}}))))},me=function(e){var t=e.updateQuery,r=e.defaultValue;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Limit",labelWidth:20,tooltip:"Limit the number of results. Expects a number between 1 - 9999"},Y().createElement(z.Input,{name:"limit",type:"number",max:9999,min:1,width:20,defaultValue:r,onBlur:function(e){return t("rowLimit",e.target.value)}}))))},ge=function(e){var t=e.defaultValue,r=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Page",labelWidth:20,tooltip:"Page number used for pagination. Starts at page 0"},Y().createElement(z.Input,{name:"page",type:"number",max:9999,min:0,width:20,defaultValue:t,onBlur:function(e){return r("page",e.target.valueAsNumber)}}))))};function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e){return function(e){if(Array.isArray(e))return _e(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Le(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(){Ee=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==be(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function xe(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function Se(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){xe(o,n,a,i,u,"next",e)}function u(e){xe(o,n,a,i,u,"throw",e)}i(void 0)}))}}function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||Le(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e,t){if(e){if("string"==typeof e)return _e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_e(e,t):void 0}}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Te=function(e){var t=e.query,r=e.updateQuery,n=e.datasource,a=n.snowConnection.getAggregateTypeOptions(),o=Oe((0,$.useState)([{label:"Loading ...",value:""}]),2),i=o[0],u=o[1];return(0,$.useEffect)((function(){var e=[],r=!1;function a(){return(a=Se(Ee().mark((function a(){var o;return Ee().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.snowConnection.getTableColumnOptions(null===(o=t.tableName)||void 0===o?void 0:o.value);case 2:e=a.sent,r||e.length>0&&(t.aggregateColumn&&t.aggregateColumn.length>0&&(e=e.concat(t.aggregateColumn)),u(e));case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return function(){a.apply(this,arguments)}(),function(){r=!0}}),[n.snowConnection,t.tableName,t.aggregateColumn]),Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Aggregate Function",labelWidth:20,tooltip:"Choose your aggregation function then the column to run this function on"},Y().createElement(z.Select,{width:20,options:a,value:t.selectedAggregateType,defaultValue:t.selectedAggregateType,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return r("selectedAggregateType",{label:e,value:e})},onChange:function(e){return r("selectedAggregateType",e)},maxMenuHeight:200})),Y().createElement(z.InlineField,null,Y().createElement(z.Select,{options:i,value:t.aggregateColumn,defaultValue:t.aggregateColumn,width:40,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return r("aggregateColumn",e)},onCreateOption:function(e){var n=[];void 0!==t.aggregateColumn?(n=we(t.aggregateColumn))[n.length]={label:e,value:e}:n=[{label:e,value:e}],r("aggregateColumn",n)},maxMenuHeight:200}))))};function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e){return function(e){if(Array.isArray(e))return Ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Pe(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(){je=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==Ce(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function Ie(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function Fe(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ie(o,n,a,i,u,"next",e)}function u(e){Ie(o,n,a,i,u,"throw",e)}i(void 0)}))}}function ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||Pe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){if(e){if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ne=function(e){var t=e.query,r=e.updateQuery,n=e.datasource,a=e.sysparamTypeOptions,o=e.loadChoices,i=e.table,u=ke((0,$.useState)([{label:"Loading ...",value:""}]),2),l=u[0],c=u[1];(0,$.useEffect)((function(){var e=[],t=!1;function r(){return(r=Fe(je().mark((function r(){return je().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.snowConnection.getTableColumnOptions(i);case 2:e=r.sent,t||e.length>0&&c(e);case 4:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return function(){r.apply(this,arguments)}(),function(){t=!0}}),[n.snowConnection,i]);for(var s=Ae(t.basic_sysparam),f=function(e,t,n){var a=s;a[e][t]=n,r("basic_sysparam",a)},p=[{label:"AND",value:"^"},{label:"OR",value:"^OR"}],h=[],d=-1!==s.constructor.toString().indexOf("Array")?t.basic_sysparam.length:0,y=function(e){h.push(Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,0!==e&&Y().createElement(z.InlineField,null,Y().createElement(z.RadioButtonGroup,{options:p,value:void 0!==s[e][4]?s[e][4].value:null,onChange:function(t){return f(e,4,{label:t,value:t})}})),Y().createElement(z.InlineField,{label:0===e?"Sysparam Query":void 0,labelWidth:0===e?20:void 0},Y().createElement(z.Select,{width:40,options:l,value:void 0!==s[e][1]?s[e][1]:null,defaultValue:void 0!==s[e][1]?s[e][1]:null,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return f(e,1,t)},onCreateOption:function(t){return f(e,1,{label:t,value:t})},maxMenuHeight:200})),Y().createElement(z.InlineField,null,Y().createElement(z.Select,{width:20,options:a,value:void 0!==s[e][2]?s[e][2]:null,defaultValue:void 0!==s[e][2]?s[e][2]:null,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return f(e,2,t)},onCreateOption:function(t){return f(e,2,{label:t,value:t})},maxMenuHeight:200})),Y().createElement(z.InlineField,null,Y().createElement(z.AsyncSelect,{width:20,loadOptions:function(t){return o(e,t)},value:void 0!==s[e][3]?s[e][3]:null,defaultValue:void 0!==s[e][3]?s[e][3]:null,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return f(e,3,t)},onCreateOption:function(t){return f(e,3,{label:t,value:t})},maxMenuHeight:200})),e>0&&Y().createElement(z.InlineField,null,Y().createElement(z.ToolbarButton,{icon:"trash-alt",variant:"destructive",iconOnly:!0,onClick:function(){return t=e,(n=s).splice(t,1),void r("basic_sysparam",n);var t,n}}))),e===d-1&&Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,null,Y().createElement(z.ToolbarButton,{icon:"plus",variant:"primary",onClick:function(){return(e=s).push({1:null,2:null,3:null,4:{label:"AND",value:"^"}}),void r("basic_sysparam",e);var e}})))))},v=0;v<d;v++)y(v);return Y().createElement(Y().Fragment,null,h)};function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(){Me=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==qe(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function Ge(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function Re(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ge(o,n,a,i,u,"next",e)}function u(e){Ge(o,n,a,i,u,"throw",e)}i(void 0)}))}}function Qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Be(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var De=function(e){var t=e.query,r=e.updateQuery,n=e.datasource,a=e.table,o=Qe((0,$.useState)([{label:"Loading ...",value:""}]),2),i=o[0],u=o[1];return(0,$.useEffect)((function(){var e=[],r=!1;function o(){return(o=Re(Me().mark((function o(){return Me().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n.snowConnection.getTableColumnOptions(a);case 2:e=o.sent,r||e.length>0&&(t.sortBy&&t.sortBy.length>0&&(e=e.concat(t.sortBy)),u(e));case 4:case"end":return o.stop()}}),o)})))).apply(this,arguments)}return function(){o.apply(this,arguments)}(),function(){r=!0}}),[n.snowConnection,a,t.sortBy]),Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Sort By",labelWidth:20},Y().createElement(z.Select,{width:40,options:i,value:t.sortBy,defaultValue:t.sortBy,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return r("sortBy",e)},onCreateOption:function(e){return r("sortBy",{label:e,value:e})},maxMenuHeight:200,menuPlacement:"top"})),Y().createElement(z.InlineField,null,Y().createElement(z.RadioButtonGroup,{value:t.sortDirection,options:[{label:"ASC",value:"ASC",icon:"arrow-up"},{label:"DESC",value:"DESC",icon:"arrow-down"}],onChange:function(e){return r("sortDirection",e)}}))))};function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(){Ue=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==We(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function He(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function Ke(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){He(o,n,a,i,u,"next",e)}function u(e){He(o,n,a,i,u,"throw",e)}i(void 0)}))}}function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ye(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ze=function(e){var t=e.updateQuery,r=e.trendByOptions,n=e.query,a=e.datasource,o=$e((0,$.useState)([{label:"Loading ...",value:""}]),2),i=o[0],u=o[1];return(0,$.useEffect)((function(){var e=[],t=!1;function r(){return(r=Ke(Ue().mark((function r(){var o;return Ue().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a.snowConnection.getTableColumnOptions(null===(o=n.tableName)||void 0===o?void 0:o.value);case 2:e=r.sent,t||e.length>0&&u(e);case 4:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return function(){r.apply(this,arguments)}(),function(){t=!0}}),[a.snowConnection,n.tableName]),Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Trend",labelWidth:20},Y().createElement(z.Select,{width:40,options:i,value:n.selectedTrendColumn,defaultValue:n.selectedTrendColumn,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return t("selectedTrendColumn",e)},onCreateOption:function(e){return t("selectedTrendColumn",{label:e,value:e})},maxMenuHeight:200})),Y().createElement(z.InlineField,null,Y().createElement(z.Select,{width:20,options:r,value:n.selectedTrendBy,defaultValue:n.selectedTrendBy,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return t("selectedTrendBy",e)},onCreateOption:function(e){return t("selectedTrendBy",{label:e,value:e})},maxMenuHeight:200})),Y().createElement(z.InlineField,null,Y().createElement(z.Input,{name:"period",type:"number",max:300,min:1,width:20,defaultValue:n.trendPeriod,onBlur:function(e){return t("trendPeriod",e.target.value)}}))))},Je=function(e){var t=e.value,r=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Show Uptime %",labelWidth:20},Y().createElement(z.RadioButtonGroup,{options:[{label:"False",value:!1},{label:"True",value:!0}],value:t||!1,onChange:function(e){return r("showPercent",e)}}))))};function Xe(e){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(){Ze=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==Xe(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function et(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function tt(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){et(o,n,a,i,u,"next",e)}function u(e){et(o,n,a,i,u,"throw",e)}i(void 0)}))}}function rt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var at=function(e){var t=e.query,r=e.updateQuery,n=e.datasource,a=e.table,o=rt((0,$.useState)([{label:"Loading ...",value:""}]),2),i=o[0],u=o[1];return(0,$.useEffect)((function(){var e=[],r=!1;function o(){return(o=tt(Ze().mark((function o(){return Ze().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n.snowConnection.getTableColumnOptions(a);case 2:e=o.sent,r||e.length>0&&(t.grafanaTimerangeColumn&&t.grafanaTimerangeColumn.length>0&&(e=e.concat(t.grafanaTimerangeColumn)),u(e));case 4:case"end":return o.stop()}}),o)})))).apply(this,arguments)}return function(){o.apply(this,arguments)}(),function(){r=!0}}),[n.snowConnection,a,t.grafanaTimerangeColumn]),Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Grafana Timerange",labelWidth:20,tooltip:"If selected, only results that fit inbetween your Grafana Timerange will be returned"},Y().createElement(z.InlineSwitch,{value:t.grafanaTimerange,onChange:function(e){return r("grafanaTimerange",e.target.checked)}})),t.grafanaTimerange&&Y().createElement(z.InlineField,null,Y().createElement(z.Select,{options:i,value:t.grafanaTimerangeColumn,defaultValue:t.grafanaTimerangeColumn,width:40,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return r("grafanaTimerangeColumn",e)},onCreateOption:function(e){return r("grafanaTimerangeColumn",{label:e,value:e})},maxMenuHeight:200}))))},ot=function(e){var t=e.value,r=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Compress Logs",labelWidth:20},Y().createElement(z.InlineSwitch,{value:t,onChange:function(e){return r("compressLogs",e.target.checked)}}))))};function it(e){return function(e){if(Array.isArray(e))return ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ut(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ut(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lt=function(e){var t=e.loadOptions,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"CI",labelWidth:20},Y().createElement(z.AsyncSelect,{width:40,value:r,isMulti:!0,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:r,menuPlacement:"bottom",allowCustomValue:!0,loadOptions:t,backspaceRemovesValue:!0,onChange:function(e){return n("selectedSourceList",e)},onCreateOption:function(e){var t=[];void 0!==r?(t=it(r))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedSourceList",t)}}))))};function ct(e){return function(e){if(Array.isArray(e))return st(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return st(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return st(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ft=function(e){var t=e.loadOptions,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Metric Name",labelWidth:20},Y().createElement(z.AsyncSelect,{width:40,value:r,isMulti:!0,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:r,allowCustomValue:!0,className:"coloredSelect",loadOptions:t,backspaceRemovesValue:!0,onChange:function(e){return n("selectedMetricNameList",e)},onCreateOption:function(e){var t=[];void 0!==r?(t=ct(r))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedMetricNameList",t)}}))))},pt=function(e){var t=e.updateQuery,r=e.defaultValue;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Sysparam Query",labelWidth:20},Y().createElement(z.Input,{width:60,name:"sysparam_query",defaultValue:r,onBlur:function(e){return t("sysparam_query",e.target.value)}}))))},ht=function(e){var t=e.loadOptions,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Service",labelWidth:20},Y().createElement(z.AsyncSelect,{width:40,value:r,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:r,defaultOptions:!0,menuPlacement:"bottom",allowCustomValue:!0,loadOptions:t,backspaceRemovesValue:!0,onChange:function(e){return n("selectedServiceList",e)},onCreateOption:function(e){return n("selectedServiceList",{label:e,value:e})}}))))};function dt(e){return function(e){if(Array.isArray(e))return yt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return yt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var vt,mt,gt=function(e){var t=e.loadOptions,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Resource ID",labelWidth:20},Y().createElement(z.AsyncSelect,{width:40,value:r,isMulti:!0,isClearable:!0,isSearchable:!0,maxMenuHeight:200,defaultValue:r,allowCustomValue:!0,loadOptions:t,backspaceRemovesValue:!0,onChange:function(e){return n("selectedMetricTypeList",e)},onCreateOption:function(e){var t=[];void 0!==r?(t=dt(r))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedMetricTypeList",t)}}))))},bt=function(e){var t=e.options,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Alert Type Filter",labelWidth:20},Y().createElement(z.Select,{width:20,value:r,options:t,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:r,onChange:function(e){return n("selectedAlertTypeList",e)}}))))},wt=function(e){var t=e.updateQuery,r=e.defaultValue;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Child Depth",labelWidth:20},Y().createElement(z.Input,{width:20,name:"child_depth",defaultValue:r,onBlur:function(e){return t("topology_child_depth",e.target.value)}}))))},Et=function(e){var t=e.loadTableOptions,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Table Name",labelWidth:20},Y().createElement(z.AsyncSelect,{value:r,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:r,defaultOptions:!0,menuPlacement:"bottom",allowCustomValue:!0,backspaceRemovesValue:!0,prefix:vt||(vt=Y().createElement(z.Icon,{name:"table"})),loadOptions:t,width:40,onChange:function(e){return n("tableName",e)},onCreateOption:function(e){return n("tableName",{label:e,value:e})}}))))},xt=function(e){var t=e.options,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Alert State Filter",labelWidth:20},Y().createElement(z.Select,{width:20,value:r,options:t,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:r,onChange:function(e){return n("selectedAlertStateList",e)}}))))},St=function(e){var t=e.updateQuery,r=e.defaultValue;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Parent Depth",labelWidth:20},Y().createElement(z.Input,{width:20,name:"parent_depth",defaultValue:r,onBlur:function(e){return t("topology_parent_depth",e.target.value)}}))))};function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lt(e){return function(e){if(Array.isArray(e))return It(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||jt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(){_t=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),u=new L(a||[]);return n(i,"_invoke",{value:E(e,r,u)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var y={};l(y,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(_([])));m&&m!==t&&r.call(m,o)&&(y=m);var g=d.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var a;n(this,"_invoke",{value:function(n,o){function i(){return new t((function(a,i){!function n(a,o,i,u){var l=s(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==Ot(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(l.arg)}(n,o,a,i)}))}return a=a?a.then(i,i):i()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return T()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=x(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=s(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=l(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,u,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new w(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),l(g,u,"Generator"),l(g,o,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function Tt(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function Ct(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Tt(o,n,a,i,u,"next",e)}function u(e){Tt(o,n,a,i,u,"throw",e)}i(void 0)}))}}function At(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||jt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(e,t){if(e){if("string"==typeof e)return It(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?It(e,t):void 0}}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ft=function(e){var t=e.query,r=e.updateQuery,n=e.datasource,a=e.table,o=At((0,$.useState)(t.selectedtableColumns),2),i=o[0],u=o[1],l=At((0,$.useState)([{label:"Loading ...",value:""}]),2),c=l[0],s=l[1];return(0,$.useEffect)((function(){var e=[],t=!1;function r(){return(r=Ct(_t().mark((function r(){return _t().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.snowConnection.getTableColumnOptions(a);case 2:e=r.sent,t||e.length>0&&(i&&i.length>0&&(e=e.concat(i)),s(e));case 4:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return function(){r.apply(this,arguments)}(),function(){t=!0}}),[n.snowConnection,a,i]),Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{labelWidth:20,label:"Table Columns",tooltip:"Leave columns blank to return all columns in the dictionary"},Y().createElement(z.Select,{isMulti:!0,options:c,isClearable:!0,maxMenuHeight:200,value:i,isSearchable:!0,menuPlacement:"bottom",allowCustomValue:!0,defaultValue:i,backspaceRemovesValue:!0,prefix:mt||(mt=Y().createElement(z.Icon,{name:"columns"})),width:40,onChange:function(e){u(e),r("selectedtableColumns",e)},onCreateOption:function(e){var t=[];void 0!==i?(t=Lt(i))[t.length]={label:e,value:e}:t=[{label:e,value:e}],u(t),r("selectedtableColumns",t)}}))))},kt=function(e){var t=e.options,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Anomaly",labelWidth:20},Y().createElement(z.Select,{width:20,value:r,options:t,isClearable:!0,maxMenuHeight:200,defaultValue:r,onChange:function(e){return n("selectedMetricAnomalyList",e)}}))))},Pt=function(e){var t=e.loadOptions,r=e.value,n=e.updateQuery;return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Starting Point",labelWidth:20},Y().createElement(z.AsyncSelect,{width:40,value:r,isClearable:!0,isSearchable:!0,maxMenuHeight:200,defaultValue:r,defaultOptions:!0,menuPlacement:"bottom",allowCustomValue:!0,loadOptions:t,backspaceRemovesValue:!0,onCreateOption:function(e){return n("selectedServiceList",{label:e,value:e})},onChange:function(e){return n("selectedServiceList",e)}}))))};function Vt(){return(Vt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Nt;function qt(){return(qt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Mt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Rt=new e.DataSourcePlugin(K).setConfigEditor((function(e){var t=e.options,r=e.onOptionsChange;""===t.url&&(t.url="https://<instance_name>.service-now.com/"),void 0===t.jsonData.apiPath&&(t.jsonData.apiPath="/api/x_opti8_itom_grafa/grafana_api"),void 0===t.jsonData.cacheTimeout&&(t.jsonData.cacheTimeout=60),void 0===t.jsonData.imageURL&&(t.jsonData.imageURL="https://www.servicenow.com/favicon.ico");var n=function(e,n){r(X({},t,{jsonData:X({},t.jsonData,J({},e,n))}))};return Y().createElement(Y().Fragment,null,H||(H=Y().createElement(z.Alert,{title:"Need more information?",severity:"info",elevated:!0},Y().createElement(z.VerticalGroup,null,Y().createElement("p",null,"Local documentation can be found ",Y().createElement("a",{href:"/plugins/optimiz-servicenow-datasource"},"Here")),Y().createElement("p",null,"Or ",Y().createElement("a",{href:"https://github.com/optimizca/servicenow-grafana/blob/main/README.md"},"Click here to view the documentation on GitHub"))))),Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{labelWidth:20,label:"Logo URL",tooltip:"To access this value in each dashboard, create a variable query using namespace: global_image."},Y().createElement(z.Input,{defaultValue:void 0===t.jsonData.imageURL?"":t.jsonData.imageURL,onBlur:function(e){return n("imageURL",e.target.value)},width:60}))),Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{labelWidth:20,label:"API Path"},Y().createElement(z.Input,{defaultValue:void 0===t.jsonData.apiPath?"":t.jsonData.apiPath,onBlur:function(e){return n("apiPath",e.target.value)},width:40}))),Y().createElement(z.DataSourceHttpSettings,{defaultUrl:"https://<instance_name>.service-now.com/",dataSourceConfig:t,showAccessOptions:!0,sigV4AuthToggleEnabled:!1,showForwardOAuthIdentityOption:!1,onChange:function(e){var t="";-1!==e.url.indexOf("https://")?t=e.url.substring(8,e.url.indexOf(".service-now",8)):-1!==e.url.indexOf("http://")&&(t=e.url.substring(7,e.url.indexOf(".service-now",7))),e.jsonData.instanceName=t,r(e)}}))})).setQueryEditor((function(e){var t,r=e.query,o=e.onChange,u=e.datasource,l=(0,a.defaults)(r,i),c=u.snowConnection.getMetricAnomalyOptions(),s=u.snowConnection.getAlertTypeOptions(),f=u.snowConnection.getAlertStateOptions(),p=u.snowConnection.getSysparamTypeOptions(),h=u.snowConnection.getTrendByOptions(),d=function(e){return new Promise((function(t){setTimeout((function(){t(u.snowConnection.loadServiceOptions(e))}),500)}))},y=function(e){return new Promise((function(t){setTimeout((function(){var r;t(u.snowConnection.loadCIOptions(null===(r=l.selectedServiceList)||void 0===r?void 0:r.value,e))}),500)}))},v=function(e,t){return new Promise((function(r){setTimeout((function(){var n,a;r(u.snowConnection.loadColumnChoices(null===(n=l.tableName)||void 0===n?void 0:n.value,null===(a=l.basic_sysparam[e][1])||void 0===a?void 0:a.value,t))}),500)}))},m=function(e){return new Promise((function(t){setTimeout((function(){t(u.snowConnection.loadTableOptions(e))}),500)}))},g=function(e,t){o(Vt({},l,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},e,t)))},b={Table:{title:"Table",description:"Choose your own table to gather data from",content:Y().createElement(Y().Fragment,null,Y().createElement(Et,{updateQuery:g,loadTableOptions:m,value:l.tableName}),Y().createElement(Ft,{query:l,updateQuery:g,datasource:u,table:l.tableName}),Y().createElement(Ne,{query:l,updateQuery:g,datasource:u,sysparamTypeOptions:p,loadChoices:v,table:l.tableName}),Y().createElement(De,{query:l,updateQuery:g,datasource:u,table:l.tableName}),Y().createElement(me,{defaultValue:l.rowLimit,updateQuery:g}),Y().createElement(ge,{defaultValue:l.page,updateQuery:g}),Y().createElement(le,{value:l.getAlertCount,updateQuery:g}),Y().createElement(at,{query:l,updateQuery:g,datasource:u,table:l.tableName}))},Aggregate:{title:"Aggregate",description:"Group by and apply aggregate functions to table data",content:Y().createElement(Y().Fragment,null,Y().createElement(Et,{updateQuery:g,loadTableOptions:m,value:l.tableName}),Y().createElement(ve,{query:l,updateQuery:g,datasource:u}),Y().createElement(Te,{query:l,updateQuery:g,datasource:u}),Y().createElement(pt,{updateQuery:g,defaultValue:l.sysparam_query}),Y().createElement(me,{defaultValue:l.rowLimit,updateQuery:g}),Y().createElement(at,{query:l,updateQuery:g,datasource:u,table:l.tableName}))},Alerts:{title:"Alerts",description:"Get Alerts",content:Y().createElement(Y().Fragment,null,Y().createElement(ht,{loadOptions:d,value:l.selectedServiceList,updateQuery:g}),Y().createElement(lt,{loadOptions:y,value:l.selectedSourceList,updateQuery:g}),Y().createElement(bt,{options:s,value:l.selectedAlertTypeList,updateQuery:g}),Y().createElement(xt,{options:f,value:l.selectedAlertStateList,updateQuery:g}),Y().createElement(pt,{updateQuery:g,defaultValue:l.sysparam_query}),Y().createElement(ue,{query:l,updateQuery:g,datasource:u,replaceMultipleVariables:function(e){if(!e)return"";for(var t,r=e.indexOf("$"),o=function(){var e={};return Object.values((0,n.getTemplateSrv)().getVariables()).forEach((function(t){if("adhoc"!==t.type&&"interval"!==t.type){var r=t,n=r.current.value;if("$__all"===n||(0,a.isEqual)(n,["$__all"]))if(null===r.allValue||""===r.allValue){for(var o="",i=1;i<r.options.length;i++)o+=r.options[i].value+",";","===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),n=o}else n=r.allValue;e[r.id]={text:r.current.text,value:n}}})),e}();-1!==r;){var i=-1===e.indexOf("^",r)?e.length:e.indexOf("^",r),u=e.substring(r,i),l=u,c=("$"===(t=u).charAt(0)&&"{"===(t=t.substring(1)).charAt(0)&&"}"===t.charAt(t.length-1)&&(t=t.substring(1,t.length-1)),t);void 0!==o[c]&&(l=o[c].value),r=(e=e.replace(u,l)).indexOf("$")}return e}}),Y().createElement(De,{query:l,updateQuery:g,datasource:u,table:"em_alert"}),Y().createElement(me,{defaultValue:l.rowLimit,updateQuery:g}),Y().createElement(ge,{defaultValue:l.page,updateQuery:g}),Y().createElement(at,{query:l,updateQuery:g,datasource:u,table:"em_alert"}))},Anomaly:{title:"Anomaly",description:"Parse values out of Alert Anomalies table",content:Y().createElement(Y().Fragment,null,Y().createElement(Ft,{query:l,updateQuery:g,datasource:u,table:"em_alert_anomaly"}),Y().createElement(Ne,{query:l,updateQuery:g,datasource:u,sysparamTypeOptions:p,loadChoices:v,table:"em_alert_anomaly"}),Y().createElement(De,{query:l,updateQuery:g,datasource:u,table:"em_alert_anomaly"}),Y().createElement(me,{defaultValue:l.rowLimit,updateQuery:g}),Y().createElement(ge,{defaultValue:l.page,updateQuery:g}))},Geohash_Map:{title:"GeoHash Map",description:"Get map data from AWS or Azure",content:Y().createElement(Y().Fragment,null,Y().createElement(Et,{updateQuery:g,loadTableOptions:m,value:l.tableName}),Y().createElement(ve,{query:l,updateQuery:g,datasource:u}),Y().createElement(pt,{updateQuery:g,defaultValue:l.sysparam_query}))},Log_Data:{title:"Log Data",description:"Get log data",content:Y().createElement(Y().Fragment,null,Y().createElement(ot,{value:l.compressLogs,updateQuery:g}),Y().createElement(Ne,{query:l,updateQuery:g,datasource:u,sysparamTypeOptions:p,loadChoices:v,table:"sn_occ_log_viewer_parent"}),Y().createElement(ce,{updateQuery:g,defaultValue:l.elasticSearch}),Y().createElement(De,{query:l,updateQuery:g,datasource:u,table:"sn_occ_log_viewer_parent"}),Y().createElement(me,{defaultValue:l.rowLimit,updateQuery:g}),Y().createElement(ge,{defaultValue:l.page,updateQuery:g}))},Metrics:{title:"Metrics",description:"Get Timeseries metrics",content:Y().createElement(Y().Fragment,null,Y().createElement(ht,{loadOptions:d,value:l.selectedServiceList,updateQuery:g}),Y().createElement(lt,{loadOptions:y,value:l.selectedSourceList,updateQuery:g}),Y().createElement(gt,{loadOptions:function(e){return new Promise((function(t){setTimeout((function(){t(u.snowConnection.loadResourceOptions(l.selectedSourceList,e))}),500)}))},value:l.selectedMetricTypeList,updateQuery:g}),Y().createElement(ft,{loadOptions:function(e){return new Promise((function(t){setTimeout((function(){t(u.snowConnection.loadMetricOptions(l.selectedSourceList,e))}),500)}))},value:l.selectedMetricNameList,updateQuery:g}),Y().createElement(kt,{options:c,value:l.selectedMetricAnomalyList,updateQuery:g}),Y().createElement(pt,{updateQuery:g,defaultValue:l.sysparam_query}))},Outage_Status:{title:"Outage Status",description:"Gathers business service status over the last 90 days",content:Y().createElement(Y().Fragment,null,Y().createElement(ht,{loadOptions:d,value:l.selectedServiceList,updateQuery:g}),Y().createElement(Je,{value:l.showPercent,updateQuery:g}),Y().createElement(pt,{updateQuery:g,defaultValue:l.sysparam_query}),Y().createElement(me,{defaultValue:l.rowLimit,updateQuery:g}),Y().createElement(ge,{defaultValue:l.page,updateQuery:g}))},Row_Count:{title:"Row Count",description:"Get row count from query",content:Y().createElement(Y().Fragment,null,Y().createElement(Et,{updateQuery:g,loadTableOptions:m,value:l.tableName}),Y().createElement(pt,{updateQuery:g,defaultValue:l.sysparam_query}),Y().createElement(at,{query:l,updateQuery:g,datasource:u,table:l.tableName}))},Topology:{title:"Topology",description:"Get Topology",content:Y().createElement(Y().Fragment,null,Y().createElement(Pt,{loadOptions:d,value:l.selectedServiceList,updateQuery:g}),Y().createElement(St,{updateQuery:g,defaultValue:l.topology_parent_depth}),Y().createElement(wt,{updateQuery:g,defaultValue:l.topology_child_depth}),Y().createElement(pt,{updateQuery:g,defaultValue:l.sysparam_query}))},Trend_Data:{title:"Trend Data",description:"Get timeseries data based on a time trend",content:Y().createElement(Y().Fragment,null,Y().createElement(Et,{updateQuery:g,loadTableOptions:m,value:l.tableName}),Y().createElement(Ne,{query:l,updateQuery:g,datasource:u,sysparamTypeOptions:p,loadChoices:v,table:l.tableName}),Y().createElement(ce,{updateQuery:g,defaultValue:l.elasticSearch}),Y().createElement(ve,{query:l,updateQuery:g,datasource:u}),Y().createElement(ze,{query:l,updateQuery:g,trendByOptions:h,datasource:u}))}};return Y().createElement(Y().Fragment,null,Y().createElement(z.HorizontalGroup,{justify:"space-between"},Y().createElement(z.InlineFieldRow,{style:{paddingTop:"8px"}},Y().createElement(z.InlineField,{label:"Query Category",labelWidth:20},Y().createElement(z.Select,{width:40,options:function(){var e=[];for(var t in b){var r=b[t];e.push({label:r.title,value:t,description:r.description})}return e}(),value:l.selectedQueryCategory,onChange:function(e){g("selectedQueryCategory",e)},menuPlacement:"bottom",maxMenuHeight:220})))),b[null!==(t=l.selectedQueryCategory.value)&&void 0!==t?t:""].content)})).setVariableQueryEditor((function(e){var t=e.onChange,r=e.query,n=Mt((0,$.useState)(r),2),a=n[0],o=n[1],i=function(){t(a,"".concat(a.rawQuery," (").concat(a.namespace,")"))},u=function(e,t){o(qt({},a,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},e,t)))};return Y().createElement(Y().Fragment,null,Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Namespace",labelWidth:20},Y().createElement(z.Select,{options:[{label:"global_image",value:"global_image"},{label:"global_instance_name",value:"global_instance_name"},{label:"metric_names",value:"metric_names"},{label:"golden_metric_names",value:"golden_metric_names"},{label:"custom_kpis",value:"custom_kpis"},{label:"generic",value:"generic"},{label:"nested_cis",value:"nested_cis"},{label:"nested_classes",value:"nested_classes"},{label:"tagKeys",value:"tagKeys"},{label:"tagValues",value:"tagValues"}],value:a.namespace,onChange:function(e){return u("namespace",e.value)},allowCustomValue:!1,isClearable:!1,isSearchable:!0,onBlur:i,width:30}))),Y().createElement(z.InlineFieldRow,null,Y().createElement(z.InlineField,{label:"Query",labelWidth:20,grow:!0,tooltip:Nt||(Nt=Y().createElement("p",null,"Documentation for variables can be found"," ",Y().createElement("a",{href:"https://github.com/optimizca/servicenow-grafana#variables",rel:"noopener noreferrer",target:"_blank"},"(Here)")))},Y().createElement(z.Input,{name:"rawQuery",onChange:function(e){return u("rawQuery",e.target.value)},onBlur:i,value:a.rawQuery}))))}))})(),c})());
//# sourceMappingURL=module.js.map