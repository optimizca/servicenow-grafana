/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","@grafana/runtime","lodash"],(function(e,t,a,n,r){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=57)}([function(t,a){t.exports=e},function(e,a){e.exports=t},function(e,t){e.exports=a},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,a){var n=a(11),r=a(30),l=a(31),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?r(e):l(e)}},function(e,t,a){var n=a(12),r="object"==typeof self&&self&&self.Object===Object&&self,l=n||r||Function("return this")();e.exports=l},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){e.exports=function(e){return e}},function(e,t,a){var n=a(6),r=a(5);e.exports=function(e){if(!r(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,a){var n=a(7).Symbol;e.exports=n},function(e,t,a){(function(t){var a="object"==typeof t&&t&&t.Object===Object&&t;e.exports=a}).call(this,a(29))},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,a){var n=a(10),r=a(15);e.exports=function(e){return null!=e&&r(e.length)&&!n(e)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var a=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&a.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,a){var n=a(20),r=a(13),l=a(37),i=a(38),o=Object.prototype,u=o.hasOwnProperty,s=n((function(e,t){e=Object(e);var a=-1,n=t.length,s=n>2?t[2]:void 0;for(s&&l(t[0],t[1],s)&&(n=1);++a<n;)for(var c=t[a],p=i(c),d=-1,m=p.length;++d<m;){var v=p[d],f=e[v];(void 0===f||r(f,o[v])&&!u.call(e,v))&&(e[v]=c[v])}return e}));e.exports=s},function(e,t,a){"use strict";function n(){var e=Object.create(null),t=0,a=0,n=0,r=!1;function l(t){n--,delete e[t]}this.put=function(t,a,r,i){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==i&&"function"!=typeof i)throw new Error("Cache timeout callback must be a function");var o=e[t];o?clearTimeout(o.timeout):n++;var u={value:a,expire:r+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){l(t),i&&i(t,a)}.bind(this),r)),e[t]=u,a},this.del=function(t){var a=!0,n=e[t];return n?(clearTimeout(n.timeout),!isNaN(n.expire)&&n.expire<Date.now()&&(a=!1)):a=!1,a&&l(t),a},this.clear=function(){for(var l in e)clearTimeout(e[l].timeout);n=0,e=Object.create(null),r&&(t=0,a=0)},this.get=function(l){var i=e[l];if(void 0!==i){if(isNaN(i.expire)||i.expire>=Date.now())return r&&t++,i.value;r&&a++,n--,delete e[l]}else r&&a++;return null},this.size=function(){return n},this.memsize=function(){var t,a=0;for(t in e)a++;return a},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return a},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var a in e){var n=e[a];t[a]={value:n.value,expire:n.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,a){var n=JSON.parse(t),r=Date.now(),l=a&&a.skipDuplicates;for(var i in n)if(n.hasOwnProperty(i)){if(l)if(e[i])continue;var o=n[i],u=o.expire-r;if(u<=0){this.del(i);continue}u=u>0?u:void 0,this.put(i,o.value,u)}return this.size()}}e.exports=new n,e.exports.Cache=n},function(e,t,a){var n=a(9),r=a(21),l=a(23);e.exports=function(e,t){return l(r(e,t,n),e+"")}},function(e,t,a){var n=a(22),r=Math.max;e.exports=function(e,t,a){return t=r(void 0===t?e.length-1:t,0),function(){for(var l=arguments,i=-1,o=r(l.length-t,0),u=Array(o);++i<o;)u[i]=l[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=l[i];return s[t]=a(u),n(e,this,s)}}},function(e,t){e.exports=function(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}},function(e,t,a){var n=a(24),r=a(36)(n);e.exports=r},function(e,t,a){var n=a(25),r=a(26),l=a(9),i=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:l;e.exports=i},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,a){var n=a(27),r=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=r},function(e,t,a){var n=a(28),r=a(35);e.exports=function(e,t){var a=r(e,t);return n(a)?a:void 0}},function(e,t,a){var n=a(10),r=a(32),l=a(5),i=a(34),o=/^\[object .+?Constructor\]$/,u=Function.prototype,s=Object.prototype,c=u.toString,p=s.hasOwnProperty,d=RegExp("^"+c.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!l(e)||r(e))&&(n(e)?d:o).test(i(e))}},function(e,t){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t,a){var n=a(11),r=Object.prototype,l=r.hasOwnProperty,i=r.toString,o=n?n.toStringTag:void 0;e.exports=function(e){var t=l.call(e,o),a=e[o];try{e[o]=void 0;var n=!0}catch(e){}var r=i.call(e);return n&&(t?e[o]=a:delete e[o]),r}},function(e,t){var a=Object.prototype.toString;e.exports=function(e){return a.call(e)}},function(e,t,a){var n,r=a(33),l=(n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!l&&l in e}},function(e,t,a){var n=a(7)["__core-js_shared__"];e.exports=n},function(e,t){var a=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return a.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var a=Date.now;e.exports=function(e){var t=0,n=0;return function(){var r=a(),l=16-(r-n);if(n=r,l>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,a){var n=a(13),r=a(14),l=a(16),i=a(5);e.exports=function(e,t,a){if(!i(a))return!1;var o=typeof t;return!!("number"==o?r(a)&&l(t,a.length):"string"==o&&t in a)&&n(a[t],e)}},function(e,t,a){var n=a(39),r=a(50),l=a(14);e.exports=function(e){return l(e)?n(e,!0):r(e)}},function(e,t,a){var n=a(40),r=a(41),l=a(43),i=a(44),o=a(16),u=a(46),s=Object.prototype.hasOwnProperty;e.exports=function(e,t){var a=l(e),c=!a&&r(e),p=!a&&!c&&i(e),d=!a&&!c&&!p&&u(e),m=a||c||p||d,v=m?n(e.length,String):[],f=v.length;for(var y in e)!t&&!s.call(e,y)||m&&("length"==y||p&&("offset"==y||"parent"==y)||d&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||o(y,f))||v.push(y);return v}},function(e,t){e.exports=function(e,t){for(var a=-1,n=Array(e);++a<e;)n[a]=t(a);return n}},function(e,t,a){var n=a(42),r=a(8),l=Object.prototype,i=l.hasOwnProperty,o=l.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(e){return r(e)&&i.call(e,"callee")&&!o.call(e,"callee")};e.exports=u},function(e,t,a){var n=a(6),r=a(8);e.exports=function(e){return r(e)&&"[object Arguments]"==n(e)}},function(e,t){var a=Array.isArray;e.exports=a},function(e,t,a){(function(e){var n=a(7),r=a(45),l=t&&!t.nodeType&&t,i=l&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===l?n.Buffer:void 0,u=(o?o.isBuffer:void 0)||r;e.exports=u}).call(this,a(17)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,a){var n=a(47),r=a(48),l=a(49),i=l&&l.isTypedArray,o=i?r(i):n;e.exports=o},function(e,t,a){var n=a(6),r=a(15),l=a(8),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return l(e)&&r(e.length)&&!!i[n(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,a){(function(e){var n=a(12),r=t&&!t.nodeType&&t,l=r&&"object"==typeof e&&e&&!e.nodeType&&e,i=l&&l.exports===r&&n.process,o=function(){try{var e=l&&l.require&&l.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o}).call(this,a(17)(e))},function(e,t,a){var n=a(5),r=a(51),l=a(52),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return l(e);var t=r(e),a=[];for(var o in e)("constructor"!=o||!t&&i.call(e,o))&&a.push(o);return a}},function(e,t){var a=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||a)}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var a in Object(e))t.push(a);return t}},function(e,t,a){var n=a(54),r=a(55);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var l={insert:"head",singleton:!1},i=(n(r,l),r.locals?r.locals:{});e.exports=i},function(e,t,a){"use strict";var n,r=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},l=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),i=[];function o(e){for(var t=-1,a=0;a<i.length;a++)if(i[a].identifier===e){t=a;break}return t}function u(e,t){for(var a={},n=[],r=0;r<e.length;r++){var l=e[r],u=t.base?l[0]+t.base:l[0],s=a[u]||0,c="".concat(u," ").concat(s);a[u]=s+1;var p=o(c),d={css:l[1],media:l[2],sourceMap:l[3]};-1!==p?(i[p].references++,i[p].updater(d)):i.push({identifier:c,updater:y(d,t),references:1}),n.push(c)}return n}function s(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var r=a.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var i=l(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var c,p=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,a,n){var r=a?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=p(t,r);else{var l=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(l,i[t]):e.appendChild(l)}}function m(e,t,a){var n=a.css,r=a.media,l=a.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),l&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var v=null,f=0;function y(e,t){var a,n,r;if(t.singleton){var l=f++;a=v||(v=s(t)),n=d.bind(null,a,l,!1),r=d.bind(null,a,l,!0)}else a=s(t),n=m.bind(null,a,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var a=u(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<a.length;n++){var r=o(a[n]);i[r].references--}for(var l=u(e,t),s=0;s<a.length;s++){var c=o(a[s]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}a=l}}}},function(e,t,a){(t=a(56)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"QueryEditorStyles.css"}]),e.exports=t},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",n=e[3];if(!n)return a;if(t&&"function"==typeof btoa){var r=(i=n,o=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(u," */")),l=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[a].concat(l).concat([r]).join("\n")}var i,o,u;return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(n)for(var l=0;l<this.length;l++){var i=this[l][0];null!=i&&(r[i]=!0)}for(var o=0;o<e.length;o++){var u=[].concat(e[o]);n&&r[u[0]]||(a&&(u[2]?u[2]="".concat(a," and ").concat(u[2]):u[2]=a),t.push(u))}},t}},function(e,t,a){"use strict";a.r(t);var n=a(2),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(e,t)};var l=function(){return(l=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function i(e,t,a,n){return new(a||(a=Promise))((function(r,l){function i(e){try{u(n.next(e))}catch(e){l(e)}}function o(e){try{u(n.throw(e))}catch(e){l(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,o)}u((n=n.apply(e,t||[])).next())}))}function o(e,t){var a,n,r,l,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function o(l){return function(o){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,o])}}}Object.create;function u(e,t){var a="function"==typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,r,l=a.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=l.next()).done;)i.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return i}function s(e,t,a){if(a||2===arguments.length)for(var n,r=0,l=t.length;r<l;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}Object.create;var c=a(18),p=a.n(c),d=a(3),m=a(4),v=a.n(m),f={selectedQueryCategory:{label:"Metrics",value:"Metrics",description:"Get Timeseries metrics."},basic_sysparam:[{1:null,2:null,3:null,4:null}]},y=a(19),h=a.n(y),g=["sys_created_on","created_on","last_event_time","sys_updated_on","time","start_time","end_time","Updated"];function b(e,t){var a=Object(d.getTemplateSrv)().replace(e,t,"csv"),n=a.indexOf(",");if(n>=0){for(;n>=0;)n=(a=a.replace(",","|")).indexOf(",");a="("+a+")"}return a.startsWith("(")&&a.endsWith(")")?"/"+a+"/":a}function C(e,t){return Object(d.getTemplateSrv)().replace(e,t,"csv")}function E(e,t,a,r,l){var i,o={name:n.TIME_SERIES_TIME_FIELD_NAME,type:n.FieldType.time,config:{custom:{}},values:new n.ArrayVector(e.map((function(e){return e[1]})))};i=(n.FieldType.string,new n.ArrayVector(e.map((function(e){return e[0]}))));var u=[o,{name:n.TIME_SERIES_VALUE_FIELD_NAME,type:null!=l?l:n.FieldType.number,labels:{},config:{displayName:t,custom:{}},values:i}];return{name:t,refId:a.refId,fields:u,length:e.length}}function T(e){1}function O(e){return")"===e.charAt(e.length-2)&&"("===e.charAt(1)&&(e=e.charAt(0)+e.slice(2,-2)+e.charAt(e.length-1)),e}function w(e){var t="";if(1===e.length)return e[0];if("string"==typeof e)return e;for(var a=0;a<e.length;a++)t+="|"+e[a];return"|"===t.charAt(0)&&(t="/"+(t=t.substring(1,t.length))+"/"),t}var S,_=a(4),V=(S=_)&&S.__esModule?S:{default:S};var A=function(){function e(e,t,a){this.requestOptions={headers:e,withCredentials:t,url:a},this.cache=new h.a.Cache}return e.prototype.cachedGet=function(e,t,a,n,r,l,s){return i(this,void 0,void 0,(function(){var t,r,i,c,p=this;return o(this,(function(o){return e?(t=this.requestOptions.url+a,r=t+="/body/"+l,n&&Object.keys(n).length>0&&(t=t+(t.search(/\?/)>=0?"&":"?")+n.map((function(e){var t=u(e,2),a=t[0],n=t[1];return encodeURIComponent(a)+"="+encodeURIComponent(n)})).join("&")),this.lastCacheDuration!==e&&this.cache.del(t),this.lastCacheDuration=e,(i=this.cache.get(t))||this.cache.keys().map((function(e){if(e.includes(r)){var a=e.substring(e.indexOf("?")+1,e.length),n=(a=a.split("&"))[0].substring(a[0].indexOf("=")+1,a[0].length),l=a[1].substring(a[1].indexOf("=")+1,a[1].length),o=t.substring(t.indexOf("?")+1,t.length),u=(o=o.split("&"))[0].substring(o[0].indexOf("=")+1,o[0].length),s=o[1].substring(o[1].indexOf("=")+1,o[1].length);n-u<=6e4&&l-s<=6e4&&(i=p.cache.get(e))}})),i?[2,Promise.resolve(i)]:(c=Object(d.getBackendSrv)().datasourceRequest(s),this.cache.put(t,c,1e3*e),[2,c])):[2,Object(d.getBackendSrv)().datasourceRequest(s)]}))}))},e.prototype.request=function(e){e.withCredentials=this.requestOptions.withCredentials,e.headers=this.requestOptions.headers;var t=e.url;e.url=this.requestOptions.url+t;var a=t.indexOf("?");-1===a&&(a=t.length);var n=t.substring(0,a),r=[];-1!==e.url.indexOf("?")&&e.url.substring(e.url.indexOf("?")+1,e.url.length).split("&").map((function(e){var t=[e.substring(0,e.indexOf("=")),e.substring(e.indexOf("=")+1,e.length)];r.push(t)}));return this.cachedGet(60,e.method,n,r,e.headers,e.data,e)},e.prototype.mapChecksToValue=function(e){return V.default.map(e.data,(function(e,t){if(void 0!==e.name&&void 0!==e.id)return{text:e.name,value:e.id};var a=Object.keys(e);return{label:e[a[0]],value:a[1]?e[a[1]]:e[a[0]]}}))},e.prototype.mapChecksToValuePlusSuffix=function(e){return V.default.map(e.data,(function(e,t){var a=Object.keys(e);return{label:e[a[0]],value:a[1]?e[a[1]]:e[a[0]],suffix:e[a[2]]}}))},e.prototype.mapValueSuffixToColumns=function(e){var t=V.default.map(e,(function(e,t){return{label:e.label+":display",value:e.value+":d"}})),a=V.default.map(e,(function(e,t){return{label:e.label+":value",value:e.value+":v"}})),n=t.concat(a);return n=v.a.orderBy(n,["label"],["asc"])},e.prototype.mapValueAsSuffix=function(e){var t=V.default.map(e,(function(e){var t={label:e.label,value:e.value,description:e.value};return void 0!==e.options&&(t.options=V.default.map(e.options,(function(e){return{label:e.label,value:e.value,description:e.value}})),t.options=v.a.orderBy(t.options,["label"],["asc"])),t}));return t=v.a.orderBy(t,["label"],["asc"])},e.prototype.mapSuffixToLabel=function(e){return V.default.map(e,(function(e){return{label:e.label+" ("+e.suffix+")",value:e.value}}))},e.prototype.appendInstanceNameToResponse=function(e,t){return e.data=V.default.map(e.data,(function(e,a){return e.instanceName=t,e})),e},e.prototype.mapToTextValue=function(e){return V.default.map(e.data,(function(e,t){return e&&e.text&&e.value?{text:e.text,value:e.value}:V.default.isObject(e)?{text:e,value:t}:{text:e,value:e}}))},e.prototype.mapOutageResponseToFrame=function(e,t){return e.data.map((function(e){var a=e.ci;return E(e.datapoints,a,t,0,n.FieldType.string)}))},e.prototype.mapTrendResponseToFrame=function(e,t){return e.data.map((function(e){return E(e.datapoints,"",t,0,n.FieldType.number)}))},e.prototype.mapMetricsResponseToFrame=function(e,t){return e.data.map((function(e){var a=e.source+":"+e.metricName;return e.type.length>0&&(a+=":"+e.type),E(e.datapoints,a,t,0,n.FieldType.number)}))},e.prototype.mapAnamMetricsResponseToFrame=function(e,t,a){return e.data.map((function(e){var r=b(t.source,a.scopedVars),l=b(t.metricType,a.scopedVars),i=r+":"+b(t.metricName,a.scopedVars)+":"+l+":"+e.type;return"UPPER"!==e.type&&"LOWER"!==e.type||(i=e.type),function(e,t,a,r,l){var i,o={name:n.TIME_SERIES_TIME_FIELD_NAME,type:n.FieldType.time,config:{custom:{}},values:new n.ArrayVector(e.map((function(e){return e.x})))};i=(n.FieldType.string,new n.ArrayVector(e.map((function(e){return e.y}))));var u=[o,{name:n.TIME_SERIES_VALUE_FIELD_NAME,type:null!=l?l:n.FieldType.number,labels:{},config:{displayName:t,custom:{}},values:i}];return{name:t,refId:a.refId,fields:u,length:e.length}}(e.data,i,t,0,n.FieldType.number)}))},e.prototype.mapTextResponseToFrame=function(e){var t=new n.MutableDataFrame({fields:[]});if(T(),!(e.data.length>0))return[];for(var a,r,l=Object.keys(e.data[0]),i=0;i<l.length;i++){var o=e.data.map((function(e){return e[l[i]]}));"new"!==l[i]&&"value:display"!==l[i]||(o=this.sanitizeValues(o));var u=n.FieldType.string;o.length>=0&&(a=o[0],r=l[i],u=g.includes(r)?n.FieldType.time:"number"==typeof a?n.FieldType.number:n.FieldType.string),t.addField({name:l[i],type:u,values:o})}return T(),t},e.prototype.sanitizeValues=function(e){var t=[];return e.map((function(e){for(;-1!==e.indexOf("[code]");){var a=e.substring(0,e.indexOf("[code]")),n=e.substring(e.indexOf("[/code]")+7,e.length);if(-1!==e.indexOf("<a")){var r=e.substring(e.indexOf("<a"),e.indexOf("</a>",e.indexOf("<a"))),l=r.substring(r.indexOf(">")+1,r.length);-1!==l.indexOf("<")&&(l=l.substring(0,l.indexOf("<"))),e=a+l+n}else e=a+n}t.push(e)})),t},e}();function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var x=function(){function e(e){var t=e.basicAuth,a=e.withCredentials,n=e.url;this.apiPath="";var r={"Content-Type":"application/json"};"string"==typeof t&&t.length>0&&(r.Authorization=t),this.apiClient=new A(r,a,n)}return e.prototype.getLiveACCData=function(e,t){void 0!==e.live_osquery&&C(e.live_osquery,t.scopedVars);return this.apiClient.mapTextResponseToFrame({data:[{mem_in_megs:"740.39",name:"nscd",pid:"689"},{mem_in_megs:"333.76",name:"rsyslogd",pid:"29468"},{mem_in_megs:"125.67",name:"acc",pid:"30448"},{mem_in_megs:"109.54",name:"lvmetad",pid:"13729"},{mem_in_megs:"78.15",name:"xenstore-watch",pid:"707"}]})},e.prototype.getNestedCIS=function(e){var t='{"targets":[{"ci": "'+e.ci+'",\n      "parentDepth":"'+e.parentDepth+'",\n      "childDepth":"'+e.childDepth+'",\n      "sysparm":"'+e.sysparam+'",\n      "type":"ci"}]}';return this.apiClient.request({url:this.apiPath+"/v1/variable/nested_value",data:t,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getNestedClasses=function(e){var t='{"targets":[{"ci": "'+e.ci+'",\n      "parentDepth":"'+e.parentDepth+'",\n      "childDepth":"'+e.childDepth+'",\n      "sysparm":"'+e.sysparam+'",\n      "type":"class"}]}';return this.apiClient.request({url:this.apiPath+"/v1/variable/nested_value",data:t,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getGenericVariable=function(e,t,a,n){var r=this,l='{"targets":[{"tableName":"'+e+'","nameColumn":"'+t+'","idColumn":"'+a+'","sysparm":"'+n+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/variable/generic",data:l,method:"POST"}).then((function(e){return T(),r.apiClient.mapChecksToValue(e)}))},e.prototype.getMetrics=function(e,t,a,n){var r=this;var l=!1,i="",o=[],u="",s=[],c="",p="";if(void 0!==e.selectedSourceList){var d=[];e.selectedSourceList.map((function(e){d.push(b(e.value,n.scopedVars))})),i=w(d)}void 0!==e.selectedMetricTypeList&&(e.selectedMetricTypeList.map((function(e){o.push(b(e.value,n.scopedVars))})),u=w(o)),void 0!==e.selectedMetricNameList&&(e.selectedMetricNameList.length>0?(e.selectedMetricNameList.map((function(e){s.push(b(e.value,n.scopedVars))})),c=w(s)):c=b(e.selectedMetricNameList.value,n.scopedVars)),void 0!==e.selectedMetricAnomalyList&&"true"===b(e.selectedMetricAnomalyList.value,n.scopedVars)&&(l=!0),void 0!==e.sysparam_query&&(p=C(e.sysparam_query,n.scopedVars)),c=O(c);var m='{"targets":[{"target":"'+(i=O(i))+'","resourceName":"'+u+'","metricName":"'+c+'","sysparm_query":"'+p+'"}]}',v=this.apiPath+"/v1/query/single_metric?startTime="+t+"&endTime="+a;return"*"===c&&(v=this.apiPath+"/v1/query/all_metrics?startTime="+t+"&endTime="+a),!0===l&&(v=this.apiPath+"/v1/query/anomaly_metrics?startTime="+t+"&endTime="+a),this.apiClient.request({url:v,data:m,method:"POST"}).then((function(t){return!0===l?r.apiClient.mapAnamMetricsResponseToFrame(t,e,n):r.apiClient.mapMetricsResponseToFrame(t,e)}))},e.prototype.getTextFrames=function(e,t,a,n,r,l){return"Alerts"===r?this.getAlerts(e,t,a,n,l):"Changes"===r?this.getChanges(e,t,a,n):"CI_Summary"===r?this.getCISummary(e,n):"Agents"===r?this.getAllACCAgents(e,t,a,n):"Admin"===r?"Metrics Definition"===e.selectedAdminCategoryList.value?this.getMetricsDefinition(e,t,a,n):[]:"Table"===r?this.queryTable(e,t,a,n):[]},e.prototype.getGeohashMap=function(e,t){var a=this,n="",r="",l="";void 0!==e.tableName&&""!==e.tableName.value&&(n=b(e.tableName.value,t.scopedVars)),void 0!==e.groupBy&&""!==e.groupBy&&(r=e.groupBy),void 0!==e.sysparam_query&&""!==e.sysparam_query&&(l=C(e.sysparam_query,t.scopedVars));var i='{"targets":[{"target":"'+n+'","column":"'+r+'","sysparm":"'+l+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/geohash_map",data:i,method:"POST"}).then((function(e){return T(),T(),a.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getAggregateQuery=function(e,t){var a=this,n="",r="",l="",i="",o="";void 0!==e.tableName&&""!==e.tableName.value&&(n=b(e.tableName.value,t.scopedVars)),void 0!==e.groupBy&&""!==e.groupBy&&(r=e.groupBy),void 0!==e.selectedAggregateType&&""!==e.selectedAggregateType.value&&(l=e.selectedAggregateType.value),void 0!==e.aggregateColumn&&""!==e.aggregateColumn&&(i=e.aggregateColumn),void 0!==e.sysparam_query&&""!==e.sysparam_query&&(o=C(e.sysparam_query,t.scopedVars));var u='{"targets":[{"target":"'+n+'","type":"'+l+'","column":"'+i+'","groupBy":"'+r+'","sysparm":"'+o+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/aggregate",data:u,method:"POST"}).then((function(e){return T(),T(),a.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getRowCount=function(e,t){var a=this,n="";void 0!==e.tableName&&""!==e.tableName.value&&(n=b(e.tableName.value,t.scopedVars));var r="";void 0!==e.sysparam_query&&""!==e.sysparam_query&&(r=C(e.sysparam_query,t.scopedVars));var l='{"targets":[{"target":"'+n+'","sysparm":"'+r+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/row_count",data:l,method:"POST"}).then((function(e){return T(),T(),a.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getTrendData=function(e,t,a,n){var r=this;var l="",i="",o="",u="",s="",c=1;if(void 0!==e.tableName&&""!==e.tableName.value&&(l=b(e.tableName.value,n.scopedVars)),-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var p=0;p<e.basic_sysparam.length;p++){var d=e.basic_sysparam[p],m="";null!==d[1]&&(m=C(d[1].value,n.scopedVars));var v="";null!==d[2]&&(v=d[2].value);var f="";null!==d[3]&&(f=C(d[3].value,n.scopedVars));var y="";null!==d[4]&&(y=d[4].value),i+=y+m+v+f}void 0!==e.elasticSearch&&(o=C(e.elasticSearch,n.scopedVars)),void 0!==e.selectedTrendColumn&&null!==e.selectedTrendColumn&&(u=C(e.selectedTrendColumn.value,n.scopedVars)),void 0!==e.selectedTrendBy&&null!==e.selectedTrendBy&&(s=C(e.selectedTrendBy.value,n.scopedVars)),void 0!==e.trendPeriod&&e.trendPeriod>0&&(c=e.trendPeriod);var h='{"targets":[{"target":"'+l+'","sysparm":"'+i+'","esSearch":"'+o+'","trendColumn":"'+u+'","trendBy":"'+s+'","period":'+c+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/trend?startTime="+t+"&endTime="+a,data:h,method:"POST"}).then((function(t){return T(),T(),r.apiClient.mapTrendResponseToFrame(t,e)}))},e.prototype.queryLogData=function(e,t,a,n){var r=this,l="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var i=0;i<e.basic_sysparam.length;i++){var o=e.basic_sysparam[i],u="";null!==o[1]&&(u=C(o[1].value,n.scopedVars));var s="";null!==o[2]&&(s=o[2].value);var c="";null!==o[3]&&(c=C(o[3].value,n.scopedVars));var p="";null!==o[4]&&(p=o[4].value),l+=p+u+s+c}var d=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(d=e.rowLimit);var m=0;"number"==typeof e.page&&e.page>=0&&(m=e.page);var v="";void 0!==e.sortBy&&null!==e.sortBy&&(v=C(e.sortBy.value,n.scopedVars));var f="";void 0!==e.elasticSearch&&(f=C(e.elasticSearch,n.scopedVars));var y='{"targets":[{"sysparm":"'+l+'","limit":'+d+',"page":'+m+',"sortBy":"'+v+'","esSearch":"'+f+'","startTime":'+t+',"endTime":'+a+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/logs",data:y,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getAnomaly=function(e,t,a,n){var r=this;var l="";void 0!==e.selectedtableColumns&&e.selectedtableColumns.length>0&&(e.selectedtableColumns.map((function(e){l+=b(e.value,n.scopedVars)+","})),","===l.charAt(l.length-1)&&(l=l.substring(0,l.length-1)));var i="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var o=0;o<e.basic_sysparam.length;o++){var u=e.basic_sysparam[o],s="";null!==u[1]&&(s=C(u[1].value,n.scopedVars));var c="";null!==u[2]&&(c=u[2].value);var p="";null!==u[3]&&(p=C(u[3].value,n.scopedVars));var d="";null!==u[4]&&(d=u[4].value),i+=d+s+c+p}var m=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(m=e.rowLimit);var v=0;"number"==typeof e.page&&e.page>=0&&(v=e.page);var f="";void 0!==e.sortBy&&null!==e.sortBy&&(f=C(e.sortBy.value,n.scopedVars));var y='{"targets":[{"columns":"'+l+'","sysparm":"'+i+'","limit":'+m+',"page":'+v+',"sortBy":"'+f+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/anomaly",data:y,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.queryTable=function(e,t,a,n){var r=this;var l="";void 0!==e.tableName&&""!==e.tableName.value&&(l=b(e.tableName.value,n.scopedVars));var i="";void 0!==e.selectedtableColumns&&e.selectedtableColumns.length>0&&(e.selectedtableColumns.map((function(e){i+=b(e.value,n.scopedVars)+","})),","===i.charAt(i.length-1)&&(i=i.substring(0,i.length-1)));var o="";if(-1!==e.basic_sysparam.constructor.toString().indexOf("Array"))for(var u=0;u<e.basic_sysparam.length;u++){var s=e.basic_sysparam[u],c="";null!==s[1]&&(c=C(s[1].value,n.scopedVars));var p="";null!==s[2]&&(p=s[2].value);var d="";null!==s[3]&&(d=C(s[3].value,n.scopedVars));var m="";null!==s[4]&&(m=s[4].value),o+=m+c+p+d}var v=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(v=e.rowLimit);var f=0;"number"==typeof e.page&&e.page>=0&&(f=e.page);var y="";void 0!==e.sortBy&&null!==e.sortBy&&(y=C(e.sortBy.value,n.scopedVars));var h='{"targets":[{"target":"'+l+'","columns":"'+i+'","sysparm":"'+o+'","limit":'+v+',"page":'+f+',"sortBy":"'+y+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:h,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getOutageStatus=function(e,t){var a=this,n="";void 0!==e.selectedServiceList&&null!==e.selectedServiceList.value&&(n=C(e.selectedServiceList.value,t.scopedVars));var r=!1;"boolean"==typeof e.showPercent&&(r=e.showPercent);var l="";void 0!==e.sysparam_query&&(l=C(e.sysparam_query,t.scopedVars));var i=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(i=e.rowLimit);var o=0;"number"==typeof e.page&&e.page>=0&&(o=e.page);var u='{"targets":[{"target":"'+n+'","showPercent":'+r+',"sysparm":"'+l+'","limit":'+i+',"page":'+o+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/outage",data:u,method:"POST"}).then((function(t){return T(),T(),r?a.apiClient.mapTextResponseToFrame(t):a.apiClient.mapOutageResponseToFrame(t,e)}))},e.prototype.getTopologyFrame=function(e,t,a,n){return this.getTopology(e,t,a,n).then((function(t){var a=[{columns:[{text:"type"},{type:"time",text:"Time"},{text:"app"},{text:"target_app"},{text:"req_rate"},{text:"error_rate"}],rows:t,refId:e.refId||void 0,meta:void 0}];return T(),{data:a}}))},e.prototype.getTopology=function(e,t,a,n){var r=b(e.service,n.scopedVars);void 0!==e.selectedServiceList&&(r=C(e.selectedServiceList.value,n.scopedVars));var l="";void 0!==e.topology_child_depth&&(l=b(e.topology_child_depth,n.scopedVars));var i="";void 0!==e.topology_parent_depth&&(i=b(e.topology_parent_depth,n.scopedVars));var o="";void 0!==e.topology_filter&&e.topology_filter&&(o=C(e.topology_filter,n.scopedVars));var u="";void 0!==e.topology_namespaces&&e.topology_namespaces&&(u=C(e.topology_namespaces,n.scopedVars));var s="";void 0!==e.sysparam_query&&""!==e.sysparam_query&&(s=C(e.sysparam_query,n.scopedVars));var c="";void 0!==e.selectedTopologyDependsOnFilter&&(c=b(e.selectedTopologyDependsOnFilter.value,n.scopedVars));var p='{"targets":[{"target":"'+r+'","child_depth":"'+l+'","parent_depth":"'+i+'","exclude_classes":"'+o+'","sysparm_query":"'+s+'","namespaces":"'+u+'","dependsOn":"'+c+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/topology",data:p,method:"POST"}).then((function(e){return T(),T(),T(),T(e.data),T(),e.data.rows}))},e.prototype.loadServiceOptions=function(e){var t=this,a="";void 0!==e&&(a=e);var n='{"targets":[{"target":"cmdb_ci_service","columns":"name:d,sys_id:v","sysparm":"operational_status=1^name!=All^nameLIKE'+a+'","limit":100,"sortBy":"name"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){return T(),T(),T(t.apiClient.mapChecksToValue(e)),t.apiClient.mapChecksToValue(e)}))},e.prototype.loadCIOptions=function(e,t){var a=this,n="";void 0!==t&&(n=t);var r="";return r=void 0!==e?'{"targets":[{"target":"em_impact_graph","columns":"child_name:d,child_id:v,child_id:d","sysparm":"business_service='+e+"^child_nameLIKE"+n+'","limit":100,"sortBy":"ci_name"}]}':'{"targets":[{"target":"cmdb_ci","columns":"name:d,sys_id:v,sys_class_name:d","sysparm":"nameLIKE'+n+'^name!=NULL","limit":100,"sortBy":"cmdb_ci.name"}]}',this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){T(),T();var t=a.apiClient.mapChecksToValuePlusSuffix(e);return T(),a.apiClient.mapSuffixToLabel(t)}))},e.prototype.loadResourceOptions=function(e,t){var a=this,n="",r="";(void 0!==t&&(r=t),void 0!==e)&&(n='{"targets":[{"target":"sa_metric_map","columns":"resource_id:d,resource_id:v","sysparm":"cmdb_ciIN'+e.map((function(e){return e.value}))+"^resource_idLIKE"+r+'^resource_id!=NULL","limit":100,"sortBy":"resource_id"}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){T(),T();var t=[{label:"*",value:"*"}].concat(a.apiClient.mapChecksToValue(e));return t=t.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))}))}))},e.prototype.loadMetricOptions=function(e,t){var a=this,n="",r="";(void 0!==t&&(r=t),void 0!==e)&&(n='{"targets":[{"target":"sa_metric_map","columns":"metric_type_id.metric_type_tiny_name:d,metric_type_id:v","sysparm":"cmdb_ciIN'+e.map((function(e){return e.value}))+"^metric_type_id.metric_type_tiny_nameLIKE"+r+'","limit":100,"sortBy":""}]}');return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:n,method:"POST"}).then((function(e){T(),T();var t=[{label:"*",value:"*"}].concat(a.apiClient.mapChecksToValue(e));return t=t.filter((function(e,t,a){return t===a.findIndex((function(t){return t.value===e.value}))}))}))},e.prototype.loadColumnChoices=function(e,t,a){var n=this,r='{"targets":[{"target":"sys_choice","columns":"label,value","sysparm":"name='+e+"^element!=NULL^elementLIKE"+t+"^labelLIKE"+a+'","limit":100}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:r,method:"POST"}).then((function(e){return T(),T(),T(n.apiClient.mapChecksToValue(e)),n.apiClient.mapChecksToValue(e)}))},e.prototype.loadTableColumns=function(e,t,a){var n=this,r="";if("string"==typeof a&&(r=a.trim()),void 0===e)return[];var l='{"targets":[{"table":"'+e+'","search":"'+r+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/select/table_columns",data:l,method:"POST"}).then((function(e){return T(),T(e.data),n.apiClient.mapValueAsSuffix(e.data)}))},e.prototype.loadTableOptions=function(e){var t=this,a='{"targets":[{"target":"sys_db_object","columns":"label,name","sysparm":"nameLIKE'+e+"^ORlabelLIKE"+e+'","limit":100}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/table",data:a,method:"POST"}).then((function(e){T(),T();var a=t.apiClient.mapChecksToValue(e);return T(),t.apiClient.mapValueAsSuffix(a)}))},e.prototype.getMetricsDefinition=function(e,t,a,n){var r=this;var l='{"targets":[{"target":"'+C(e.sysparam_query,n.scopedVars)+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/metric_mapping",data:l,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getMetricNamesInCIs=function(e,t){var a=w(t),n='{"targets":[{"target":"'+(a=O(a))+'","metricType":"'+e+'"}]}',r=this.apiPath+"/v1/variable/metrics";return this.apiClient.request({url:r,data:n,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getAlerts=function(e,t,a,n,r){var l=this;var i="";void 0!==e.selectedServiceList&&(i=C(e.selectedServiceList.value,n.scopedVars));var o="";void 0!==e.selectedSourceList&&(o=C(e.selectedSourceList.value,n.scopedVars));var u=i,s="Active",c="service",p="";void 0!==e.selectedAlertStateList&&(s=e.selectedAlertStateList.value),e.selectedAlertTypeList&&("CI"===e.selectedAlertTypeList.value?(c="ci",u=o):"OS"===e.selectedAlertTypeList.value?(c="os",-1!==(u=o).indexOf("(")&&(u=u.substring(u.indexOf("(")+1,u.indexOf(")")))):"None"===e.selectedAlertTypeList.value&&(c="none")),void 0!==e.sysparam_query&&e.sysparam_query&&(p=C(e.sysparam_query,n.scopedVars));var d=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(d=e.rowLimit);var m=0;"number"==typeof e.page&&e.page>=0&&(m=e.page);var v='{"targets":[{"target":"'+u+'","sysparm_query":"'+p+'","alertType":"'+c+'","alertState":"'+s+'","limit":'+d+',"page":'+m+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/alerts",data:v,method:"POST"}).then((function(e){return T(),T(),e=l.apiClient.appendInstanceNameToResponse(e,r),T(),l.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getChanges=function(e,t,a,n){var r=this;var l="";void 0!==e.selectedServiceList&&null!==e.selectedServiceList&&e.selectedServiceList.length>0&&(l=C(e.selectedServiceList.value,n.scopedVars));var i="";void 0!==e.selectedSourceList&&null!==e.selectedSourceList&&e.selectedSourceList.length>0&&(i=C(e.selectedSourceList.value,n.scopedVars));var o=l,u="service";void 0!==e.selectedChangeTypeList&&("CI"===e.selectedChangeTypeList.value?(u="ci",o=i):"None"===e.selectedChangeTypeList.value&&(u="none",o=""));var s="";void 0!==e.sysparam_query&&e.sysparam_query&&(s=C(e.sysparam_query,n.scopedVars));var c=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(c=e.rowLimit);var p=0;"number"==typeof e.page&&e.page>=0&&(p=e.page);var d='{"targets":[{"target":"'+o+'","sysparm_query":"'+s+'","alertType":"'+u+'","limit":'+c+',"page":'+p+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/changes",data:d,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getAllACCAgents=function(e,t,a,n){var r=this;var l="",i=[],o="",u="",s="";void 0!==e.selectedAgentFilter&&e.selectedAgentFilter.value&&(l=b(e.selectedAgentFilter.value,n.scopedVars)),void 0!==e.selectedMetricNameList&&(e.selectedMetricNameList.map((function(e){i.push(b(e.value,n.scopedVars))})),o=w(i)),F(e.sysparam_query)&&e.sysparam_query&&(u=C(e.sysparam_query,n.scopedVars)),void 0!==e.selectedAgentFilterType&&e.selectedAgentFilterType&&(s=e.selectedAgentFilterType.value.toLowerCase());var c=9999;void 0!==e.rowLimit&&e.rowLimit>0&&e.rowLimit<1e4&&(c=e.rowLimit);var p=0;"number"==typeof e.page&&e.page>=0&&(p=e.page);var d='{"targets":[{"target":"'+l+'","metricName":"'+o+'","sysparm_query":"'+u+'","filterType":"'+s+'","limit":'+c+',"page":'+p+"}]}";return this.apiClient.request({url:this.apiPath+"/v1/query/acc_agents?startTime="+t+"&endTime="+a,data:d,method:"POST"}).then((function(e){return r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getTopologyCISummary=function(e){var t='{"targets":[{"target":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/ci_summary",data:t,method:"POST"}).then((function(e){return T(),T(),e.data}))},e.prototype.getCISummary=function(e,t){var a=this,n="";void 0!==e.selectedSourceList&&(n=C(e.selectedSourceList.value,t.scopedVars));var r="";void 0!==e.sysparam_query&&e.sysparam_query&&(r=C(e.sysparam_query,t.scopedVars));var l='{"targets":[{"target":"'+n+'","sysparm_query":"'+r+'"}]}';return this.apiClient.request({url:this.apiPath+"/v1/query/ci_summary",data:l,method:"POST"}).then((function(e){return T(),T(),a.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getMetricAnomalyOptions=function(){return[{label:"true",value:"true"},{label:"false",value:"false"}]},e.prototype.getAggregateTypeOptions=function(){return[{label:"AVG",value:"AVG"},{label:"COUNT",value:"COUNT"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"STDDEV",value:"STDDEV"},{label:"SUM",value:"SUM"}]},e.prototype.getAlertStateOptions=function(){return[{label:"Active",value:"Active",description:"Get Open and Reopen Alerts"},{label:"All",value:"All",description:"Get All alerts Open,Reopen, and Closed"}]},e.prototype.getAlertTypeOptions=function(){return[{label:"CI",value:"CI",description:"Get Alerts at the CI level"},{label:"Service",value:"Service",description:"Get Alerts at the Service level"},{label:"OS",value:"OS",description:"Get Alerts for all Agents in the class"},{label:"None",value:"None",description:"Ignore CI selection and use sysparam_query"}]},e.prototype.getAgentFilterTypeOptions=function(){return[{label:"OS",value:"OS",description:"Get all agents matching the OS"},{label:"CI",value:"CI",description:"Get all agents matching the CI"}]},e.prototype.getChangeTypeOptions=function(){return[{label:"CI",value:"CI",description:"Get Changes at the CI level"},{label:"Service",value:"Service",description:"Get Changes at the Service level"},{label:"None",value:"None",description:"Ignore CI selection and use sysparam_query"}]},e.prototype.getAdminQueryOptions=function(){return[{label:"Metrics Definition",value:"Metrics Definition",description:""}]},e.prototype.getAgentMetricOptions=function(){return[{label:"cpu",value:"cpu"},{label:"memory",value:"memory"},{label:"disk",value:"disk"}]},e.prototype.getSysparamTypeOptions=function(){return[{label:"is",value:"=",description:"="},{label:"is not",value:"!=",description:"!="},{label:"starts with",value:"STARTSWITH",description:"STARTSWITH"},{label:"ends with",value:"ENDSWITH",description:"ENDSWITH"},{label:"contains",value:"LIKE",description:"LIKE"},{label:"does not contain",value:"NOT LIKE",description:"NOT LIKE"},{label:"is empty",value:"ISEMPTY",description:"ISEMPTY"},{label:"is not empty",value:"ISNOTEMPTY",description:"ISNOTEMPTY"},{label:"is anything",value:"ANYTHING",description:"ANYTHING"},{label:"is one of",value:"IN",description:"IN"},{label:"is empty string",value:"EMPTYSTRING",description:"EMPTYSTRING"},{label:"less than or is",value:"<=",description:"<="},{label:"greater than or is",value:">=",description:">="},{label:"between",value:"BETWEEN",description:"BETWEEN"},{label:"is same as",value:"SAMEAS",description:"SAMEAS"},{label:"is different",value:"NSAMEAS",description:"NSAMEAS"}]},e.prototype.getTrendByOptions=function(){return[{label:"Minute",value:"minute"},{label:"Hour",value:"hour"}]},e}(),I=function(e){function t(t){var a=e.call(this,t)||this,n={type:t.type,url:t.url,name:t.name,basicAuth:t.basicAuth,withCredentials:t.withCredentials};return a.instanceName=t.jsonData.instanceName,a.snowConnection=new x(n),a.annotations={},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}(t,e),t.prototype.metricFindQuery=function(e,t){return i(this,void 0,void 0,(function(){var a,n,r,l,i,u,s,c,p,m,v;return o(this,(function(o){return"generic"===e.namespace?void 0!==e.rawQuery?(a=e.rawQuery.split("||"),n=void 0===a[0]?"":Object(d.getTemplateSrv)().replace(a[0],t.scopedVars,"csv"),r=void 0===a[1]?"":Object(d.getTemplateSrv)().replace(a[1],t.scopedVars,"csv"),l=void 0===a[2]?"":Object(d.getTemplateSrv)().replace(a[2],t.scopedVars,"csv"),i=void 0===a[3]?"":Object(d.getTemplateSrv)().replace(a[3],t.scopedVars,"csv"),[2,this.snowConnection.getGenericVariable(n,r,l,i)]):[2,[]]:"metric_names"===e.namespace?(u=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),s=u.split(","),[2,this.snowConnection.getMetricNamesInCIs("",s)]):"golden_metric_names"===e.namespace?(u=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),s=u.split(","),[2,this.snowConnection.getMetricNamesInCIs("GOLDEN",s)]):"custom_kpis"===e.namespace?(u=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),s=u.split(","),[2,this.snowConnection.getMetricNamesInCIs("CUSTOM_KPIS",s)]):"nested_cis"===e.namespace?((c=e.rawQuery.split("||")).map((function(e,a){c[a]=Object(d.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===c[a].indexOf("$")&&(c=c.splice(a))})),p={ci:void 0===c[0]?"":c[0],parentDepth:void 0===c[1]?"":c[1],childDepth:void 0===c[2]?"":c[2],sysparam:void 0===c[3]?"":c[3]},[2,this.snowConnection.getNestedCIS(p)]):"nested_classes"===e.namespace?((m=e.rawQuery.split("||")).map((function(e,a){m[a]=Object(d.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===m[a].indexOf("$")&&(m=m.splice(a))})),v={ci:void 0===m[0]?"":m[0],parentDepth:void 0===m[1]?"":m[1],childDepth:void 0===m[2]?"":m[2],sysparam:void 0===m[3]?"":m[3]},[2,this.snowConnection.getNestedClasses(v)]):[2]}))}))},t.prototype.query=function(e){return i(this,void 0,Promise,(function(){var t,a,r,l,i=this;return o(this,(function(o){return t=e.range,a=t.from.valueOf(),r=t.to.valueOf(),"Topology"===e.targets[0].selectedQueryCategory.value?[2,this.snowConnection.getTopologyFrame(e.targets[0],a,r,e)]:(l=v.a.map(e.targets,(function(t){if(t.hide)return[];var n=v.a.cloneDeep(t);switch(p()(n,f).selectedQueryCategory.value){case"Metrics":return i.snowConnection.getMetrics(n,a,r,e);case"Alerts":return i.snowConnection.getTextFrames(n,a,r,e,"Alerts",i.instanceName);case"Topology":return i.snowConnection.getTopology(n,a,r,e);case"Admin":return i.snowConnection.getTextFrames(n,a,r,e,"Admin");case"CI_Summary":return i.snowConnection.getTextFrames(n,a,r,e,"CI_Summary");case"Changes":return i.snowConnection.getTextFrames(n,a,r,e,"Changes");case"Agents":return i.snowConnection.getTextFrames(n,a,r,e,"Agents");case"Live_Agent_Data":return i.snowConnection.getLiveACCData(n,e);case"Table":return i.snowConnection.getTextFrames(n,a,r,e,"Table");case"Row_Count":return i.snowConnection.getRowCount(n,e);case"Aggregate":return i.snowConnection.getAggregateQuery(n,e);case"Geohash_Map":return i.snowConnection.getGeohashMap(n,e);case"Log_Data":return i.snowConnection.queryLogData(n,a,r,e);case"Trend_Data":return i.snowConnection.getTrendData(n,a,r,e);case"Outage_Status":return i.snowConnection.getOutageStatus(n,e);case"Anomaly":return i.snowConnection.getAnomaly(n,a,r,e);default:return[]}})),[2,Promise.all(v.a.flatten(l)).then(v.a.flatten).then((function(t){return{data:t,state:n.LoadingState.Done,key:e.requestId}}))])}))}))},t.prototype.testDatasource=function(){return this.snowConnection.apiClient.request({url:"/",method:"GET"}).then((function(e){return 200===e.status?{status:"success",message:"Data source connection is successful",title:"Success"}:{status:"error",message:"Data source connection failed: "+e.message,title:"Error"}}))},t}(n.DataSourceApi),L=a(0),N=a.n(L),q=a(1),Q=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Service",labelWidth:20},N.a.createElement(q.AsyncSelect,{width:20,loadOptions:t,defaultOptions:!0,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedServiceList",{label:e,value:e})},onChange:function(e){return n("selectedServiceList",e)},menuPlacement:"bottom"}))))},P=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"CI",labelWidth:20},N.a.createElement(q.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isMulti:!0,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=s([],u(a)))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedSourceList",t)},onChange:function(e){return n("selectedSourceList",e)},menuPlacement:"bottom"}))))},j=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Resource ID",labelWidth:20},N.a.createElement(q.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=s([],u(a)))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedMetricTypeList",t)},onChange:function(e){return n("selectedMetricTypeList",e)}}))))},M=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Metric Name",labelWidth:20},N.a.createElement(q.AsyncSelect,{width:20,loadOptions:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){var t=[];void 0!==a?(t=s([],u(a)))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedMetricNameList",t)},onChange:function(e){return n("selectedMetricNameList",e)},className:"coloredSelect"}))))},R=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Anomaly",labelWidth:20},N.a.createElement(q.Select,{width:20,options:t,value:a,defaultValue:a,isClearable:!0,onChange:function(e){return n("selectedMetricAnomalyList",e)}}))))},B=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Sysparam Query",labelWidth:20},N.a.createElement(q.Input,{name:"sysparam_query",width:20,defaultValue:a,onBlur:function(e){return t("sysparam_query",e.target.value)}}))))},D=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Alert Type Filter",labelWidth:20},N.a.createElement(q.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedAlertTypeList",e)}}))))},k=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Alert State Filter",labelWidth:20},N.a.createElement(q.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedAlertStateList",e)}}))))},G=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Change Type Filter",labelWidth:20},N.a.createElement(q.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,onChange:function(e){return n("selectedChangeTypeList",e)}}))))},W=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Starting Point",labelWidth:20},N.a.createElement(q.AsyncSelect,{width:20,loadOptions:t,defaultOptions:!0,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedServiceList",{label:e,value:e})},onChange:function(e){return n("selectedServiceList",e)},menuPlacement:"bottom"}))))},U=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Parent Depth",labelWidth:20},N.a.createElement(q.Input,{name:"parent_depth",width:20,defaultValue:a,onBlur:function(e){return t("topology_parent_depth",e.target.value)}}))))},H=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Child Depth",labelWidth:20},N.a.createElement(q.Input,{name:"child_depth",width:20,defaultValue:a,onBlur:function(e){return t("topology_child_depth",e.target.value)}}))))},K=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Category Option",labelWidth:20},N.a.createElement(q.Select,{width:20,options:t,value:a,defaultValue:a,allowCustomValue:!0,onCreateOption:function(e){return n("selectedAdminCategoryList",{label:e,value:e})},onChange:function(e){return n("selectedAdminCategoryList",e)}}))))},$=function(e){var t=e.options,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Generalized Agent Metric",labelWidth:20},N.a.createElement(q.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedMetricNameList",{label:e,value:e})},onChange:function(e){return n("selectedMetricNameList",e)}}))))},z=function(e){var t=e.typeOptions,a=e.typeValue,n=e.updateQuery,r=e.loadOptions,l=e.value;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Agent Filter",labelWidth:20},N.a.createElement(q.Select,{width:20,options:t,value:a,defaultValue:a,allowCustomValue:!0,onCreateOption:function(e){return n("selectedAgentFilterType",{label:e,value:e})},onChange:function(e){return n("selectedAgentFilterType",e)}})),N.a.createElement(q.InlineField,null,N.a.createElement(q.AsyncSelect,{width:20,loadOptions:r,value:l,defaultValue:l,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedAgentFilter",{label:e,value:e})},onChange:function(e){return n("selectedAgentFilter",e)}}))))},Y=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Osquery",labelWidth:20},N.a.createElement(q.Input,{name:"osquery",width:20,defaultValue:a,onBlur:function(e){return t("live_osquery",e.target.value)}}))))},J=function(e){var t=e.loadTableOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Table Name",labelWidth:20},N.a.createElement(q.AsyncSelect,{prefix:N.a.createElement(q.Icon,{name:"table"}),loadOptions:t,className:"min-width-10 max-width-30",value:a,defaultValue:a,defaultOptions:!0,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return n("tableName",e)},onCreateOption:function(e){return n("tableName",{label:e,value:e})},menuPlacement:"bottom",maxMenuHeight:200}))))},X=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Table Columns",labelWidth:20,tooltip:"Leave columns blank to return all columns in the dictionary"},N.a.createElement(q.AsyncMultiSelect,{prefix:N.a.createElement(q.Icon,{name:"columns"}),className:"min-width-10 max-width-30",loadOptions:function(e){return t(!1,e)},value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return n("selectedtableColumns",e)},onCreateOption:function(e){var t=[];void 0!==a?(t=s([],u(a)))[t.length]={label:e,value:e}:t=[{label:e,value:e}],n("selectedtableColumns",t)},menuPlacement:"bottom",maxMenuHeight:200}))))},Z=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Group By",labelWidth:20},N.a.createElement(q.Input,{name:"group_by",width:20,defaultValue:a,onBlur:function(e){return t("groupBy",e.target.value)}}))))},ee=function(e){var t=e.options,a=e.value,n=e.updateQuery,r=e.defaultColumnValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Aggregate Function",labelWidth:20,tooltip:"Choose your aggregation function then the column to run this function on"},N.a.createElement(q.Select,{width:20,options:t,value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return n("selectedAggregateType",{label:e,value:e})},onChange:function(e){return n("selectedAggregateType",e)}})),N.a.createElement(q.InlineField,null,N.a.createElement(q.Input,{name:"aggregate_column",width:20,defaultValue:r,onBlur:function(e){return n("aggregateColumn",e.target.value)}}))))},te=function(e){for(var t=e.value,a=e.updateQuery,n=e.loadColumns,r=e.sysparamTypeOptions,l=e.loadChoices,i=s([],u(t)),o=function(e,t,n){var r=i;r[e][t]=n,a("basic_sysparam",r)},c=[{label:"AND",value:"^"},{label:"OR",value:"^OR"}],p=[],d=-1!==i.constructor.toString().indexOf("Array")?t.length:0,m=function(e){p.push(N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,0!==e&&N.a.createElement(q.InlineField,null,N.a.createElement(q.RadioButtonGroup,{options:c,value:void 0!==i[e][4]?i[e][4].value:null,onChange:function(t){return o(e,4,{label:t,value:t})}})),N.a.createElement(q.InlineField,{label:0===e?"Sysparam Query":void 0,labelWidth:0===e?20:void 0},N.a.createElement(q.AsyncSelect,{className:"min-width-10",loadOptions:function(e){return n(!1,e)},value:void 0!==i[e][1]?i[e][1]:null,defaultValue:void 0!==i[e][1]?i[e][1]:null,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return o(e,1,t)},onCreateOption:function(t){return o(e,1,{label:t,value:t})}})),N.a.createElement(q.InlineField,null,N.a.createElement(q.Select,{width:20,options:r,value:void 0!==i[e][2]?i[e][2]:null,defaultValue:void 0!==i[e][2]?i[e][2]:null,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return o(e,2,t)},onCreateOption:function(t){return o(e,2,{label:t,value:t})},maxMenuHeight:200})),N.a.createElement(q.InlineField,null,N.a.createElement(q.AsyncSelect,{className:"min-width-10",loadOptions:function(t){return l(e,t)},value:void 0!==i[e][3]?i[e][3]:null,defaultValue:void 0!==i[e][3]?i[e][3]:null,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(t){return o(e,3,t)},onCreateOption:function(t){return o(e,3,{label:t,value:t})}})),e>0&&N.a.createElement(q.InlineField,null,N.a.createElement(q.ToolbarButton,{icon:"trash-alt",variant:"destructive",iconOnly:!0,onClick:function(){return t=e,(n=i).splice(t,1),void a("basic_sysparam",n);var t,n}}))),e===d-1&&N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,null,N.a.createElement(q.ToolbarButton,{icon:"plus",variant:"primary",onClick:function(){return(e=i).push({1:null,2:null,3:null,4:{label:"AND",value:"^"}}),void a("basic_sysparam",e);var e}})))))},v=0;v<d;v++)m(v);return N.a.createElement(N.a.Fragment,null,p)},ae=function(e){var t=e.loadOptions,a=e.value,n=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Sort By",labelWidth:20},N.a.createElement(q.AsyncSelect,{className:"min-width-10",loadOptions:function(e){return t(!1,e)},value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return n("sortBy",e)},onCreateOption:function(e){return n("sortBy",{label:e,value:e})},maxMenuHeight:200}))))},ne=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Limit",labelWidth:20,tooltip:"Limit the number of results. Expects a number between 1 - 9999"},N.a.createElement(q.Input,{name:"limit",type:"number",max:9999,min:1,width:20,defaultValue:a,onBlur:function(e){return t("rowLimit",e.target.value)}}))))},re=function(e){var t=e.updateQuery,a=e.defaultValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Elastic Search Query",labelWidth:20},N.a.createElement(q.Input,{name:"elasticSearch",width:20,defaultValue:a,onBlur:function(e){return t("elasticSearch",e.target.value)}}))))},le=function(e){var t=e.columnLoadOptions,a=e.columnValue,n=e.updateQuery,r=e.trendByValue,l=e.trendByOptions,i=e.periodValue;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Trend",labelWidth:20},N.a.createElement(q.AsyncSelect,{className:"min-width-10 max-width-30",loadOptions:function(e){return t(!1,e)},value:a,defaultValue:a,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return n("selectedTrendColumn",e)},onCreateOption:function(e){return n("selectedTrendColumn",{label:e,value:e})},maxMenuHeight:200})),N.a.createElement(q.InlineField,null,N.a.createElement(q.Select,{className:"min-width-10 max-width-30",options:l,value:r,defaultValue:r,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:function(e){return n("selectedTrendBy",e)},onCreateOption:function(e){return n("selectedTrendBy",{label:e,value:e})}})),N.a.createElement(q.InlineField,null,N.a.createElement(q.Input,{name:"period",type:"number",max:300,min:1,width:20,defaultValue:i,onBlur:function(e){return n("trendPeriod",e.target.value)}}))))},ie=function(e){var t=e.value,a=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Show Uptime %",labelWidth:20},N.a.createElement(q.RadioButtonGroup,{options:[{label:"False",value:!1},{label:"True",value:!0}],value:t||!1,onChange:function(e){return a("showPercent",e)}}))))},oe=function(e){var t=e.defaultValue,a=e.updateQuery;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,null,N.a.createElement(q.InlineField,{label:"Page",labelWidth:20,tooltip:"Page number used for pagination. Starts at page 0"},N.a.createElement(q.Input,{name:"page",type:"number",max:9999,min:0,width:20,defaultValue:t,onBlur:function(e){return a("page",e.target.valueAsNumber)}}))))},ue=(a(53),function(e){var t,a=e.query,n=e.onChange,r=e.datasource,i=Object(m.defaults)(a,f),o=r.snowConnection.getMetricAnomalyOptions(),u=r.snowConnection.getAlertTypeOptions(),s=r.snowConnection.getAlertStateOptions(),c=r.snowConnection.getChangeTypeOptions(),p=r.snowConnection.getAdminQueryOptions(),d=r.snowConnection.getAgentFilterTypeOptions(),v=r.snowConnection.getAgentMetricOptions(),y=r.snowConnection.getAggregateTypeOptions(),h=r.snowConnection.getSysparamTypeOptions(),g=r.snowConnection.getTrendByOptions(),b=function(e){return new Promise((function(t){setTimeout((function(){t(r.snowConnection.loadServiceOptions(e))}),500)}))},C=function(e){return new Promise((function(t){setTimeout((function(){var a;t(r.snowConnection.loadCIOptions(null===(a=i.selectedServiceList)||void 0===a?void 0:a.value,e))}),500)}))},E=function(e,t){return new Promise((function(a){setTimeout((function(){var n;a(r.snowConnection.loadTableColumns(null===(n=i.tableName)||void 0===n?void 0:n.value,e,t))}),500)}))},T=function(e,t){return new Promise((function(a){setTimeout((function(){var n,l;a(r.snowConnection.loadColumnChoices(null===(n=i.tableName)||void 0===n?void 0:n.value,null===(l=i.basic_sysparam[e][1])||void 0===l?void 0:l.value,t))}),500)}))},O=function(e){return new Promise((function(t){setTimeout((function(){t(r.snowConnection.loadTableOptions(e))}),500)}))},w=function(e,t){var a;n(l(l({},i),((a={})[e]=t,a)))},S=function(e){for(var t=i,a=0;a<e.length;a++)t[e[a].key]=e[a].value;n(t)},_={Metrics:{title:"Metrics",description:"Get Timeseries metrics",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(Q,{loadOptions:b,value:i.selectedServiceList,updateQuery:w}),N.a.createElement(P,{loadOptions:C,value:i.selectedSourceList,updateQuery:w}),N.a.createElement(j,{loadOptions:function(e){return new Promise((function(t){setTimeout((function(){t(r.snowConnection.loadResourceOptions(i.selectedSourceList,e))}),500)}))},value:i.selectedMetricTypeList,updateQuery:w}),N.a.createElement(M,{loadOptions:function(e){return new Promise((function(t){setTimeout((function(){t(r.snowConnection.loadMetricOptions(i.selectedSourceList,e))}),500)}))},value:i.selectedMetricNameList,updateQuery:w}),N.a.createElement(R,{options:o,value:i.selectedMetricAnomalyList,updateQuery:w}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}))},Alerts:{title:"Alerts",description:"Get Alerts",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(Q,{loadOptions:b,value:i.selectedServiceList,updateQuery:w}),N.a.createElement(P,{loadOptions:C,value:i.selectedSourceList,updateQuery:w}),N.a.createElement(D,{options:u,value:i.selectedAlertTypeList,updateQuery:w}),N.a.createElement(k,{options:s,value:i.selectedAlertStateList,updateQuery:w}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}),N.a.createElement(ne,{defaultValue:i.rowLimit,updateQuery:w}),N.a.createElement(oe,{defaultValue:i.page,updateQuery:w}))},Changes:{title:"Changes",description:"Get Changes",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(Q,{loadOptions:b,value:i.selectedServiceList,updateQuery:w}),N.a.createElement(P,{loadOptions:C,value:i.selectedSourceList,updateQuery:w}),N.a.createElement(G,{options:c,value:i.selectedChangeTypeList,updateQuery:w}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}),N.a.createElement(ne,{defaultValue:i.rowLimit,updateQuery:w}),N.a.createElement(oe,{defaultValue:i.page,updateQuery:w}))},Topology:{title:"Topology",description:"Get Topology",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(W,{loadOptions:b,value:i.selectedServiceList,updateQuery:w}),N.a.createElement(U,{updateQuery:w,defaultValue:i.topology_parent_depth}),N.a.createElement(H,{updateQuery:w,defaultValue:i.topology_child_depth}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}))},Admin:{title:"Admin",description:"Definitions and Admin Queries",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(K,{options:p,value:i.selectedAdminCategoryList,updateQuery:w}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}))},CI_Summary:{title:"CI Summary",description:"CI Summary",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(Q,{loadOptions:b,value:i.selectedServiceList,updateQuery:w}),N.a.createElement(P,{loadOptions:C,value:i.selectedSourceList,updateQuery:w}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}))},Agents:{title:"Agents",description:"Get Agent information",content:N.a.createElement(N.a.Fragment,null,N.a.createElement($,{updateQuery:w,value:i.selectedMetricNameList,options:v}),N.a.createElement(z,{typeOptions:d,typeValue:i.selectedAgentFilterType,updateQuery:w,loadOptions:C,value:i.selectedAgentFilter}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}),N.a.createElement(ne,{defaultValue:i.rowLimit,updateQuery:w}),N.a.createElement(oe,{defaultValue:i.page,updateQuery:w}))},Live_Agent_Data:{title:"Live Agent Data",description:"Get Live Data from your ACC Agents",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(Y,{updateQuery:w,defaultValue:i.live_osquery}))},Table:{title:"Table",description:"Choose your own table to gather data from",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(J,{updateQuery:w,loadTableOptions:O,value:i.tableName}),N.a.createElement(X,{updateQuery:w,loadOptions:E,value:i.selectedtableColumns}),N.a.createElement(te,{value:i.basic_sysparam,updateQuery:w,loadColumns:E,sysparamTypeOptions:h,loadChoices:T}),N.a.createElement(ae,{loadOptions:E,value:i.sortBy,updateQuery:w}),N.a.createElement(ne,{defaultValue:i.rowLimit,updateQuery:w}),N.a.createElement(oe,{defaultValue:i.page,updateQuery:w}))},Row_Count:{title:"Row Count",description:"Get row count from query",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(J,{updateQuery:w,loadTableOptions:O,value:i.tableName}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}))},Aggregate:{title:"Aggregate",description:"Group by and apply aggregate functions to table data",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(J,{updateQuery:w,loadTableOptions:O,value:i.tableName}),N.a.createElement(Z,{updateQuery:w,defaultValue:i.groupBy}),N.a.createElement(ee,{options:y,value:i.selectedAggregateType,updateQuery:w,defaultColumnValue:i.aggregateColumn}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}))},Geohash_Map:{title:"GeoHash Map",description:"Get map data from AWS or Azure",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(J,{updateQuery:w,loadTableOptions:O,value:i.tableName}),N.a.createElement(Z,{updateQuery:w,defaultValue:i.groupBy}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}))},Log_Data:{title:"Log Data",description:"Get log data",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(te,{value:i.basic_sysparam,updateQuery:w,loadColumns:E,sysparamTypeOptions:h,loadChoices:T}),N.a.createElement(re,{updateQuery:w,defaultValue:i.elasticSearch}),N.a.createElement(ae,{loadOptions:E,value:i.sortBy,updateQuery:w}),N.a.createElement(ne,{defaultValue:i.rowLimit,updateQuery:w}),N.a.createElement(oe,{defaultValue:i.page,updateQuery:w}))},Trend_Data:{title:"Trend Data",description:"Get timeseries data based on a time trend",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(J,{updateQuery:w,loadTableOptions:O,value:i.tableName}),N.a.createElement(te,{value:i.basic_sysparam,updateQuery:w,loadColumns:E,sysparamTypeOptions:h,loadChoices:T}),N.a.createElement(re,{updateQuery:w,defaultValue:i.elasticSearch}),N.a.createElement(le,{columnLoadOptions:E,columnValue:i.selectedTrendColumn,updateQuery:w,trendByOptions:g,trendByValue:i.selectedTrendBy,periodValue:i.trendPeriod}))},Outage_Status:{title:"Outage Status",description:"Gathers business service status over the last 90 days",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(Q,{loadOptions:b,value:i.selectedServiceList,updateQuery:w}),N.a.createElement(ie,{value:i.showPercent,updateQuery:w}),N.a.createElement(B,{updateQuery:w,defaultValue:i.sysparam_query}),N.a.createElement(ne,{defaultValue:i.rowLimit,updateQuery:w}),N.a.createElement(oe,{defaultValue:i.page,updateQuery:w}))},Anomaly:{title:"Anomaly",description:"Parse values out of Alert Anomalies table",content:N.a.createElement(N.a.Fragment,null,N.a.createElement(J,{updateQuery:w,loadTableOptions:O,value:i.tableName}),N.a.createElement(X,{updateQuery:w,loadOptions:E,value:i.selectedtableColumns}),N.a.createElement(te,{value:i.basic_sysparam,updateQuery:w,loadColumns:E,sysparamTypeOptions:h,loadChoices:T}),N.a.createElement(ae,{loadOptions:E,value:i.sortBy,updateQuery:w}),N.a.createElement(ne,{defaultValue:i.rowLimit,updateQuery:w}),N.a.createElement(oe,{defaultValue:i.page,updateQuery:w}))}};return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.InlineFieldRow,{style:{paddingTop:"8px"}},N.a.createElement(q.InlineField,{label:"Query Category",labelWidth:20},N.a.createElement(q.Select,{className:"min-width-10 max-width-30",options:function(){var e=[];for(var t in _){var a=_[t];e.push({label:a.title,value:t,description:a.description})}return e}(),value:i.selectedQueryCategory,onChange:function(e){"Anomaly"===e.label?S([{key:"tableName",value:{label:"Alert Anomaly",value:"em_alert_anomaly",description:"em_alert_anomaly"}},{key:"selectedQueryCategory",value:e}]):w("selectedQueryCategory",e)},menuPlacement:"bottom"}))),_[null!==(t=i.selectedQueryCategory.value)&&void 0!==t?t:""].content)});a.d(t,"plugin",(function(){return se}));var se=new n.DataSourcePlugin(I).setConfigEditor((function(e){var t=e.options,a=e.onOptionsChange;return N.a.createElement(N.a.Fragment,null,N.a.createElement(q.DataSourceHttpSettings,{defaultUrl:"https://<instance_name>.service-now.com/api/snc/grafana_api",dataSourceConfig:t,showAccessOptions:!0,onChange:function(e){var t="";-1!==e.url.indexOf("https://")?t=e.url.substring(8,e.url.indexOf(".service-now",8)):-1!==e.url.indexOf("http://")&&(t=e.url.substring(7,e.url.indexOf(".service-now",7))),e.jsonData.instanceName=t,a(e)}}))})).setQueryEditor((function(e){return N.a.createElement(ue,l({},e))})).setVariableQueryEditor((function(e){var t=e.onChange,a=e.query,n=u(Object(L.useState)(a),2),r=n[0],i=n[1],o=function(){t(r,r.rawQuery+" ("+r.namespace+")")},s=function(e){var t;return i(l(l({},r),((t={})[e.currentTarget.name]=e.currentTarget.value,t)))};return N.a.createElement(N.a.Fragment,null,N.a.createElement("div",{className:"gf-form"},N.a.createElement("span",{className:"gf-form-label width-10"},"Namespace"),N.a.createElement("input",{name:"namespace",className:"gf-form-input",onBlur:o,onChange:s,value:r.namespace})),N.a.createElement("div",{className:"gf-form"},N.a.createElement("span",{className:"gf-form-label width-10"},"Query"),N.a.createElement("input",{name:"rawQuery",className:"gf-form-input",onBlur:o,onChange:s,value:r.rawQuery})))}))}])}));
//# sourceMappingURL=module.js.map