define(["@grafana/data","@grafana/runtime","react","@grafana/ui","lodash"],((e,t,l,a,n)=>(()=>{"use strict";var r={305:t=>{t.exports=e},545:e=>{e.exports=t},388:e=>{e.exports=a},980:e=>{e.exports=n},650:e=>{e.exports=l}},o={};function u(e){var t=o[e];if(void 0!==t)return t.exports;var l=o[e]={exports:{}};return r[e](l,l.exports,u),l.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var l in t)u.o(t,l)&&!u.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{u.r(i),u.d(i,{plugin:()=>oe});var e=u(305),t=u(545);function l(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}function a(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function n(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{},n=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),n.forEach((function(t){a(e,t,l[t])}))}return e}function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t.push.apply(t,l)}return t}(Object(t)).forEach((function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(t,l))})),e}class o extends t.DataSourceWithBackend{applyTemplateVariables(e,l){if(console.log("Scoped Vars:",l),e.tableName&&e.tableName.value){const a=(0,t.getTemplateSrv)().replace(e.tableName.value,l,"csv");console.log("Interpolated Table Name:",a),e.tableName.value=a}if(e.selectedtableColumns&&e.selectedtableColumns.length>0){const a=e.selectedtableColumns.map((e=>{if(e.value){const a=(0,t.getTemplateSrv)().replace(e.value,l,"csv");return console.log("Interpolated Column Value:",a),r(n({},e),{value:a})}return e}));console.log("Interpolated Columns:",a),e.selectedtableColumns=a}if(e.sortBy&&e.sortBy.value){const a=(0,t.getTemplateSrv)().replace(e.sortBy.value,l,"csv");console.log("Interpolated Sort by:",a),e.sortBy.value=a}if(e.selectedServiceList&&e.selectedServiceList.value){const a=(0,t.getTemplateSrv)().replace(e.selectedServiceList.value,l,"csv");console.log("Interpolated Service List:",a),e.selectedServiceList.value=a}if(e.groupBy&&e.groupBy.value){const a=(0,t.getTemplateSrv)().replace(e.groupBy.value,l,"csv");console.log("Interpolated Group By:",a),e.groupBy.value=a}if(e.selectedTrendColumn&&e.selectedTrendColumn.value){const a=(0,t.getTemplateSrv)().replace(e.selectedTrendColumn.value,l,"csv");console.log("Interpolated Trend Column:",a),e.selectedTrendColumn.value=a}if(e.basicSysparm&&e.basicSysparm.length>0){const a=e.basicSysparm.map((e=>{var a,o;const u=e.column?r(n({},e.column),{value:(0,t.getTemplateSrv)().replace(e.column.value,l,"csv")}):null,i=e.operator?r(n({},e.operator),{value:(0,t.getTemplateSrv)().replace(e.operator.value,l,"csv")}):null,c=e.value?r(n({},e.value),{value:(null===(o=e)||void 0===o||null===(a=o.value)||void 0===a?void 0:a.value)?(0,t.getTemplateSrv)().replace(e.value.value,l,"csv"):e.value.value}):null;return r(n({},e),{column:u,operator:i,value:c})}));console.log("Interpolated Basic Sysparm:",a),e.basicSysparm=a}if(e.aggregateColumn&&e.aggregateColumn.value){const a=(0,t.getTemplateSrv)().replace(e.aggregateColumn.value,l,"csv");console.log("Interpolated Aggregate Column:",a),e.aggregateColumn.value=a}if(e.selectedSourceList&&e.selectedSourceList.length>0){const a=e.selectedSourceList.map((e=>{if(e.value){const a=(0,t.getTemplateSrv)().replace(e.value,l,"csv");return console.log("Interpolated Source Value:",a),r(n({},e),{value:a})}return e}));console.log("Interpolated Source List:",a),e.selectedSourceList=a}if(e.showPercent){const a=(0,t.getTemplateSrv)().replace(e.showPercent.toString(),l,"csv");console.log("Interpolated Show Percent:",a),e.showPercent="true"===a}if(e.topology_parent_depth){const a=(0,t.getTemplateSrv)().replace(e.topology_parent_depth,l,"csv");console.log("Interpolated Parent Depth:",a),e.topology_parent_depth=a}if(e.topology_child_depth){const a=(0,t.getTemplateSrv)().replace(e.topology_child_depth,l,"csv");console.log("Interpolated Child Depth:",a),e.topology_child_depth=a}if(e.relationshipTypes){const a=e.relationshipTypes.map((e=>(0,t.getTemplateSrv)().replace(e.value,l,"csv")));console.log("Interpolated Relationship Types:",a),e.relationshipTypes=a.map((e=>({value:e,label:e})))}if(e.excludedClasses){const a=e.excludedClasses.map((e=>(0,t.getTemplateSrv)().replace(e.value,l,"csv")));console.log("Interpolated Excluded Classes:",a),e.excludedClasses=a.map((e=>({value:e,label:e})))}if(e.elasticSearch){const a=(0,t.getTemplateSrv)().replace(e.elasticSearch,l,"csv");console.log("Interpolated Elastic Search Query:",a),e.elasticSearch=a}if(e.selectedMetricTypeList&&e.selectedMetricTypeList.length>0){const a=e.selectedMetricTypeList.map((e=>{if(e.value){const a=(0,t.getTemplateSrv)().replace(e.value,l,"csv");return console.log("Interpolated Metric Type Value:",a),r(n({},e),{value:a})}}));console.log("Interpolated Metric Type List:",a),e.selectedMetricTypeList=a}if(e.selectedMetricNameList&&e.selectedMetricNameList.length>0){const a=e.selectedMetricNameList.map((e=>{if(e.value){const a=(0,t.getTemplateSrv)().replace(e.value,l,"csv");return console.log("Interpolated Metric Name Value:",a),r(n({},e),{value:a})}return e}));console.log("Interpolated Metric Name List:",a),e.selectedMetricNameList=a}const a=r(n({},e),{rawQuery:(0,t.getTemplateSrv)().replace(e.rawQuery,l,"csv")});return console.log("Interpolated Query:",a),a}metricFindQuery(e,a){var n,r=this;return(n=function*(){console.log("inside template variables metricFindQuery");let l=e.showAsterisk,n=e.showNull;if("global_image"===e.namespace)return console.log("inside global_image variable query"),console.log("Global Image:",r.globalImage),[{label:r.globalImage,value:r.globalImage}];if("global_instance_name"===e.namespace)return console.log("inside global_instance_name variable query"),console.log("Global Instance Name:",r.instanceName),[{label:r.instanceName,value:r.instanceName}];if("group_by"===e.namespace&&(console.log("inside group_by variable query"),void 0!==e.rawQuery)){let o=e.rawQuery.split("||");const u={tableName:void 0===o[0]?"":(0,t.getTemplateSrv)().replace(o[0],a.scopedVars,"csv"),groupBy:void 0===o[1]?"":(0,t.getTemplateSrv)().replace(o[1],a.scopedVars,"csv"),sysparam:void 0===o[2]?"":(0,t.getTemplateSrv)().replace(o[2],a.scopedVars,"csv"),asterisk:l,showNull:n};try{const e=yield r.postResource("groupBy",u);if(e)return e.map((e=>({text:e.label,value:e.value})))}catch(e){throw console.error("Error calling variableGroupBy:",e),e}}if("generic"===e.namespace){if(console.log("inside generic variable query"),void 0!==e.rawQuery){console.log("RAW QUERY",e.rawQuery);let o=e.rawQuery.split("||");console.log(o);let u=void 0===o[0]?"":(0,t.getTemplateSrv)().replace(o[0],a.scopedVars,"csv");console.log(u);const i={tableName:u,nameColumn:void 0===o[1]?"":(0,t.getTemplateSrv)().replace(o[1],a.scopedVars,"csv"),idColumn:void 0===o[2]?"":(0,t.getTemplateSrv)().replace(o[2],a.scopedVars,"csv"),sysparam:void 0===o[3]?"":(0,t.getTemplateSrv)().replace(o[3],a.scopedVars,"csv"),limit:void 0===o[4]?"9999":(0,t.getTemplateSrv)().replace(o[4],a.scopedVars,"csv"),asterisk:l,showNull:n};try{const e=yield r.postResource("generic",i);if(console.log("Response",e),e)return e.map((e=>({text:e.label,value:e.value})))}catch(e){throw console.error("Error calling variableGeneric:",e),e}}return[]}if("metric_names"===e.namespace||"golden_metric_names"===e.namespace||"custom_kpis"===e.namespace){console.log(`inside ${e.namespace} variables metricFindQuery`),console.log(a);let o=(0,t.getTemplateSrv)().replace(e.rawQuery,a.scopedVars,"csv");console.log("RawQuery replacedValue= "+o);let u="";"golden_metric_names"===e.namespace?u="GOLDEN":"custom_kpis"===e.namespace&&(u="CUSTOM_KPIS");const i={cis:o.split(","),asterisk:l,showNull:n,metricType:u};try{const e=yield r.postResource("metricNames",i);if(e)return e.map((e=>({text:e.label,value:e.value})))}catch(e){throw console.error("Error calling metric names:",e),e}}if("nested_cis"===e.namespace){if(console.log("inside nested cis variable query"),void 0===e.rawQuery)return[];let l=e.rawQuery.split("||");l=l.map((e=>(0,t.getTemplateSrv)().replace(e,a.scopedVars,"csv")));const n=l[0]||"",o=l[1]||"",u=l[2]||"",i=l[3]||"";console.log("Extracted values:",{ci:n,parentDepth:o,childDepth:u,sysparam:i});const c={ci:n,parentDepth:o,childDepth:u,sysparam:i,asterisk:e.showAsterisk,showNull:e.showNull};try{const e=yield r.postResource("nestedCIs",c);if(e)return e.map((e=>({text:e.label,value:e.value})))}catch(e){throw console.error("Error calling nestedCIs:",e),e}}if("nested_classes"===e.namespace){if(console.log("inside nested cis variable query"),void 0===e.rawQuery)return[];let o=e.rawQuery.split("||");o=o.map((e=>(0,t.getTemplateSrv)().replace(e,a.scopedVars,"csv")));let u=o[0]||"",i=o[1]||"",c=o[2]||"",s=o[3]||"";console.log("Extracted values:",{ci:u,parentDepth:i,childDepth:c,sysparam:s});const d={ci:u,parentDepth:i,childDepth:c,sysparam:s,asterisk:l,showNull:n};try{const e=yield r.postResource("nestedClasses",d);if(e)return e.map((e=>({text:e.label,value:e.value})))}catch(e){throw console.error("Error calling nestedClasses:",e),e}}if("v2_nested_cis"===e.namespace||"v2_nested_classes"===e.namespace){if(console.log("inside v2_nested_values variable query. namespace: ",e.namespace),void 0===e.rawQuery)return[];let o=e.rawQuery.split("||");o=o.map((e=>(0,t.getTemplateSrv)().replace(e,a.scopedVars,"csv")));let u=o[0]||"",i=o[1]||"",c=o[2]||"",s=o[3]||"",d=o[4]||"",p="v2_nested_cis"===e.namespace?"ci":"class";console.log("Extracted values:",{startingPoint:u,relationshipTypes:i,excludedClasses:c,parentDepth:s,childDepth:d,type:p});const m={startingPoint:u,relationshipTypes:i,excludedClasses:c,parentDepth:s,childDepth:d,type:p,asterisk:l,showNull:n};try{const e=yield r.postResource("v2NestedValues",m);if(e)return e.map((e=>({text:e.label,value:e.value})))}catch(e){throw console.error("Error calling v2NestedValues:",e),e}}return[]},function(){var e=this,t=arguments;return new Promise((function(a,r){var o=n.apply(e,t);function u(e){l(o,a,r,u,i,"next",e)}function i(e){l(o,a,r,u,i,"throw",e)}u(void 0)}))})()}constructor(e){super(e),a(this,"annotations",void 0),a(this,"instanceName",void 0),a(this,"globalImage",void 0),a(this,"apiPath",void 0);const t={type:e.type,url:e.url,name:e.name,basicAuth:e.basicAuth,withCredentials:e.withCredentials,apiPath:e.jsonData.apiPath,cacheTimeout:e.jsonData.cacheTimeout};this.globalImage=e.jsonData.imageURL,this.instanceName=e.jsonData.instanceName,this.apiPath=t.apiPath,this.annotations={}}}var c=u(650),s=u.n(c),d=u(388);function p(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function m(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{},a=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),a.forEach((function(t){p(e,t,l[t])}))}return e}function v(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t.push.apply(t,l)}return t}(Object(t)).forEach((function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(t,l))})),e}var g=u(980);const b={selectedQueryCategory:{label:"Metrics",value:"Metrics",description:"Get Timeseries metrics."},basic_sysparam:[],getAlertCount:{label:"No",value:"false"},cacheOverride:"",compressLogs:!1,grafanaTimerange:!1,sortDirection:"ASC",metricValueType:"timeseries",page:0,rowLimit:"2000",topology_child_depth:"3",topology_parent_depth:"3",relationshipTypes:[],excludedClasses:[],basicSysparm:[{column:null,operator:null,value:null,separator:null}]},y=({value:e,updateQuery:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Query Alert Count",labelWidth:20,tooltip:"Extra query per row to get the number of alerts on a ci. Adds extra processing, use wisely!"},s().createElement(d.RadioButtonGroup,{value:e.value,options:[{label:"No",value:"false"},{label:"Yes",value:"true"}],onChange:e=>t("getAlertCount",{label:e,value:e})})))),h=({updateQuery:e,defaultValue:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Elastic Search Query",labelWidth:20},s().createElement(d.Input,{name:"elasticSearch",width:60,defaultValue:t,onBlur:t=>e("elasticSearch",t.target.value)}))));function f(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}const E=({query:e,updateQuery:l,datasource:a})=>{var n;const[r,o]=(0,c.useState)(e.groupBy),[u,i]=(0,c.useState)([{label:"Loading ...",value:""}]);return(0,c.useEffect)((()=>{var l,n;let r=[],o=!1;if(!e.tableName&&!(null===(l=e.tableName)||void 0===l?void 0:l.value))return;const u=(0,t.getTemplateSrv)().replace(null===(n=e.tableName)||void 0===n?void 0:n.value,e.scopedVars,"csv");function c(){var e;return e=function*(){r=yield a.getResource(`tableColumnOptions?tableName=${u}`),o||r&&r.length>0&&i(r)},c=function(){var t=this,l=arguments;return new Promise((function(a,n){var r=e.apply(t,l);function o(e){f(r,a,n,o,u,"next",e)}function u(e){f(r,a,n,o,u,"throw",e)}o(void 0)}))},c.apply(this,arguments)}return console.log("processedTableName:",u),function(){c.apply(this,arguments)}(),()=>{o=!0}}),[a,e.tableName,null===(n=e.tableName)||void 0===n?void 0:n.value,e.scopedVars]),s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{labelWidth:20,label:"Group By",tooltip:"Select a column which will be used to group the results by."},s().createElement(d.Select,{width:40,isMulti:!1,options:u,isClearable:!0,value:r,isSearchable:!0,menuPlacement:"top",maxMenuHeight:200,allowCustomValue:!0,defaultValue:r,backspaceRemovesValue:!0,onChange:e=>{o(e),l("groupBy",e)},onCreateOption:e=>{o({label:e,value:e}),l("groupBy",{label:e,value:e})}}))))},w=({updateQuery:e,defaultValue:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Limit",labelWidth:20,tooltip:"Limit the number of results. Expects a number between 1 - 9999"},s().createElement(d.Input,{name:"limit",type:"number",max:9999,min:1,width:20,defaultValue:t,onBlur:t=>e("rowLimit",t.target.value)})))),S=({defaultValue:e,updateQuery:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Page",labelWidth:20,tooltip:"Page number used for pagination. Starts at page 0"},s().createElement(d.Input,{name:"page",type:"number",max:9999,min:0,width:20,defaultValue:e,onBlur:e=>t("page",e.target.valueAsNumber)}))));function C(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}function O(e){return function(){var t=this,l=arguments;return new Promise((function(a,n){var r=e.apply(t,l);function o(e){C(r,a,n,o,u,"next",e)}function u(e){C(r,a,n,o,u,"throw",e)}o(void 0)}))}}const T=({query:e,updateQuery:l,datasource:a})=>{var n;const[r,o]=(0,c.useState)([{label:"Loading...",value:""}]),[u,i]=(0,c.useState)([{label:"Loading ...",value:""}]);return(0,c.useEffect)((()=>{var e;(e=O((function*(){try{const e=yield a.getResource("aggregateTypeOptions");o(e)}catch(e){console.error("Failed to fetch aggregate type options:",e),o([{label:"Error loading options",value:""}])}})),function(){return e.apply(this,arguments)})()}),[a]),(0,c.useEffect)((()=>{var l,n,r;let o=[],u=!1;if(!(null===(l=e.tableName)||void 0===l?void 0:l.value))return;const c=(0,t.getTemplateSrv)().replace(null===(r=e)||void 0===r||null===(n=r.tableName)||void 0===n?void 0:n.value,e.scopedVars,"csv");function s(){return(s=O((function*(){try{o=yield a.getResource(`tableColumnOptions?tableName=${c}`),u||o&&o.length>0&&(console.log("Setting tableColumn options: ",o),e.aggregateColumn&&e.aggregateColumn.length>0&&(o=o.concat(e.aggregateColumn)),i(o))}catch(e){console.error("Failed to fetch table column options:",e),i([{label:"Error loading options",value:""}])}}))).apply(this,arguments)}return function(){s.apply(this,arguments)}(),()=>{u=!0}}),[a,e.tableName,e.aggregateColumn,null===(n=e.tableName)||void 0===n?void 0:n.value,e.scopedVars]),s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Aggregate Function",labelWidth:20,tooltip:"Choose your aggregation function then the column to run this function on"},s().createElement(d.Select,{width:20,options:r,value:e.selectedAggregateType,defaultValue:e.selectedAggregateType,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:e=>l("selectedAggregateType",{label:e,value:e}),onChange:e=>l("selectedAggregateType",e),maxMenuHeight:200})),s().createElement(d.InlineField,null,s().createElement(d.Select,{options:u,value:e.aggregateColumn,defaultValue:e.aggregateColumn,width:40,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:e=>l("aggregateColumn",e),onCreateOption:e=>{l("aggregateColumn",{label:e,value:e})},maxMenuHeight:200}))))};function F(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}const V=({query:e,updateQuery:l,datasource:a,table:n})=>{var r;const[o,u]=(0,c.useState)([{label:"Loading ...",value:""}]);return(0,c.useEffect)((()=>{var l,r;let o=[];console.log("SelectTableColumns - UseEffect");let i=!1;if(!n&&!(null===(l=n)||void 0===l?void 0:l.value))return;const c=(0,t.getTemplateSrv)().replace(null===(r=n)||void 0===r?void 0:r.value,e.scopedVars,"csv");function s(){var t;return t=function*(){o=yield a.getResource(`tableColumnOptions?tableName=${c}`),i||o&&o.length>0&&(console.log("Setting tableColumn options: ",o),e.sortBy&&e.sortBy.length>0&&(o=o.concat(e.sortBy)),u(o))},s=function(){var e=this,l=arguments;return new Promise((function(a,n){var r=t.apply(e,l);function o(e){F(r,a,n,o,u,"next",e)}function u(e){F(r,a,n,o,u,"throw",e)}o(void 0)}))},s.apply(this,arguments)}return function(){s.apply(this,arguments)}(),()=>{i=!0}}),[a,n,e.sortBy,null===(r=n)||void 0===r?void 0:r.value,e.scopedVars]),s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Sort By",labelWidth:20},s().createElement(d.Select,{width:40,options:o,value:e.sortBy,defaultValue:e.sortBy,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:e=>l("sortBy",e),onCreateOption:e=>l("sortBy",{label:e,value:e}),maxMenuHeight:200,menuPlacement:"top"})),s().createElement(d.InlineField,null,s().createElement(d.RadioButtonGroup,{value:e.sortDirection,options:[{label:"ASC",value:"ASC",icon:"arrow-up"},{label:"DESC",value:"DESC",icon:"arrow-down"}],onChange:e=>l("sortDirection",e)}))))};function I(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}const Q=({updateQuery:e,trendByOptions:l,query:a,datasource:n})=>{var r,o,u;const[i,p]=(0,c.useState)([{label:"Loading ...",value:""}]);return(0,c.useEffect)((()=>{var e,l,r,o;let u=[],i=!1;if(!(null===(e=a)||void 0===e?void 0:e.tableName)&&!(null===(r=a)||void 0===r||null===(l=r.tableName)||void 0===l?void 0:l.value))return;const c=(0,t.getTemplateSrv)().replace(null===(o=a.tableName)||void 0===o?void 0:o.value,a.scopedVars,"csv");function s(){var e;return e=function*(){u=yield n.getResource(`tableColumnOptions?tableName=${c}&typeFilter=glide_date_time`),i||u&&u.length>0&&p(u)},s=function(){var t=this,l=arguments;return new Promise((function(a,n){var r=e.apply(t,l);function o(e){I(r,a,n,o,u,"next",e)}function u(e){I(r,a,n,o,u,"throw",e)}o(void 0)}))},s.apply(this,arguments)}return function(){s.apply(this,arguments)}(),()=>{i=!0}}),[n,null===(r=a)||void 0===r?void 0:r.tableName,null===(u=a)||void 0===u||null===(o=u.tableName)||void 0===o?void 0:o.value,a.scopedVars]),s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Trend",labelWidth:20},s().createElement(d.Select,{width:40,options:i,value:a.selectedTrendColumn,defaultValue:a.selectedTrendColumn,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:t=>e("selectedTrendColumn",t),onCreateOption:t=>e("selectedTrendColumn",{label:t,value:t}),maxMenuHeight:200})),s().createElement(d.InlineField,null,s().createElement(d.Select,{width:20,options:l,value:a.selectedTrendBy,defaultValue:a.selectedTrendBy,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:t=>e("selectedTrendBy",t),onCreateOption:t=>e("selectedTrendBy",{label:t,value:t}),maxMenuHeight:200})),s().createElement(d.InlineField,null,s().createElement(d.Input,{name:"period",type:"number",max:300,min:1,width:20,defaultValue:a.trendPeriod,onBlur:t=>e("trendPeriod",t.target.value)}))))},_=({value:e,updateQuery:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Show Uptime %",labelWidth:20},s().createElement(d.RadioButtonGroup,{options:[{label:"False",value:!1},{label:"True",value:!0}],value:e||!1,onChange:e=>t("showPercent",e)}))));function P(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}const R=({query:e,updateQuery:l,datasource:a,table:n})=>{var r;const[o,u]=(0,c.useState)([{label:"Loading ...",value:""}]);return(0,c.useEffect)((()=>{var l,r;let o=[];console.log("SelectTableColumns - UseEffect");let i=!1;if(!(null===(l=n)||void 0===l?void 0:l.value))return;const c=(0,t.getTemplateSrv)().replace(null===(r=n)||void 0===r?void 0:r.value,e.scopedVars,"csv");function s(){var t;return t=function*(){o=yield a.getResource(`tableColumnOptions?tableName=${c}`),i||o&&o.length>0&&(console.log("Setting tableColumn options: ",o),e.grafanaTimerangeColumn&&e.grafanaTimerangeColumn.length>0&&(o=o.concat(e.grafanaTimerangeColumn)),u(o))},s=function(){var e=this,l=arguments;return new Promise((function(a,n){var r=t.apply(e,l);function o(e){P(r,a,n,o,u,"next",e)}function u(e){P(r,a,n,o,u,"throw",e)}o(void 0)}))},s.apply(this,arguments)}return function(){s.apply(this,arguments)}(),()=>{i=!0}}),[a,n,e.grafanaTimerangeColumn,null===(r=n)||void 0===r?void 0:r.value,e.scopedVars]),s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Grafana Timerange",labelWidth:20,tooltip:"If selected, only results that fit inbetween your Grafana Timerange will be returned"},s().createElement(d.InlineSwitch,{value:e.grafanaTimerange,onChange:e=>l("grafanaTimerange",e.target.checked)})),e.grafanaTimerange&&s().createElement(d.InlineField,null,s().createElement(d.Select,{options:o,value:e.grafanaTimerangeColumn,defaultValue:e.grafanaTimerangeColumn,width:40,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:e=>l("grafanaTimerangeColumn",e),onCreateOption:e=>l("grafanaTimerangeColumn",{label:e,value:e}),maxMenuHeight:200}))))},L=({value:e,updateQuery:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Compress Logs",labelWidth:20},s().createElement(d.InlineSwitch,{value:e,onChange:e=>t("compressLogs",e.target.checked)})))),N=({loadOptions:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"CI",labelWidth:20},s().createElement(d.AsyncSelect,{width:40,value:t,isMulti:!0,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:t,menuPlacement:"bottom",allowCustomValue:!0,allowCreateWhileLoading:!0,loadOptions:e,backspaceRemovesValue:!0,onChange:e=>l("selectedSourceList",e),onCreateOption:e=>{let a=[];void 0!==t?(a=[...t],a[a.length]={label:e,value:e}):a=[{label:e,value:e}],l("selectedSourceList",a)}})))),j=({loadOptions:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Metric Name",labelWidth:20},s().createElement(d.AsyncSelect,{width:40,value:t,isMulti:!0,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:t,allowCustomValue:!0,allowCreateWhileLoading:!0,className:"coloredSelect",loadOptions:e,backspaceRemovesValue:!0,onChange:e=>l("selectedMetricNameList",e),onCreateOption:e=>{let a=[];void 0!==t?(a=[...t],a[a.length]={label:e,value:e}):a=[{label:e,value:e}],l("selectedMetricNameList",a)}})))),x=({updateQuery:e,defaultValue:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Sysparam Query",labelWidth:20},s().createElement(d.Input,{width:60,name:"sysparam_query",defaultValue:t,onBlur:t=>e("sysparam_query",t.target.value)})))),D=({loadOptions:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Service",labelWidth:20},s().createElement(d.AsyncSelect,{width:40,value:t,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:t,defaultOptions:!0,menuPlacement:"bottom",allowCustomValue:!0,allowCreateWhileLoading:!0,loadOptions:e,backspaceRemovesValue:!0,onChange:e=>l("selectedServiceList",e),onCreateOption:e=>l("selectedServiceList",{label:e,value:e})})))),A=({loadOptions:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Resource ID",labelWidth:20},s().createElement(d.AsyncSelect,{width:40,value:t,isMulti:!0,isClearable:!0,isSearchable:!0,maxMenuHeight:200,defaultValue:t,allowCustomValue:!0,allowCreateWhileLoading:!0,loadOptions:e,backspaceRemovesValue:!0,onChange:e=>l("selectedMetricTypeList",e),onCreateOption:e=>{let a=[];void 0!==t?(a=[...t],a[a.length]={label:e,value:e}):a=[{label:e,value:e}],l("selectedMetricTypeList",a)}})))),M=({options:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Alert Type Filter",labelWidth:20},s().createElement(d.Select,{width:20,value:t,options:e,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:t,onChange:e=>l("selectedAlertTypeList",e)})))),B=({updateQuery:e,defaultValue:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Child Depth",labelWidth:20},s().createElement(d.Input,{width:20,name:"child_depth",defaultValue:t,onBlur:t=>e("topology_child_depth",t.target.value)})))),k=({loadTableOptions:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Table Name",labelWidth:20},s().createElement(d.AsyncSelect,{value:t,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:t,defaultOptions:!0,menuPlacement:"bottom",allowCustomValue:!0,allowCreateWhileLoading:!0,backspaceRemovesValue:!0,prefix:s().createElement(d.Icon,{name:"table"}),loadOptions:e,width:40,onChange:e=>l("tableName",e),onCreateOption:e=>l("tableName",{label:e,value:e})})))),q=({options:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Alert State Filter",labelWidth:20},s().createElement(d.Select,{width:20,value:t,options:e,isClearable:!0,maxMenuHeight:200,isSearchable:!0,defaultValue:t,onChange:e=>l("selectedAlertStateList",e)})))),W=({updateQuery:e,defaultValue:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Parent Depth",labelWidth:20},s().createElement(d.Input,{width:20,name:"parent_depth",defaultValue:t,onBlur:t=>e("topology_parent_depth",t.target.value)}))));function G(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}const U=({query:e,updateQuery:l,datasource:a,table:n})=>{var r;const[o,u]=(0,c.useState)(e.selectedtableColumns),[i,p]=(0,c.useState)([{label:"Loading ...",value:""}]);return(0,c.useEffect)((()=>{var l,r;let u=[];console.log("SelectTableColumns - UseEffect");let i=!1;if(!(null===(l=n)||void 0===l?void 0:l.value))return void console.log("Table name is not selected yet. Skipping API call.");const c=(0,t.getTemplateSrv)().replace(null===(r=n)||void 0===r?void 0:r.value,e.scopedVars,"csv");function s(){var e;return e=function*(){u=yield a.getResource(`tableColumnOptions?tableName=${c}`),i||u&&u.length>0&&(console.log("Setting tableColumn options: ",u),o&&o.length>0&&(u=u.concat(o)),p(u))},s=function(){var t=this,l=arguments;return new Promise((function(a,n){var r=e.apply(t,l);function o(e){G(r,a,n,o,u,"next",e)}function u(e){G(r,a,n,o,u,"throw",e)}o(void 0)}))},s.apply(this,arguments)}return function(){s.apply(this,arguments)}(),()=>{i=!0}}),[a,n,o,null===(r=n)||void 0===r?void 0:r.value,e.scopedVars]),s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{labelWidth:20,label:"Table Columns",tooltip:"Leave columns blank to return all columns in the dictionary"},s().createElement(d.Select,{isMulti:!0,options:i,isClearable:!0,maxMenuHeight:200,value:o,isSearchable:!0,menuPlacement:"bottom",allowCustomValue:!0,defaultValue:o,backspaceRemovesValue:!0,prefix:s().createElement(d.Icon,{name:"columns"}),width:40,onChange:e=>{u(e),l("selectedtableColumns",e)},onCreateOption:e=>{let t=[];void 0!==o?(t=[...o],t[t.length]={label:e,value:e}):t=[{label:e,value:e}],u(t),l("selectedtableColumns",t)}}))))},H=({loadOptions:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Starting Point",labelWidth:20},s().createElement(d.AsyncSelect,{width:40,value:t,isClearable:!0,isSearchable:!0,defaultValue:t,defaultOptions:!0,allowCustomValue:!0,allowCreateWhileLoading:!0,loadOptions:e,backspaceRemovesValue:!0,onCreateOption:e=>l("selectedServiceList",{label:e,value:e}),onChange:e=>l("selectedServiceList",e)}))));function $(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}const z=({query:e,updateQuery:t,datasource:l})=>{const[a,n]=(0,c.useState)(e.relationshipTypes),[r,o]=(0,c.useState)([{label:"Loading ...",value:""}]);return(0,c.useEffect)((()=>{let t=[],n=!1;if(e||e.relationshipTypes)return function(){r.apply(this,arguments)}(),()=>{n=!0};function r(){var e;return e=function*(){t=yield l.getResource("relationshipTypeOptions"),n||(a&&a.length>0&&(t=t.concat(a)),t&&t.length>0&&o(t))},r=function(){var t=this,l=arguments;return new Promise((function(a,n){var r=e.apply(t,l);function o(e){$(r,a,n,o,u,"next",e)}function u(e){$(r,a,n,o,u,"throw",e)}o(void 0)}))},r.apply(this,arguments)}}),[l,a,e]),s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Relationship Types",labelWidth:20,tooltip:"include"},s().createElement(d.Select,{width:40,value:a,defaultValue:a,options:r,isClearable:!0,isSearchable:!0,isMulti:!0,allowCustomValue:!0,backspaceRemovesValue:!0,onChange:e=>{n(e),t("relationshipTypes",e)},onCreateOption:e=>{n([...a,{label:e,value:e}]),t("relationshipTypes",[...a,{label:e,value:e}])}}))))},Y=({loadOptions:e,value:t,updateQuery:l})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Filter Classes",labelWidth:20,tooltip:"exclude"},s().createElement(d.AsyncSelect,{width:40,value:t,defaultValue:t,isClearable:!0,isSearchable:!0,isMulti:!0,backspaceRemovesValue:!0,defaultOptions:!0,loadOptions:e,allowCustomValue:!0,allowCreateWhileLoading:!0,onChange:e=>l("excludedClasses",e),onCreateOption:e=>l("excludedClasses",[...t,{label:e,value:e}])}))));function K(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}function J(e){return function(){var t=this,l=arguments;return new Promise((function(a,n){var r=e.apply(t,l);function o(e){K(r,a,n,o,u,"next",e)}function u(e){K(r,a,n,o,u,"throw",e)}o(void 0)}))}}const X=({index:e,value:t,datasource:l,updateValue:a,addRow:n,deleteRow:r,columnOptions:o,table:u,showAddRow:i})=>{var p;const[m,v]=(0,c.useState)([{label:"Loading ...",value:""}]),[g,b]=(0,c.useState)([{label:"Loading ...",value:""}]);return(0,c.useEffect)((()=>{console.log("BasicSysparmRow useEffect")}),[t.column]),(0,c.useEffect)((()=>{let e=[],a=[],n=!1;const r=(o=J((function*(){let e="";t.column&&(e=t.column.label.substring(t.column.label.indexOf("(")+1,t.column.label.indexOf(")"))),a=yield l.getResource(`operatorOptions?type=${e}`),n||b(a||[])})),function(){return o.apply(this,arguments)});var o;const i=function(){var a=J((function*(){var a,r;let o="";t.column&&(o=t.column.label.substring(t.column.label.indexOf("(")+1,t.column.label.indexOf(")")));const i=new URLSearchParams({tableName:(null===(a=u)||void 0===a?void 0:a.value)||"",tableColumn:(null===(r=t.column)||void 0===r?void 0:r.value)||"",input:"",choiceType:o});try{e=yield l.getResource(`columnChoices?${i.toString()}`),n||v(e||[])}catch(e){console.error("Failed to fetch column choices:",e),n||v([{label:"Error loading options",value:""}])}}));return function(){return a.apply(this,arguments)}}();return i(),r(),()=>{n=!0}}),[l,t.column,u]),s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,0!==e&&s().createElement(d.InlineField,null,s().createElement(d.RadioButtonGroup,{options:[{label:"AND",value:"^"},{label:"OR",value:"^OR"}],value:(null===(p=t.separator)||void 0===p?void 0:p.value)||"^",onChange:t=>a(e,"separator",{label:t,value:t})})),s().createElement(d.InlineField,{label:0===e?"Sysparam Query":void 0,labelWidth:0===e?20:void 0},s().createElement(d.Select,{width:40,options:o||[],value:t.column,defaultValue:t.column,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:t=>a(e,"column",t),onCreateOption:t=>a(e,"column",{label:t,value:t})})),s().createElement(d.InlineField,null,s().createElement(d.Select,{width:20,options:g,value:t.operator,defaultValue:t.operator,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:t=>a(e,"operator",t),onCreateOption:t=>a(e,"operator",{label:t,value:t})})),s().createElement(d.InlineField,null,s().createElement(d.Select,{width:20,options:m,value:t.value,defaultValue:t.value,isSearchable:!0,isClearable:!0,isMulti:!1,backspaceRemovesValue:!0,allowCustomValue:!0,onChange:t=>a(e,"value",t),onCreateOption:t=>a(e,"value",{label:t,value:t})})),e>0&&s().createElement(d.InlineField,null,s().createElement(d.ToolbarButton,{icon:"trash-alt",variant:"destructive",iconOnly:!0,onClick:()=>r(e)}))),i&&s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,null,s().createElement(d.ToolbarButton,{icon:"plus",variant:"primary",onClick:()=>n()}))))};function Z(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}const ee=({query:e,updateQuery:l,datasource:a,table:n,multiUpdateQuery:r})=>{var o;const[u,i]=(0,c.useState)([{label:"Loading ...",value:""}]);(0,c.useEffect)((()=>{var l,o;let u=[],c=!1;if(!e&&!n&&!(null===(l=n)||void 0===l?void 0:l.value))return;const s=(0,t.getTemplateSrv)().replace(null===(o=n)||void 0===o?void 0:o.value,e.scopedVars,"csv");function d(){var e;return e=function*(){u=yield a.getResource(`tableColumnOptions?tableName=${s}`),c||u&&u.length>0&&(console.log("BasicSysparmContainer - Setting table column options"),i(u))},d=function(){var t=this,l=arguments;return new Promise((function(a,n){var r=e.apply(t,l);function o(e){Z(r,a,n,o,u,"next",e)}function u(e){Z(r,a,n,o,u,"throw",e)}o(void 0)}))},d.apply(this,arguments)}return e.basic_sysparam.length>0&&function(){let t=e.basic_sysparam.map((e=>({column:e[1]||null,operator:e[2]||null,value:e[3]||null,separator:e[4]||{label:"AND",value:"^"}})));r({basic_sysparam:[],basicSysparm:t})}(),function(){d.apply(this,arguments)}(),()=>{c=!0}}),[e,a,n,e.basic_sysparam,r,null===(o=n)||void 0===o?void 0:o.value,e.scopedVars]);const d=[...e.basicSysparm],p=e=>{let t=d;t.splice(e,1),l("basicSysparm",t)},m=()=>{let e=d;e.push({column:null,operator:null,value:null,separator:{label:"AND",value:"^"}}),l("basicSysparm",e)},v=(e,t,a)=>{let n=d;n[e][t]=a,l("basicSysparm",n)};return s().createElement(s().Fragment,null,d.map(((e,t)=>s().createElement(X,{index:t,value:e,datasource:a,updateValue:v,addRow:m,deleteRow:p,columnOptions:u,table:n,key:t,showAddRow:t===d.length-1}))))},te=({query:e,updateQuery:t})=>s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Value Type",labelWidth:20},s().createElement(d.RadioButtonGroup,{options:[{label:"Timeseries",value:"timeseries"},{label:"Latest Value",value:"latest"}],value:e.metricValueType,onChange:e=>t("metricValueType",e)}))));function le(e,t,l,a,n,r,o){try{var u=e[r](o),i=u.value}catch(e){return void l(e)}u.done?t(i):Promise.resolve(i).then(a,n)}function ae(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function ne(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{},a=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),a.forEach((function(t){ae(e,t,l[t])}))}return e}function re(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}const oe=new e.DataSourcePlugin(o).setConfigEditor((e=>{const{options:t,onOptionsChange:l}=e;""===t.url&&(t.url="https://<instance_name>.service-now.com/"),void 0===t.jsonData.apiPath&&(t.jsonData.apiPath="/api/x_opti8_itom_grafa/grafana_api"),void 0===t.jsonData.cacheTimeout&&(t.jsonData.cacheTimeout=60),void 0===t.jsonData.imageURL&&(t.jsonData.imageURL="https://www.servicenow.com/content/dam/servicenow-assets/public/en-us/images/og-images/favicon.ico"),console.log("config options: ",t);const a=(e,a)=>{l(v(m({},t),{jsonData:v(m({},t.jsonData),{[e]:a})}))};return s().createElement(s().Fragment,null,s().createElement(d.Alert,{title:"Need more information?",severity:"info",elevated:!0},s().createElement(d.VerticalGroup,null,s().createElement("p",null,"Local documentation can be found ",s().createElement("a",{href:"/plugins/optimiz-servicenow-datasource"},"Here")),s().createElement("p",null,"OrÂ ",s().createElement("a",{href:"https://github.com/optimizca/servicenow-grafana/blob/main/README.md"},"Click here to view the documentation on GitHub")))),s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{labelWidth:20,label:"Logo URL",tooltip:"To access this value in each dashboard, create a variable query using namespace: global_image."},s().createElement(d.Input,{defaultValue:void 0===t.jsonData.imageURL?"":t.jsonData.imageURL,onBlur:e=>a("imageURL",e.target.value),width:60}))),s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{labelWidth:20,label:"API Path"},s().createElement(d.Input,{defaultValue:void 0===t.jsonData.apiPath?"":t.jsonData.apiPath,onBlur:e=>a("apiPath",e.target.value),width:40}))),s().createElement(d.DataSourceHttpSettings,{defaultUrl:"https://<instance_name>.service-now.com/",dataSourceConfig:t,showAccessOptions:!0,sigV4AuthToggleEnabled:!1,showForwardOAuthIdentityOption:!1,onChange:e=>{let t="";-1!==e.url.indexOf("https://")?t=e.url.substring(8,e.url.indexOf(".service-now",8)):-1!==e.url.indexOf("http://")&&(t=e.url.substring(7,e.url.indexOf(".service-now",7))),l(v(m({},e),{jsonData:v(m({},e.jsonData),{instanceName:t})}))}}))})).setQueryEditor((e=>{const{query:t,onChange:l,datasource:a}=e,n=(0,g.defaults)(t,b),[r,o]=(0,c.useState)([]),[u,i]=(0,c.useState)([]),[p,m]=(0,c.useState)([]);(0,c.useEffect)((()=>{var e,t;(e=function*(){try{const e=yield a.getResource("alertTypeOptions");o(e);const t=yield a.getResource("alertStateOptions");i(t);const l=yield a.getResource("trendByOptions");m(l)}catch(e){console.error("Failed to fetch static data:",e)}},t=function(){var t=this,l=arguments;return new Promise((function(a,n){var r=e.apply(t,l);function o(e){le(r,a,n,o,u,"next",e)}function u(e){le(r,a,n,o,u,"throw",e)}o(void 0)}))},function(){return t.apply(this,arguments)})()}),[a]);const v=(e="")=>new Promise((t=>{setTimeout((()=>{a.getResource(`serviceOptions?search=${e}`).then((e=>{t(e)})).catch((e=>{console.error("Failed to fetch service options:",e),t([])}))}),500)})),f=(e="")=>new Promise((t=>{setTimeout((()=>{var l;a.getResource(`CIOptions?search=${null===(l=n.selectedServiceList)||void 0===l||l.value,e}`).then((e=>{t(e)})).catch((e=>{console.error("Failed to fetch CI options:",e),t([])}))}),500)})),C=(e="")=>new Promise((t=>{setTimeout((()=>{a.getResource(`tableOptions?search=${e}`).then((e=>{console.log("Table Options Response:",e),t(e)})).catch((e=>{console.error("Failed to fetch table options:",e),t([])}))}),500)})),O=(e,t)=>{var a,r;l((a=ne({},n),r=null!=(r={[e]:t})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t.push.apply(t,l)}return t}(Object(r)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(r,e))})),a))},F=e=>{l(ne({},n,e))},I={Table:{title:"Table",description:"Choose your own table to gather data from",content:s().createElement(s().Fragment,null,s().createElement(k,{updateQuery:O,loadTableOptions:C,value:n.tableName}),s().createElement(U,{query:n,updateQuery:O,datasource:a,table:n.tableName}),s().createElement(ee,{query:n,updateQuery:O,datasource:a,table:n.tableName,multiUpdateQuery:F}),s().createElement(V,{query:n,updateQuery:O,datasource:a,table:n.tableName}),s().createElement(w,{defaultValue:n.rowLimit,updateQuery:O}),s().createElement(S,{defaultValue:n.page,updateQuery:O}),s().createElement(y,{value:n.getAlertCount,updateQuery:O}),s().createElement(R,{query:n,updateQuery:O,datasource:a,table:n.tableName}))},Aggregate:{title:"Aggregate",description:"Group by and apply aggregate functions to table data",content:s().createElement(s().Fragment,null,s().createElement(k,{updateQuery:O,loadTableOptions:C,value:n.tableName}),s().createElement(E,{query:n,updateQuery:O,datasource:a}),s().createElement(T,{query:n,updateQuery:O,datasource:a}),s().createElement(x,{updateQuery:O,defaultValue:n.sysparam_query}),s().createElement(w,{defaultValue:n.rowLimit,updateQuery:O}),s().createElement(R,{query:n,updateQuery:O,datasource:a,table:n.tableName}))},Alerts:{title:"Alerts",description:"Get Alerts",content:s().createElement(s().Fragment,null,s().createElement(D,{loadOptions:v,value:n.selectedServiceList,updateQuery:O}),s().createElement(N,{loadOptions:f,value:n.selectedSourceList,updateQuery:O}),s().createElement(M,{options:r,value:n.selectedAlertTypeList,updateQuery:O}),s().createElement(q,{options:u,value:n.selectedAlertStateList,updateQuery:O}),s().createElement(x,{updateQuery:O,defaultValue:n.sysparam_query}),s().createElement(V,{query:n,updateQuery:O,datasource:a,table:{value:"em_alert"}}),s().createElement(w,{defaultValue:n.rowLimit,updateQuery:O}),s().createElement(S,{defaultValue:n.page,updateQuery:O}),s().createElement(R,{query:n,updateQuery:O,datasource:a,table:{value:"em_alert"}}))},Anomaly:{title:"Anomaly",description:"Parse values out of Alert Anomalies table",content:s().createElement(s().Fragment,null,s().createElement(U,{query:n,updateQuery:O,datasource:a,table:{value:"em_alert_anomaly"}}),s().createElement(ee,{query:n,updateQuery:O,datasource:a,table:{value:"em_alert_anomaly"},multiUpdateQuery:F}),s().createElement(V,{query:n,updateQuery:O,datasource:a,table:{value:"em_alert_anomaly"}}),s().createElement(w,{defaultValue:n.rowLimit,updateQuery:O}),s().createElement(S,{defaultValue:n.page,updateQuery:O}))},Geohash_Map:{title:"GeoHash Map",description:"Get map data from AWS or Azure",content:s().createElement(s().Fragment,null,s().createElement(k,{updateQuery:O,loadTableOptions:C,value:n.tableName}),s().createElement(E,{query:n,updateQuery:O,datasource:a}),s().createElement(x,{updateQuery:O,defaultValue:n.sysparam_query}))},Log_Data:{title:"Log Data",description:"Get log data",content:s().createElement(s().Fragment,null,s().createElement(L,{value:n.compressLogs,updateQuery:O}),s().createElement(ee,{query:n,updateQuery:O,datasource:a,table:{value:"sn_occ_log_viewer_parent"},multiUpdateQuery:F}),s().createElement(h,{updateQuery:O,defaultValue:n.elasticSearch}),s().createElement(V,{query:n,updateQuery:O,datasource:a,table:{value:"sn_occ_log_viewer_parent"}}),s().createElement(w,{defaultValue:n.rowLimit,updateQuery:O}),s().createElement(S,{defaultValue:n.page,updateQuery:O}))},Metrics:{title:"Metrics",description:"Get Timeseries metrics",content:s().createElement(s().Fragment,null,s().createElement(D,{loadOptions:v,value:n.selectedServiceList,updateQuery:O}),s().createElement(N,{loadOptions:f,value:n.selectedSourceList,updateQuery:O}),s().createElement(A,{loadOptions:(e="",t=[])=>new Promise((l=>{console.log("Selected Source List:",t);const n=new URLSearchParams({search:e,selectedCIS:t.join(",")});a.getResource(`resourceOptions?${n.toString()}`).then((e=>{l(e)})).catch((e=>{console.error("Failed to fetch resource options:",e),l([])}))})),value:n.selectedMetricTypeList,updateQuery:O}),s().createElement(j,{loadOptions:(e="",t=[])=>new Promise((l=>{console.log("Selected Source List:",t);const n=new URLSearchParams({search:e,selectedCIS:t.join(",")});a.getResource(`metricOptions?${n.toString()}`).then((e=>{l(e)})).catch((e=>{console.error("Failed to fetch resource options:",e),l([])}))})),value:n.selectedMetricNameList,updateQuery:O}),s().createElement(te,{query:n,updateQuery:O}))},Outage_Status:{title:"Outage Status",description:"Gathers business service status over the last 90 days",content:s().createElement(s().Fragment,null,s().createElement(D,{loadOptions:v,value:n.selectedServiceList,updateQuery:O}),s().createElement(_,{value:n.showPercent,updateQuery:O}),s().createElement(x,{updateQuery:O,defaultValue:n.sysparam_query}),s().createElement(w,{defaultValue:n.rowLimit,updateQuery:O}),s().createElement(S,{defaultValue:n.page,updateQuery:O}))},Row_Count:{title:"Row Count",description:"Get row count from query",content:s().createElement(s().Fragment,null,s().createElement(k,{updateQuery:O,loadTableOptions:C,value:n.tableName}),s().createElement(x,{updateQuery:O,defaultValue:n.sysparam_query}),s().createElement(R,{query:n,updateQuery:O,datasource:a,table:n.tableName}))},Node_Graph:{title:"Node Graph",description:"Show relationships in the node graph panel",content:s().createElement(s().Fragment,null,s().createElement(H,{loadOptions:(e="")=>new Promise((t=>{setTimeout((()=>{a.getResource(`startingPointOptions?search=${e}`).then((e=>{t(e)})).catch((e=>{console.error("Failed to fetch starting point options:",e),t([])}))}),500)})),value:n.selectedServiceList,updateQuery:O}),s().createElement(z,{query:n,updateQuery:O,datasource:a}),s().createElement(Y,{loadOptions:(e="")=>new Promise((t=>{setTimeout((()=>{a.getResource(`classOptions?search=${e}`).then((e=>{t(e)})).catch((e=>{console.error("Failed to fetch class options:",e),t([])}))}),500)})),value:n.excludedClasses,updateQuery:O}),s().createElement(W,{updateQuery:O,defaultValue:n.topology_parent_depth}),s().createElement(B,{updateQuery:O,defaultValue:n.topology_child_depth}))},Trend_Data:{title:"Trend Data",description:"Get timeseries data based on a time trend",content:s().createElement(s().Fragment,null,s().createElement(k,{updateQuery:O,loadTableOptions:C,value:n.tableName}),s().createElement(ee,{query:n,updateQuery:O,datasource:a,table:n.tableName,multiUpdateQuery:F}),s().createElement(h,{updateQuery:O,defaultValue:n.elasticSearch}),s().createElement(E,{query:n,updateQuery:O,datasource:a}),s().createElement(Q,{query:n,updateQuery:O,trendByOptions:p,datasource:a}))}};var P;return s().createElement(s().Fragment,null,s().createElement(d.HorizontalGroup,{justify:"space-between"},s().createElement(d.InlineFieldRow,{style:{paddingTop:"8px"}},s().createElement(d.InlineField,{label:"Query Category",labelWidth:20},s().createElement(d.Select,{width:40,options:(()=>{let e=[];for(let t in I){let l=I[t];e.push({label:l.title,value:t,description:l.description})}return e})(),value:n.selectedQueryCategory,onChange:e=>{O("selectedQueryCategory",e)},menuPlacement:"bottom",maxMenuHeight:220})))),I[null!==(P=n.selectedQueryCategory.value)&&void 0!==P?P:""].content)})).setVariableQueryEditor((({onChange:e,query:t})=>{const[l,a]=(0,c.useState)(t),n=()=>{e(l,`${l.rawQuery} (${l.namespace}) ${l.showAsterisk}`)},r=(e,t)=>{var n,r;a((n=function(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{},a=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),a.forEach((function(t){re(e,t,l[t])}))}return e}({},l),r=null!=(r={[e]:t})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t.push.apply(t,l)}return t}(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),n))};return s().createElement(s().Fragment,null,s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Namespace",labelWidth:20},s().createElement(d.Select,{options:[{label:"global_image",value:"global_image"},{label:"global_instance_name",value:"global_instance_name"},{label:"metric_names",value:"metric_names"},{label:"golden_metric_names",value:"golden_metric_names"},{label:"custom_kpis",value:"custom_kpis"},{label:"generic",value:"generic"},{label:"group_by",value:"group_by"},{label:"nested_cis",value:"nested_cis"},{label:"v2_nested_cis",value:"v2_nested_cis"},{label:"nested_classes",value:"nested_classes"},{label:"v2_nested_classes",value:"v2_nested_classes"}],value:l.namespace,onChange:e=>r("namespace",e.value),allowCustomValue:!1,isClearable:!1,isSearchable:!0,onBlur:n,width:30}))),s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{label:"Query",labelWidth:20,grow:!0},s().createElement(d.Input,{name:"rawQuery",onChange:e=>r("rawQuery",e.target.value),onBlur:n,value:l.rawQuery}))),s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{labelWidth:20,label:"Add Asterisk",tooltip:'The "ALL" option represents all the available choices in the variable list, while the "*" option represents any value.'},s().createElement(d.InlineSwitch,{disabled:!1,onBlur:n,transparent:!1,value:l.showAsterisk,onChange:e=>r("showAsterisk",e.target.checked)}))),s().createElement(d.InlineFieldRow,null,s().createElement(d.InlineField,{labelWidth:20,label:"Add NULL",tooltip:'The "NULL" option represents an empty value'},s().createElement(d.InlineSwitch,{disabled:!1,onBlur:n,transparent:!1,value:l.showNull,onChange:e=>r("showNull",e.target.checked)}))),s().createElement(d.Alert,{title:"",severity:"info"},s().createElement(d.VerticalGroup,null,s().createElement("p",null,"Documentation for variables can be found"," ",s().createElement("a",{href:"https://github.com/optimizca/servicenow-grafana#variables",rel:"noopener noreferrer",target:"_blank"},"(Here)")))))}))})(),i})()));
//# sourceMappingURL=module.js.map